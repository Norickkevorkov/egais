var config=jivo_config=window.parent.window.jivo_config;(function(e,t){var i,n,o=typeof t,s=e.location,a=e.document,r=a.documentElement,l=e.jQuery,c=e.$,u={},d=[],f="1.10.2",h=d.concat,p=d.push,g=d.slice,m=d.indexOf,v=u.toString,_=u.hasOwnProperty,w=f.trim,b=function(e,t){return new b.fn.init(e,t,n)},y=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,x=/\S+/g,j=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,C=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^[\],:{}\s]*$/,T=/(?:^|:|,)(?:\s*\[)+/g,S=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,I=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,M=/^-ms-/,N=/-([\da-z])/gi,A=function(e,t){return t.toUpperCase()},O=function(e){if(a.addEventListener||e.type==="load"||a.readyState==="complete"){D();b.ready()}},D=function(){if(a.addEventListener){a.removeEventListener("DOMContentLoaded",O,false);e.removeEventListener("load",O,false)}else{a.detachEvent("onreadystatechange",O);e.detachEvent("onload",O)}};b.fn=b.prototype={jquery:f,constructor:b,init:function(e,i,n){var o,s;if(!e){return this}if(typeof e==="string"){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3){o=[null,e,null]}else{o=C.exec(e)}if(o&&(o[1]||!i)){if(o[1]){i=i instanceof b?i[0]:i;b.merge(this,b.parseHTML(o[1],i&&i.nodeType?i.ownerDocument||i:a,true));if(E.test(o[1])&&b.isPlainObject(i)){for(o in i){if(b.isFunction(this[o])){this[o](i[o])}else{this.attr(o,i[o])}}}return this}else{s=a.getElementById(o[2]);if(s&&s.parentNode){if(s.id!==o[2]){return n.find(e)}this.length=1;this[0]=s}this.context=a;this.selector=e;return this}}else if(!i||i.jquery){return(i||n).find(e)}else{return this.constructor(i).find(e)}}else if(e.nodeType){this.context=this[0]=e;this.length=1;return this}else if(b.isFunction(e)){return n.ready(e)}if(e.selector!==t){this.selector=e.selector;this.context=e.context}return b.makeArray(e,this)},selector:"",length:0,toArray:function(){return g.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);t.prevObject=this;t.context=this.context;return t},each:function(e,t){return b.each(this,e,t)},ready:function(e){b.ready.promise().done(e);return this},slice:function(){return this.pushStack(g.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},map:function(e){return this.pushStack(b.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:p,sort:[].sort,splice:[].splice};b.fn.init.prototype=b.fn;b.extend=b.fn.extend=function(){var e,i,n,o,s,a,r=arguments[0]||{},l=1,c=arguments.length,u=false;if(typeof r==="boolean"){u=r;r=arguments[1]||{};l=2}if(typeof r!=="object"&&!b.isFunction(r)){r={}}if(c===l){r=this;--l}for(;l<c;l++){if((s=arguments[l])!=null){for(o in s){e=r[o];n=s[o];if(r===n){continue}if(u&&n&&(b.isPlainObject(n)||(i=b.isArray(n)))){if(i){i=false;a=e&&b.isArray(e)?e:[]}else{a=e&&b.isPlainObject(e)?e:{}}r[o]=b.extend(u,a,n)}else if(n!==t){r[o]=n}}}}return r};b.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){if(e.$===b){e.$=c}if(t&&e.jQuery===b){e.jQuery=l}return b},isReady:false,readyWait:1,holdReady:function(e){if(e){b.readyWait++}else{b.ready(true)}},ready:function(e){if(e===true?--b.readyWait:b.isReady){return}if(!a.body){return setTimeout(b.ready)}b.isReady=true;if(e!==true&&--b.readyWait>0){return}i.resolveWith(a,[b]);if(b.fn.trigger){b(a).trigger("ready").off("ready")}},isFunction:function(e){return b.type(e)==="function"},isArray:Array.isArray||function(e){return b.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){if(e==null){return String(e)}return typeof e==="object"||typeof e==="function"?u[v.call(e)]||"object":typeof e},isPlainObject:function(e){var i;if(!e||b.type(e)!=="object"||e.nodeType||b.isWindow(e)){return false}try{if(e.constructor&&!_.call(e,"constructor")&&!_.call(e.constructor.prototype,"isPrototypeOf")){return false}}catch(n){return false}if(b.support.ownLast){for(i in e){return _.call(e,i)}}for(i in e){}return i===t||_.call(e,i)},isEmptyObject:function(e){var t;for(t in e){return false}return true},error:function(e){throw new Error(e)},parseHTML:function(e,t,i){if(!e||typeof e!=="string"){return null}if(typeof t==="boolean"){i=t;t=false}t=t||a;var n=E.exec(e),o=!i&&[];if(n){return[t.createElement(n[1])]}n=b.buildFragment([e],t,o);if(o){b(o).remove()}return b.merge([],n.childNodes)},parseJSON:function(t){if(e.JSON&&e.JSON.parse){return e.JSON.parse(t)}if(t===null){return t}if(typeof t==="string"){t=b.trim(t);if(t){if(k.test(t.replace(S,"@").replace(I,"]").replace(T,""))){return new Function("return "+t)()}}}b.error("Invalid JSON: "+t)},parseXML:function(i){var n,o;if(!i||typeof i!=="string"){return null}try{if(e.DOMParser){o=new DOMParser;n=o.parseFromString(i,"text/xml")}else{n=new ActiveXObject("Microsoft.XMLDOM");n.async="false";n.loadXML(i)}}catch(s){n=t}if(!n||!n.documentElement||n.getElementsByTagName("parsererror").length){b.error("Invalid XML: "+i)}return n},noop:function(){},globalEval:function(t){if(t&&b.trim(t)){(e.execScript||function(t){e["eval"].call(e,t)})(t)}},camelCase:function(e){return e.replace(M,"ms-").replace(N,A)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var n,o=0,s=e.length,a=L(e);if(i){if(a){for(;o<s;o++){n=t.apply(e[o],i);if(n===false){break}}}else{for(o in e){n=t.apply(e[o],i);if(n===false){break}}}}else{if(a){for(;o<s;o++){n=t.call(e[o],o,e[o]);if(n===false){break}}}else{for(o in e){n=t.call(e[o],o,e[o]);if(n===false){break}}}}return e},trim:w&&!w.call("﻿ ")?function(e){return e==null?"":w.call(e)}:function(e){return e==null?"":(e+"").replace(j,"")},makeArray:function(e,t){var i=t||[];if(e!=null){if(L(Object(e))){b.merge(i,typeof e==="string"?[e]:e)}else{p.call(i,e)}}return i},inArray:function(e,t,i){var n;if(t){if(m){return m.call(t,e,i)}n=t.length;i=i?i<0?Math.max(0,n+i):i:0;for(;i<n;i++){if(i in t&&t[i]===e){return i}}}return-1},merge:function(e,i){var n=i.length,o=e.length,s=0;if(typeof n==="number"){for(;s<n;s++){e[o++]=i[s]}}else{while(i[s]!==t){e[o++]=i[s++]}}e.length=o;return e},grep:function(e,t,i){var n,o=[],s=0,a=e.length;i=!!i;for(;s<a;s++){n=!!t(e[s],s);if(i!==n){o.push(e[s])}}return o},map:function(e,t,i){var n,o=0,s=e.length,a=L(e),r=[];if(a){for(;o<s;o++){n=t(e[o],o,i);if(n!=null){r[r.length]=n}}}else{for(o in e){n=t(e[o],o,i);if(n!=null){r[r.length]=n}}}return h.apply([],r)},guid:1,proxy:function(e,i){var n,o,s;if(typeof i==="string"){s=e[i];i=e;e=s}if(!b.isFunction(e)){return t}n=g.call(arguments,2);o=function(){return e.apply(i||this,n.concat(g.call(arguments)))};o.guid=e.guid=e.guid||b.guid++;return o},access:function(e,i,n,o,s,a,r){var l=0,c=e.length,u=n==null;if(b.type(n)==="object"){s=true;for(l in n){b.access(e,i,l,n[l],true,a,r)}}else if(o!==t){s=true;if(!b.isFunction(o)){r=true}if(u){if(r){i.call(e,o);i=null}else{u=i;i=function(e,t,i){return u.call(b(e),i)}}}if(i){for(;l<c;l++){i(e[l],n,r?o:o.call(e[l],l,i(e[l],n)))}}}return s?e:u?i.call(e):c?i(e[0],n):a},now:function(){return(new Date).getTime()},swap:function(e,t,i,n){var o,s,a={};for(s in t){a[s]=e.style[s];e.style[s]=t[s]}o=i.apply(e,n||[]);for(s in t){e.style[s]=a[s]}return o}});b.ready.promise=function(t){if(!i){i=b.Deferred();if(a.readyState==="complete"){setTimeout(b.ready)}else if(a.addEventListener){a.addEventListener("DOMContentLoaded",O,false);e.addEventListener("load",O,false)}else{a.attachEvent("onreadystatechange",O);e.attachEvent("onload",O);var n=false;try{n=e.frameElement==null&&a.documentElement}catch(o){}if(n&&n.doScroll){(function s(){if(!b.isReady){try{n.doScroll("left")}catch(e){return setTimeout(s,50)}D();b.ready()}})()}}}return i.promise(t)};b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){u["[object "+t+"]"]=t.toLowerCase()});function L(e){var t=e.length,i=b.type(e);if(b.isWindow(e)){return false}if(e.nodeType===1&&t){return true}return i==="array"||i!=="function"&&(t===0||typeof t==="number"&&t>0&&t-1 in e)}n=b(a);(function(e,t){var i,n,o,s,a,r,l,c,u,d,f,h,p,g,m,v,_,w="sizzle"+-new Date,y=e.document,x=0,j=0,C=rt(),E=rt(),k=rt(),T=false,S=function(e,t){if(e===t){T=true;return 0}return 0},I=typeof t,M=1<<31,N={}.hasOwnProperty,A=[],O=A.pop,D=A.push,L=A.push,H=A.slice,P=A.indexOf||function(e){var t=0,i=this.length;for(;t<i;t++){if(this[t]===e){return t}}return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",R="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W=B.replace("w","w#"),$="\\["+R+"*("+B+")"+R+"*(?:([*^$|!~]?=)"+R+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+W+")|)|)"+R+"*\\]",V=":("+B+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=new RegExp("^"+R+"+|((?:^|[^\\\\])(?:\\\\.)*)"+R+"+$","g"),q=new RegExp("^"+R+"*,"+R+"*"),G=new RegExp("^"+R+"*([>+~]|"+R+")"+R+"*"),U=new RegExp(R+"*[+~]"),J=new RegExp("="+R+"*([^\\]'\"]*)"+R+"*\\]","g"),Y=new RegExp(V),X=new RegExp("^"+W+"$"),Q={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+$),PSEUDO:new RegExp("^"+V),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+R+"*(even|odd|(([+-]|)(\\d*)n|)"+R+"*(?:([+-]|)"+R+"*(\\d+)|))"+R+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+R+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+R+"*((?:-\\d)?\\d*)"+R+"*\\)|)(?=[^-]|$)","i")},Z=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,it=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+R+"?|("+R+")|.)","ig"),ot=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)};try{L.apply(A=H.call(y.childNodes),y.childNodes);A[y.childNodes.length].nodeType}catch(st){L={apply:A.length?function(e,t){D.apply(e,H.call(t))}:function(e,t){var i=e.length,n=0;while(e[i++]=t[n++]){}e.length=i-1}}}function at(e,t,i,o){var s,a,r,l,c,u,h,m,v,b;if((t?t.ownerDocument||t:y)!==f){d(t)}t=t||f;i=i||[];if(!e||typeof e!=="string"){return i}if((l=t.nodeType)!==1&&l!==9){return[]}if(p&&!o){if(s=K.exec(e)){if(r=s[1]){if(l===9){a=t.getElementById(r);if(a&&a.parentNode){if(a.id===r){i.push(a);return i}}else{return i}}else{if(t.ownerDocument&&(a=t.ownerDocument.getElementById(r))&&_(t,a)&&a.id===r){i.push(a);return i}}}else if(s[2]){L.apply(i,t.getElementsByTagName(e));return i}else if((r=s[3])&&n.getElementsByClassName&&t.getElementsByClassName){L.apply(i,t.getElementsByClassName(r));return i}}if(n.qsa&&(!g||!g.test(e))){m=h=w;v=t;b=l===9&&e;if(l===1&&t.nodeName.toLowerCase()!=="object"){u=mt(e);if(h=t.getAttribute("id")){m=h.replace(it,"\\$&")}else{t.setAttribute("id",m)}m="[id='"+m+"'] ";c=u.length;while(c--){u[c]=m+vt(u[c])}v=U.test(e)&&t.parentNode||t;b=u.join(",")}if(b){try{L.apply(i,v.querySelectorAll(b));return i}catch(x){}finally{if(!h){t.removeAttribute("id")}}}}}return Et(e.replace(z,"$1"),t,i,o)}function rt(){var e=[];function t(i,n){if(e.push(i+=" ")>s.cacheLength){delete t[e.shift()]}return t[i]=n}return t}function lt(e){e[w]=true;return e}function ct(e){var t=f.createElement("div");try{return!!e(t)}catch(i){return false}finally{if(t.parentNode){t.parentNode.removeChild(t)}t=null}}function ut(e,t){var i=e.split("|"),n=e.length;while(n--){s.attrHandle[i[n]]=t}}function dt(e,t){var i=t&&e,n=i&&e.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||M)-(~e.sourceIndex||M);if(n){return n}if(i){while(i=i.nextSibling){if(i===t){return-1}}}return e?1:-1}function ft(e){return function(t){var i=t.nodeName.toLowerCase();return i==="input"&&t.type===e}}function ht(e){return function(t){var i=t.nodeName.toLowerCase();return(i==="input"||i==="button")&&t.type===e}}function pt(e){return lt(function(t){t=+t;return lt(function(i,n){var o,s=e([],i.length,t),a=s.length;while(a--){if(i[o=s[a]]){i[o]=!(n[o]=i[o])}}})})}r=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":false};n=at.support={};d=at.setDocument=function(e){var t=e?e.ownerDocument||e:y,i=t.defaultView;if(t===f||t.nodeType!==9||!t.documentElement){return f}f=t;h=t.documentElement;p=!r(t);if(i&&i.attachEvent&&i!==i.top){i.attachEvent("onbeforeunload",function(){d()})}n.attributes=ct(function(e){e.className="i";return!e.getAttribute("className")});n.getElementsByTagName=ct(function(e){e.appendChild(t.createComment(""));return!e.getElementsByTagName("*").length});n.getElementsByClassName=ct(function(e){e.innerHTML="<div class='a'></div><div class='a i'></div>";e.firstChild.className="i";return e.getElementsByClassName("i").length===2});n.getById=ct(function(e){h.appendChild(e).id=w;return!t.getElementsByName||!t.getElementsByName(w).length});if(n.getById){s.find["ID"]=function(e,t){if(typeof t.getElementById!==I&&p){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}};s.filter["ID"]=function(e){var t=e.replace(nt,ot);return function(e){return e.getAttribute("id")===t}}}else{delete s.find["ID"];s.filter["ID"]=function(e){var t=e.replace(nt,ot);return function(e){var i=typeof e.getAttributeNode!==I&&e.getAttributeNode("id");return i&&i.value===t}}}s.find["TAG"]=n.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==I){return t.getElementsByTagName(e)}}:function(e,t){var i,n=[],o=0,s=t.getElementsByTagName(e);if(e==="*"){while(i=s[o++]){if(i.nodeType===1){n.push(i)}}return n}return s};s.find["CLASS"]=n.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==I&&p){return t.getElementsByClassName(e)}};m=[];g=[];if(n.qsa=Z.test(t.querySelectorAll)){ct(function(e){e.innerHTML="<select><option selected=''></option></select>";if(!e.querySelectorAll("[selected]").length){g.push("\\["+R+"*(?:value|"+F+")")}if(!e.querySelectorAll(":checked").length){g.push(":checked")}});ct(function(e){var i=t.createElement("input");i.setAttribute("type","hidden");e.appendChild(i).setAttribute("t","");if(e.querySelectorAll("[t^='']").length){g.push("[*^$]="+R+"*(?:''|\"\")")}if(!e.querySelectorAll(":enabled").length){g.push(":enabled",":disabled")}e.querySelectorAll("*,:x");g.push(",.*:")})}if(n.matchesSelector=Z.test(v=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector)){ct(function(e){n.disconnectedMatch=v.call(e,"div");v.call(e,"[s!='']:x");m.push("!=",V)})}g=g.length&&new RegExp(g.join("|"));m=m.length&&new RegExp(m.join("|"));_=Z.test(h.contains)||h.compareDocumentPosition?function(e,t){var i=e.nodeType===9?e.documentElement:e,n=t&&t.parentNode;return e===n||!!(n&&n.nodeType===1&&(i.contains?i.contains(n):e.compareDocumentPosition&&e.compareDocumentPosition(n)&16))}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return true}}}return false};S=h.compareDocumentPosition?function(e,i){if(e===i){T=true;return 0}var o=i.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(i);if(o){if(o&1||!n.sortDetached&&i.compareDocumentPosition(e)===o){if(e===t||_(y,e)){return-1}if(i===t||_(y,i)){return 1}return u?P.call(u,e)-P.call(u,i):0}return o&4?-1:1}return e.compareDocumentPosition?-1:1}:function(e,i){var n,o=0,s=e.parentNode,a=i.parentNode,r=[e],l=[i];if(e===i){T=true;return 0}else if(!s||!a){return e===t?-1:i===t?1:s?-1:a?1:u?P.call(u,e)-P.call(u,i):0}else if(s===a){return dt(e,i)}n=e;while(n=n.parentNode){r.unshift(n)}n=i;while(n=n.parentNode){l.unshift(n)}while(r[o]===l[o]){o++}return o?dt(r[o],l[o]):r[o]===y?-1:l[o]===y?1:0};return t};at.matches=function(e,t){return at(e,null,null,t)};at.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f){d(e)}t=t.replace(J,"='$1']");if(n.matchesSelector&&p&&(!m||!m.test(t))&&(!g||!g.test(t))){try{var i=v.call(e,t);if(i||n.disconnectedMatch||e.document&&e.document.nodeType!==11){return i}}catch(o){}}return at(t,f,null,[e]).length>0};at.contains=function(e,t){if((e.ownerDocument||e)!==f){d(e)}return _(e,t)};at.attr=function(e,i){if((e.ownerDocument||e)!==f){d(e)}var o=s.attrHandle[i.toLowerCase()],a=o&&N.call(s.attrHandle,i.toLowerCase())?o(e,i,!p):t;return a===t?n.attributes||!p?e.getAttribute(i):(a=e.getAttributeNode(i))&&a.specified?a.value:null:a};at.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};at.uniqueSort=function(e){var t,i=[],o=0,s=0;T=!n.detectDuplicates;u=!n.sortStable&&e.slice(0);e.sort(S);if(T){while(t=e[s++]){if(t===e[s]){o=i.push(s)}}while(o--){e.splice(i[o],1)}}return e};a=at.getText=function(e){var t,i="",n=0,o=e.nodeType;if(!o){for(;t=e[n];n++){i+=a(t)}}else if(o===1||o===9||o===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){i+=a(e)}}}else if(o===3||o===4){return e.nodeValue}return i};s=at.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(nt,ot);e[3]=(e[4]||e[5]||"").replace(nt,ot);if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1].slice(0,3)==="nth"){if(!e[3]){at.error(e[0])}e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd"));e[5]=+(e[7]+e[8]||e[3]==="odd")}else if(e[3]){at.error(e[0])}return e},PSEUDO:function(e){var i,n=!e[5]&&e[2];if(Q["CHILD"].test(e[0])){return null}if(e[3]&&e[4]!==t){e[2]=e[4]}else if(n&&Y.test(n)&&(i=mt(n,true))&&(i=n.indexOf(")",n.length-i)-n.length)){e[0]=e[0].slice(0,i);e[2]=n.slice(0,i)}return e.slice(0,3)}},filter:{TAG:function(e){var t=e.replace(nt,ot).toLowerCase();return e==="*"?function(){return true}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=C[e+" "];return t||(t=new RegExp("(^|"+R+")"+e+"("+R+"|$)"))&&C(e,function(e){return t.test(typeof e.className==="string"&&e.className||typeof e.getAttribute!==I&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var o=at.attr(n,e);if(o==null){return t==="!="}if(!t){return true}o+="";return t==="="?o===i:t==="!="?o!==i:t==="^="?i&&o.indexOf(i)===0:t==="*="?i&&o.indexOf(i)>-1:t==="$="?i&&o.slice(-i.length)===i:t==="~="?(" "+o+" ").indexOf(i)>-1:t==="|="?o===i||o.slice(0,i.length+1)===i+"-":false}},CHILD:function(e,t,i,n,o){var s=e.slice(0,3)!=="nth",a=e.slice(-4)!=="last",r=t==="of-type";return n===1&&o===0?function(e){return!!e.parentNode}:function(t,i,l){var c,u,d,f,h,p,g=s!==a?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),_=!l&&!r;if(m){if(s){while(g){d=t;while(d=d[g]){if(r?d.nodeName.toLowerCase()===v:d.nodeType===1){return false}}p=g=e==="only"&&!p&&"nextSibling"}return true}p=[a?m.firstChild:m.lastChild];if(a&&_){u=m[w]||(m[w]={});c=u[e]||[];h=c[0]===x&&c[1];f=c[0]===x&&c[2];d=h&&m.childNodes[h];while(d=++h&&d&&d[g]||(f=h=0)||p.pop()){if(d.nodeType===1&&++f&&d===t){u[e]=[x,h,f];break}}}else if(_&&(c=(t[w]||(t[w]={}))[e])&&c[0]===x){f=c[1]}else{while(d=++h&&d&&d[g]||(f=h=0)||p.pop()){if((r?d.nodeName.toLowerCase()===v:d.nodeType===1)&&++f){if(_){(d[w]||(d[w]={}))[e]=[x,f]}if(d===t){break}}}}f-=o;return f===n||f%n===0&&f/n>=0}}},PSEUDO:function(e,t){var i,n=s.pseudos[e]||s.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);if(n[w]){return n(t)}if(n.length>1){i=[e,e,"",t];return s.setFilters.hasOwnProperty(e.toLowerCase())?lt(function(e,i){var o,s=n(e,t),a=s.length;while(a--){o=P.call(e,s[a]);e[o]=!(i[o]=s[a])}}):function(e){return n(e,0,i)}}return n}},pseudos:{not:lt(function(e){var t=[],i=[],n=l(e.replace(z,"$1"));return n[w]?lt(function(e,t,i,o){var s,a=n(e,null,o,[]),r=e.length;while(r--){if(s=a[r]){e[r]=!(t[r]=s)}}}):function(e,o,s){t[0]=e;n(t,null,s,i);return!i.pop()}}),has:lt(function(e){return function(t){return at(e,t).length>0}}),contains:lt(function(e){return function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1}}),lang:lt(function(e){if(!X.test(e||"")){at.error("unsupported lang: "+e)}e=e.replace(nt,ot).toLowerCase();return function(t){var i;do{if(i=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang")){i=i.toLowerCase();return i===e||i.indexOf(e+"-")===0}}while((t=t.parentNode)&&t.nodeType===1);return false}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===false},disabled:function(e){return e.disabled===true},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling){if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4){return false}}return true},parent:function(e){return!s.pseudos["empty"](e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:pt(function(){return[0]}),last:pt(function(e,t){return[t-1]}),eq:pt(function(e,t,i){return[i<0?i+t:i]}),even:pt(function(e,t){var i=0;for(;i<t;i+=2){e.push(i)}return e}),odd:pt(function(e,t){var i=1;for(;i<t;i+=2){e.push(i)}return e}),lt:pt(function(e,t,i){var n=i<0?i+t:i;for(;--n>=0;){e.push(n)}return e}),gt:pt(function(e,t,i){var n=i<0?i+t:i;for(;++n<t;){e.push(n)}return e})}};s.pseudos["nth"]=s.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){s.pseudos[i]=ft(i)}for(i in{submit:true,reset:true}){s.pseudos[i]=ht(i)}function gt(){}gt.prototype=s.filters=s.pseudos;s.setFilters=new gt;function mt(e,t){var i,n,o,a,r,l,c,u=E[e+" "];if(u){return t?0:u.slice(0)}r=e;l=[];c=s.preFilter;while(r){if(!i||(n=q.exec(r))){if(n){r=r.slice(n[0].length)||r}l.push(o=[])}i=false;if(n=G.exec(r)){i=n.shift();o.push({value:i,type:n[0].replace(z," ")});r=r.slice(i.length)}for(a in s.filter){if((n=Q[a].exec(r))&&(!c[a]||(n=c[a](n)))){i=n.shift();o.push({value:i,type:a,matches:n});r=r.slice(i.length)}}if(!i){break}}return t?r.length:r?at.error(e):E(e,l).slice(0)}function vt(e){var t=0,i=e.length,n="";for(;t<i;t++){n+=e[t].value}return n}function _t(e,t,i){var n=t.dir,s=i&&n==="parentNode",a=j++;return t.first?function(t,i,o){while(t=t[n]){if(t.nodeType===1||s){return e(t,i,o)}}}:function(t,i,r){var l,c,u,d=x+" "+a;if(r){while(t=t[n]){if(t.nodeType===1||s){if(e(t,i,r)){return true}}}}else{while(t=t[n]){if(t.nodeType===1||s){u=t[w]||(t[w]={});if((c=u[n])&&c[0]===d){if((l=c[1])===true||l===o){return l===true}}else{c=u[n]=[d];c[1]=e(t,i,r)||o;if(c[1]===true){return true}}}}}}}function wt(e){return e.length>1?function(t,i,n){var o=e.length;while(o--){if(!e[o](t,i,n)){return false}}return true}:e[0]}function bt(e,t,i,n,o){var s,a=[],r=0,l=e.length,c=t!=null;for(;r<l;r++){if(s=e[r]){if(!i||i(s,n,o)){a.push(s);if(c){t.push(r)}}}}return a}function yt(e,t,i,n,o,s){if(n&&!n[w]){n=yt(n)}if(o&&!o[w]){o=yt(o,s)}return lt(function(s,a,r,l){var c,u,d,f=[],h=[],p=a.length,g=s||Ct(t||"*",r.nodeType?[r]:r,[]),m=e&&(s||!t)?bt(g,f,e,r,l):g,v=i?o||(s?e:p||n)?[]:a:m;if(i){i(m,v,r,l)}if(n){c=bt(v,h);n(c,[],r,l);u=c.length;while(u--){if(d=c[u]){v[h[u]]=!(m[h[u]]=d)}}}if(s){if(o||e){if(o){c=[];u=v.length;while(u--){if(d=v[u]){c.push(m[u]=d)}}o(null,v=[],c,l)}u=v.length;while(u--){if((d=v[u])&&(c=o?P.call(s,d):f[u])>-1){s[c]=!(a[c]=d)}}}}else{v=bt(v===a?v.splice(p,v.length):v);if(o){o(null,a,v,l)}else{L.apply(a,v)}}})}function xt(e){var t,i,n,o=e.length,a=s.relative[e[0].type],r=a||s.relative[" "],l=a?1:0,u=_t(function(e){return e===t},r,true),d=_t(function(e){return P.call(t,e)>-1},r,true),f=[function(e,i,n){return!a&&(n||i!==c)||((t=i).nodeType?u(e,i,n):d(e,i,n))}];for(;l<o;l++){if(i=s.relative[e[l].type]){f=[_t(wt(f),i)]}else{i=s.filter[e[l].type].apply(null,e[l].matches);if(i[w]){n=++l;for(;n<o;n++){if(s.relative[e[n].type]){break}}return yt(l>1&&wt(f),l>1&&vt(e.slice(0,l-1).concat({value:e[l-2].type===" "?"*":""})).replace(z,"$1"),i,l<n&&xt(e.slice(l,n)),n<o&&xt(e=e.slice(n)),n<o&&vt(e))}f.push(i)}}return wt(f)}function jt(e,t){var i=0,n=t.length>0,a=e.length>0,r=function(r,l,u,d,h){var p,g,m,v=[],_=0,w="0",b=r&&[],y=h!=null,j=c,C=r||a&&s.find["TAG"]("*",h&&l.parentNode||l),E=x+=j==null?1:Math.random()||.1;if(y){c=l!==f&&l;o=i}for(;(p=C[w])!=null;w++){if(a&&p){g=0;while(m=e[g++]){if(m(p,l,u)){d.push(p);break}}if(y){x=E;o=++i}}if(n){if(p=!m&&p){_--}if(r){b.push(p)}}}_+=w;if(n&&w!==_){g=0;while(m=t[g++]){m(b,v,l,u)}if(r){if(_>0){while(w--){if(!(b[w]||v[w])){v[w]=O.call(d)}}}v=bt(v)}L.apply(d,v);if(y&&!r&&v.length>0&&_+t.length>1){at.uniqueSort(d)}}if(y){x=E;c=j}return b};return n?lt(r):r}l=at.compile=function(e,t){var i,n=[],o=[],s=k[e+" "];if(!s){if(!t){t=mt(e)}i=t.length;while(i--){s=xt(t[i]);if(s[w]){n.push(s)}else{o.push(s)}}s=k(e,jt(o,n))}return s};function Ct(e,t,i){var n=0,o=t.length;for(;n<o;n++){at(e,t[n],i)}return i}function Et(e,t,i,o){var a,r,c,u,d,f=mt(e);if(!o){if(f.length===1){r=f[0]=f[0].slice(0);if(r.length>2&&(c=r[0]).type==="ID"&&n.getById&&t.nodeType===9&&p&&s.relative[r[1].type]){t=(s.find["ID"](c.matches[0].replace(nt,ot),t)||[])[0];if(!t){return i}e=e.slice(r.shift().value.length)}a=Q["needsContext"].test(e)?0:r.length;while(a--){c=r[a];if(s.relative[u=c.type]){break}if(d=s.find[u]){if(o=d(c.matches[0].replace(nt,ot),U.test(r[0].type)&&t.parentNode||t)){r.splice(a,1);e=o.length&&vt(r);if(!e){L.apply(i,o);return i}break}}}}}l(e,f)(o,t,!p,i,U.test(e));return i}n.sortStable=w.split("").sort(S).join("")===w;n.detectDuplicates=T;d();n.sortDetached=ct(function(e){return e.compareDocumentPosition(f.createElement("div"))&1});if(!ct(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){ut("type|href|height|width",function(e,t,i){if(!i){return e.getAttribute(t,t.toLowerCase()==="type"?1:2)}})}if(!n.attributes||!ct(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){ut("value",function(e,t,i){if(!i&&e.nodeName.toLowerCase()==="input"){return e.defaultValue}})}if(!ct(function(e){return e.getAttribute("disabled")==null})){ut(F,function(e,t,i){var n;if(!i){return(n=e.getAttributeNode(t))&&n.specified?n.value:e[t]===true?t.toLowerCase():null}})}b.find=at;b.expr=at.selectors;b.expr[":"]=b.expr.pseudos;b.unique=at.uniqueSort;b.text=at.getText;b.isXMLDoc=at.isXML;b.contains=at.contains})(e);var H={};function P(e){var t=H[e]={};b.each(e.match(x)||[],function(e,i){t[i]=true});return t}b.Callbacks=function(e){e=typeof e==="string"?H[e]||P(e):b.extend({},e);var i,n,o,s,a,r,l=[],c=!e.once&&[],u=function(t){n=e.memory&&t;o=true;a=r||0;r=0;s=l.length;i=true;for(;l&&a<s;a++){if(l[a].apply(t[0],t[1])===false&&e.stopOnFalse){n=false;break}}i=false;if(l){if(c){if(c.length){u(c.shift())}}else if(n){l=[]}else{d.disable()}}},d={add:function(){if(l){var t=l.length;(function o(t){b.each(t,function(t,i){var n=b.type(i);if(n==="function"){if(!e.unique||!d.has(i)){l.push(i)}}else if(i&&i.length&&n!=="string"){o(i)}})})(arguments);if(i){s=l.length}else if(n){r=t;u(n)}}return this},remove:function(){if(l){b.each(arguments,function(e,t){var n;while((n=b.inArray(t,l,n))>-1){l.splice(n,1);if(i){if(n<=s){s--}if(n<=a){a--}}}})}return this},has:function(e){return e?b.inArray(e,l)>-1:!!(l&&l.length)},empty:function(){l=[];s=0;return this},disable:function(){l=c=n=t;return this},disabled:function(){return!l},lock:function(){c=t;if(!n){d.disable()}return this},locked:function(){return!c},fireWith:function(e,t){if(l&&(!o||c)){t=t||[];t=[e,t.slice?t.slice():t];if(i){c.push(t)}else{u(t)}}return this},fire:function(){d.fireWith(this,arguments);return this},fired:function(){return!!o}};return d};b.extend({Deferred:function(e){var t=[["resolve","done",b.Callbacks("once memory"),"resolved"],["reject","fail",b.Callbacks("once memory"),"rejected"],["notify","progress",b.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){o.done(arguments).fail(arguments);return this},then:function(){var e=arguments;return b.Deferred(function(i){b.each(t,function(t,s){var a=s[0],r=b.isFunction(e[t])&&e[t];o[s[1]](function(){var e=r&&r.apply(this,arguments);if(e&&b.isFunction(e.promise)){e.promise().done(i.resolve).fail(i.reject).progress(i.notify)}else{i[a+"With"](this===n?i.promise():this,r?[e]:arguments)}})});e=null}).promise()},promise:function(e){return e!=null?b.extend(e,n):n}},o={};n.pipe=n.then;b.each(t,function(e,s){var a=s[2],r=s[3];n[s[1]]=a.add;if(r){a.add(function(){i=r},t[e^1][2].disable,t[2][2].lock)}o[s[0]]=function(){o[s[0]+"With"](this===o?n:this,arguments);return this};o[s[0]+"With"]=a.fireWith});n.promise(o);if(e){e.call(o,o)}return o},when:function(e){var t=0,i=g.call(arguments),n=i.length,o=n!==1||e&&b.isFunction(e.promise)?n:0,s=o===1?e:b.Deferred(),a=function(e,t,i){return function(n){t[e]=this;i[e]=arguments.length>1?g.call(arguments):n;if(i===r){s.notifyWith(t,i)}else if(!--o){s.resolveWith(t,i)}}},r,l,c;if(n>1){r=new Array(n);l=new Array(n);c=new Array(n);for(;t<n;t++){if(i[t]&&b.isFunction(i[t].promise)){i[t].promise().done(a(t,c,i)).fail(s.reject).progress(a(t,l,r))}else{--o}}}if(!o){s.resolveWith(c,i)}return s.promise()}});b.support=function(t){var i,n,s,r,l,c,u,d,f,h=a.createElement("div");h.setAttribute("className","t");h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";i=h.getElementsByTagName("*")||[];n=h.getElementsByTagName("a")[0];if(!n||!n.style||!i.length){return t}r=a.createElement("select");c=r.appendChild(a.createElement("option"));s=h.getElementsByTagName("input")[0];n.style.cssText="top:1px;float:left;opacity:.5";t.getSetAttribute=h.className!=="t";t.leadingWhitespace=h.firstChild.nodeType===3;t.tbody=!h.getElementsByTagName("tbody").length;t.htmlSerialize=!!h.getElementsByTagName("link").length;t.style=/top/.test(n.getAttribute("style"));t.hrefNormalized=n.getAttribute("href")==="/a";t.opacity=/^0.5/.test(n.style.opacity);t.cssFloat=!!n.style.cssFloat;t.checkOn=!!s.value;t.optSelected=c.selected;t.enctype=!!a.createElement("form").enctype;t.html5Clone=a.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";t.inlineBlockNeedsLayout=false;t.shrinkWrapBlocks=false;t.pixelPosition=false;t.deleteExpando=true;t.noCloneEvent=true;t.reliableMarginRight=true;t.boxSizingReliable=true;s.checked=true;t.noCloneChecked=s.cloneNode(true).checked;r.disabled=true;t.optDisabled=!c.disabled;try{delete h.test}catch(p){t.deleteExpando=false}s=a.createElement("input");s.setAttribute("value","");t.input=s.getAttribute("value")==="";s.value="t";s.setAttribute("type","radio");t.radioValue=s.value==="t";s.setAttribute("checked","t");s.setAttribute("name","t");l=a.createDocumentFragment();l.appendChild(s);t.appendChecked=s.checked;t.checkClone=l.cloneNode(true).cloneNode(true).lastChild.checked;if(h.attachEvent){h.attachEvent("onclick",function(){t.noCloneEvent=false});h.cloneNode(true).click()}for(f in{submit:true,change:true,focusin:true}){h.setAttribute(u="on"+f,"t");t[f+"Bubbles"]=u in e||h.attributes[u].expando===false}h.style.backgroundClip="content-box";h.cloneNode(true).style.backgroundClip="";t.clearCloneStyle=h.style.backgroundClip==="content-box";for(f in b(t)){break}t.ownLast=f!=="0";b(function(){var i,n,s,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=a.getElementsByTagName("body")[0];if(!l){return}i=a.createElement("div");i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";l.appendChild(i).appendChild(h);h.innerHTML="<table><tr><td></td><td>t</td></tr></table>";s=h.getElementsByTagName("td");s[0].style.cssText="padding:0;margin:0;border:0;display:none";d=s[0].offsetHeight===0;s[0].style.display="";s[1].style.display="none";t.reliableHiddenOffsets=d&&s[0].offsetHeight===0;h.innerHTML="";h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";b.swap(l,l.style.zoom!=null?{zoom:1}:{},function(){t.boxSizing=h.offsetWidth===4});if(e.getComputedStyle){t.pixelPosition=(e.getComputedStyle(h,null)||{}).top!=="1%";t.boxSizingReliable=(e.getComputedStyle(h,null)||{width:"4px"}).width==="4px";n=h.appendChild(a.createElement("div"));n.style.cssText=h.style.cssText=r;n.style.marginRight=n.style.width="0";h.style.width="1px";t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)}if(typeof h.style.zoom!==o){h.innerHTML="";h.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1";t.inlineBlockNeedsLayout=h.offsetWidth===3;h.style.display="block";h.innerHTML="<div></div>";h.firstChild.style.width="5px";t.shrinkWrapBlocks=h.offsetWidth!==3}l.removeChild(i);i=h=s=n=null});i=r=l=c=n=s=null;return t}({});var F=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,R=/([A-Z])/g;function B(e,i,n,o){if(!b.acceptData(e)){return}var s,a,r=b.expando,l=e.nodeType,c=l?b.cache:e,u=l?e[r]:e[r]&&r;if((!u||!c[u]||!o&&!c[u].data)&&n===t&&typeof i==="string"){return}if(!u){if(l){u=e[r]=d.pop()||b.guid++}else{u=r}}if(!c[u]){c[u]=l?{}:{toJSON:b.noop}}if(typeof i==="object"||typeof i==="function"){if(o){c[u]=b.extend(c[u],i)}else{c[u].data=b.extend(c[u].data,i)}}a=c[u];if(!o){if(!a.data){a.data={}}a=a.data}if(n!==t){a[b.camelCase(i)]=n}if(typeof i==="string"){s=a[i];if(s==null){s=a[b.camelCase(i)]}}else{s=a}return s}function W(e,t,i){if(!b.acceptData(e)){return}var n,o,s=e.nodeType,a=s?b.cache:e,r=s?e[b.expando]:b.expando;if(!a[r]){return}if(t){n=i?a[r]:a[r].data;if(n){if(!b.isArray(t)){if(t in n){t=[t]}else{t=b.camelCase(t);if(t in n){t=[t]}else{t=t.split(" ")}}}else{t=t.concat(b.map(t,b.camelCase))}o=t.length;while(o--){delete n[t[o]]}if(i?!V(n):!b.isEmptyObject(n)){return}}}if(!i){delete a[r].data;if(!V(a[r])){return}}if(s){b.cleanData([e],true)}else if(b.support.deleteExpando||a!=a.window){delete a[r]}else{a[r]=null}}b.extend({cache:{},noData:{applet:true,embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){e=e.nodeType?b.cache[e[b.expando]]:e[b.expando];return!!e&&!V(e)},data:function(e,t,i){return B(e,t,i)},removeData:function(e,t){return W(e,t)},_data:function(e,t,i){return B(e,t,i,true)},_removeData:function(e,t){return W(e,t,true)},acceptData:function(e){if(e.nodeType&&e.nodeType!==1&&e.nodeType!==9){return false}var t=e.nodeName&&b.noData[e.nodeName.toLowerCase()];return!t||t!==true&&e.getAttribute("classid")===t}});b.fn.extend({data:function(e,i){var n,o,s=null,a=0,r=this[0];if(e===t){if(this.length){s=b.data(r);if(r.nodeType===1&&!b._data(r,"parsedAttrs")){n=r.attributes;for(;a<n.length;a++){o=n[a].name;if(o.indexOf("data-")===0){o=b.camelCase(o.slice(5));$(r,o,s[o])}}b._data(r,"parsedAttrs",true)}}return s}if(typeof e==="object"){return this.each(function(){b.data(this,e)})}return arguments.length>1?this.each(function(){b.data(this,e,i)}):r?$(r,e,b.data(r,e)):null},removeData:function(e){return this.each(function(){b.removeData(this,e)})}});function $(e,i,n){if(n===t&&e.nodeType===1){var o="data-"+i.replace(R,"-$1").toLowerCase();n=e.getAttribute(o);if(typeof n==="string"){try{n=n==="true"?true:n==="false"?false:n==="null"?null:+n+""===n?+n:F.test(n)?b.parseJSON(n):n}catch(s){}b.data(e,i,n)}else{n=t}}return n}function V(e){var t;for(t in e){if(t==="data"&&b.isEmptyObject(e[t])){continue}if(t!=="toJSON"){return false}}return true}b.extend({queue:function(e,t,i){var n;if(e){t=(t||"fx")+"queue";n=b._data(e,t);if(i){if(!n||b.isArray(i)){n=b._data(e,t,b.makeArray(i))}else{n.push(i)}}return n||[]}},dequeue:function(e,t){t=t||"fx";var i=b.queue(e,t),n=i.length,o=i.shift(),s=b._queueHooks(e,t),a=function(){b.dequeue(e,t)};if(o==="inprogress"){o=i.shift();n--}if(o){if(t==="fx"){i.unshift("inprogress")}delete s.stop;o.call(e,a,s)}if(!n&&s){s.empty.fire()}},_queueHooks:function(e,t){var i=t+"queueHooks";return b._data(e,i)||b._data(e,i,{empty:b.Callbacks("once memory").add(function(){b._removeData(e,t+"queue");b._removeData(e,i)})})}});b.fn.extend({queue:function(e,i){var n=2;if(typeof e!=="string"){i=e;e="fx";n--}if(arguments.length<n){return b.queue(this[0],e)}return i===t?this:this.each(function(){var t=b.queue(this,e,i);b._queueHooks(this,e);if(e==="fx"&&t[0]!=="inprogress"){b.dequeue(this,e)}})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},delay:function(e,t){e=b.fx?b.fx.speeds[e]||e:e;t=t||"fx";return this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,o=1,s=b.Deferred(),a=this,r=this.length,l=function(){if(!--o){s.resolveWith(a,[a])}};if(typeof e!=="string"){i=e;e=t}e=e||"fx";while(r--){n=b._data(a[r],e+"queueHooks");if(n&&n.empty){o++;n.empty.add(l)}}l();return s.promise(i)}});var z,q,G=/[\t\r\n\f]/g,U=/\r/g,J=/^(?:input|select|textarea|button|object)$/i,Y=/^(?:a|area)$/i,X=/^(?:checked|selected)$/i,Q=b.support.getSetAttribute,Z=b.support.input;b.fn.extend({attr:function(e,t){return b.access(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})},prop:function(e,t){return b.access(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){e=b.propFix[e]||e;return this.each(function(){try{this[e]=t;delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,o,s,a=0,r=this.length,l=typeof e==="string"&&e;if(b.isFunction(e)){return this.each(function(t){b(this).addClass(e.call(this,t,this.className))})}if(l){t=(e||"").match(x)||[];for(;a<r;a++){i=this[a];n=i.nodeType===1&&(i.className?(" "+i.className+" ").replace(G," "):" ");if(n){s=0;while(o=t[s++]){if(n.indexOf(" "+o+" ")<0){n+=o+" "}}i.className=b.trim(n)}}}return this},removeClass:function(e){var t,i,n,o,s,a=0,r=this.length,l=arguments.length===0||typeof e==="string"&&e;if(b.isFunction(e)){return this.each(function(t){b(this).removeClass(e.call(this,t,this.className))})}if(l){t=(e||"").match(x)||[];for(;a<r;a++){i=this[a];n=i.nodeType===1&&(i.className?(" "+i.className+" ").replace(G," "):"");if(n){s=0;while(o=t[s++]){while(n.indexOf(" "+o+" ")>=0){n=n.replace(" "+o+" "," ")}}i.className=e?b.trim(n):""}}}return this},toggleClass:function(e,t){var i=typeof e;if(typeof t==="boolean"&&i==="string"){return t?this.addClass(e):this.removeClass(e)}if(b.isFunction(e)){return this.each(function(i){b(this).toggleClass(e.call(this,i,this.className,t),t)})}return this.each(function(){if(i==="string"){var t,n=0,s=b(this),a=e.match(x)||[];while(t=a[n++]){if(s.hasClass(t)){s.removeClass(t)}else{s.addClass(t)}}}else if(i===o||i==="boolean"){if(this.className){b._data(this,"__className__",this.className)}this.className=this.className||e===false?"":b._data(this,"__className__")||""}})},hasClass:function(e){var t=" "+e+" ",i=0,n=this.length;for(;i<n;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(G," ").indexOf(t)>=0){return true}}return false},val:function(e){var i,n,o,s=this[0];if(!arguments.length){if(s){n=b.valHooks[s.type]||b.valHooks[s.nodeName.toLowerCase()];if(n&&"get"in n&&(i=n.get(s,"value"))!==t){return i}i=s.value;return typeof i==="string"?i.replace(U,""):i==null?"":i}return}o=b.isFunction(e);return this.each(function(i){var s;if(this.nodeType!==1){return}if(o){s=e.call(this,i,b(this).val())}else{s=e}if(s==null){s=""}else if(typeof s==="number"){s+=""}else if(b.isArray(s)){s=b.map(s,function(e){return e==null?"":e+""})}n=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t){this.value=s}})}});b.extend({valHooks:{option:{get:function(e){var t=b.find.attr(e,"value");return t!=null?t:e.text}},select:{get:function(e){var t,i,n=e.options,o=e.selectedIndex,s=e.type==="select-one"||o<0,a=s?null:[],r=s?o+1:n.length,l=o<0?r:s?o:0;for(;l<r;l++){i=n[l];if((i.selected||l===o)&&(b.support.optDisabled?!i.disabled:i.getAttribute("disabled")===null)&&(!i.parentNode.disabled||!b.nodeName(i.parentNode,"optgroup"))){t=b(i).val();if(s){return t}a.push(t)}}return a},set:function(e,t){var i,n,o=e.options,s=b.makeArray(t),a=o.length;while(a--){n=o[a];if(n.selected=b.inArray(b(n).val(),s)>=0){i=true}}if(!i){e.selectedIndex=-1}return s}}},attr:function(e,i,n){var s,a,r=e.nodeType;if(!e||r===3||r===8||r===2){return}if(typeof e.getAttribute===o){return b.prop(e,i,n)}if(r!==1||!b.isXMLDoc(e)){i=i.toLowerCase();s=b.attrHooks[i]||(b.expr.match.bool.test(i)?q:z)}if(n!==t){if(n===null){b.removeAttr(e,i)}else if(s&&"set"in s&&(a=s.set(e,n,i))!==t){return a}else{e.setAttribute(i,n+"");return n}}else if(s&&"get"in s&&(a=s.get(e,i))!==null){return a}else{a=b.find.attr(e,i);return a==null?t:a}},removeAttr:function(e,t){var i,n,o=0,s=t&&t.match(x);if(s&&e.nodeType===1){while(i=s[o++]){n=b.propFix[i]||i;if(b.expr.match.bool.test(i)){if(Z&&Q||!X.test(i)){e[n]=false}else{e[b.camelCase("default-"+i)]=e[n]=false}}else{b.attr(e,i,"")}e.removeAttribute(Q?i:n)}}},attrHooks:{type:{set:function(e,t){if(!b.support.radioValue&&t==="radio"&&b.nodeName(e,"input")){var i=e.value;e.setAttribute("type",t);if(i){e.value=i}return t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,i,n){var o,s,a,r=e.nodeType;if(!e||r===3||r===8||r===2){return}a=r!==1||!b.isXMLDoc(e);if(a){i=b.propFix[i]||i;s=b.propHooks[i]}if(n!==t){return s&&"set"in s&&(o=s.set(e,n,i))!==t?o:e[i]=n}else{return s&&"get"in s&&(o=s.get(e,i))!==null?o:e[i]}},propHooks:{tabIndex:{get:function(e){var t=b.find.attr(e,"tabindex");return t?parseInt(t,10):J.test(e.nodeName)||Y.test(e.nodeName)&&e.href?0:-1}}}});q={set:function(e,t,i){if(t===false){b.removeAttr(e,i)}else if(Z&&Q||!X.test(i)){e.setAttribute(!Q&&b.propFix[i]||i,i)}else{e[b.camelCase("default-"+i)]=e[i]=true}return i}};b.each(b.expr.match.bool.source.match(/\w+/g),function(e,i){var n=b.expr.attrHandle[i]||b.find.attr;b.expr.attrHandle[i]=Z&&Q||!X.test(i)?function(e,i,o){var s=b.expr.attrHandle[i],a=o?t:(b.expr.attrHandle[i]=t)!=n(e,i,o)?i.toLowerCase():null;b.expr.attrHandle[i]=s;return a}:function(e,i,n){return n?t:e[b.camelCase("default-"+i)]?i.toLowerCase():null}});if(!Z||!Q){b.attrHooks.value={set:function(e,t,i){if(b.nodeName(e,"input")){e.defaultValue=t}else{return z&&z.set(e,t,i)}}}}if(!Q){z={set:function(e,i,n){var o=e.getAttributeNode(n);if(!o){e.setAttributeNode(o=e.ownerDocument.createAttribute(n))}o.value=i+="";return n==="value"||i===e.getAttribute(n)?i:t}};b.expr.attrHandle.id=b.expr.attrHandle.name=b.expr.attrHandle.coords=function(e,i,n){var o;return n?t:(o=e.getAttributeNode(i))&&o.value!==""?o.value:null};b.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&n.specified?n.value:t},set:z.set};b.attrHooks.contenteditable={set:function(e,t,i){z.set(e,t===""?false:t,i)}};b.each(["width","height"],function(e,t){b.attrHooks[t]={set:function(e,i){if(i===""){e.setAttribute(t,"auto");return i}}}})}if(!b.support.hrefNormalized){b.each(["href","src"],function(e,t){b.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})}if(!b.support.style){b.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}}if(!b.support.optSelected){b.propHooks.selected={get:function(e){var t=e.parentNode;if(t){t.selectedIndex;if(t.parentNode){t.parentNode.selectedIndex}}return null}}}b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){b.propFix[this.toLowerCase()]=this});if(!b.support.enctype){b.propFix.enctype="encoding"}b.each(["radio","checkbox"],function(){b.valHooks[this]={set:function(e,t){if(b.isArray(t)){return e.checked=b.inArray(b(e).val(),t)>=0}}};if(!b.support.checkOn){b.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value}}});var K=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,it=/^(?:focusinfocus|focusoutblur)$/,nt=/^([^.]*)(?:\.(.+)|)$/;function ot(){return true}function st(){return false}function at(){try{return a.activeElement}catch(e){}}b.event={global:{},add:function(e,i,n,s,a){var r,l,c,u,d,f,h,p,g,m,v,_=b._data(e);if(!_){return}if(n.handler){u=n;n=u.handler;a=u.selector}if(!n.guid){n.guid=b.guid++}if(!(l=_.events)){l=_.events={}}if(!(f=_.handle)){f=_.handle=function(e){return typeof b!==o&&(!e||b.event.triggered!==e.type)?b.event.dispatch.apply(f.elem,arguments):t};f.elem=e}i=(i||"").match(x)||[""];c=i.length;while(c--){r=nt.exec(i[c])||[];g=v=r[1];m=(r[2]||"").split(".").sort();if(!g){continue}d=b.event.special[g]||{};g=(a?d.delegateType:d.bindType)||g;d=b.event.special[g]||{};h=b.extend({type:g,origType:v,data:s,handler:n,guid:n.guid,selector:a,needsContext:a&&b.expr.match.needsContext.test(a),namespace:m.join(".")},u);if(!(p=l[g])){p=l[g]=[];p.delegateCount=0;if(!d.setup||d.setup.call(e,s,m,f)===false){if(e.addEventListener){e.addEventListener(g,f,false)}else if(e.attachEvent){e.attachEvent("on"+g,f)}}}if(d.add){d.add.call(e,h);if(!h.handler.guid){h.handler.guid=n.guid}}if(a){p.splice(p.delegateCount++,0,h)}else{p.push(h)}b.event.global[g]=true}e=null},remove:function(e,t,i,n,o){var s,a,r,l,c,u,d,f,h,p,g,m=b.hasData(e)&&b._data(e);if(!m||!(u=m.events)){return}t=(t||"").match(x)||[""];c=t.length;while(c--){r=nt.exec(t[c])||[];h=g=r[1];p=(r[2]||"").split(".").sort();if(!h){for(h in u){b.event.remove(e,h+t[c],i,n,true)}continue}d=b.event.special[h]||{};h=(n?d.delegateType:d.bindType)||h;f=u[h]||[];r=r[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)");l=s=f.length;while(s--){a=f[s];if((o||g===a.origType)&&(!i||i.guid===a.guid)&&(!r||r.test(a.namespace))&&(!n||n===a.selector||n==="**"&&a.selector)){f.splice(s,1);if(a.selector){f.delegateCount--}if(d.remove){d.remove.call(e,a)}}}if(l&&!f.length){if(!d.teardown||d.teardown.call(e,p,m.handle)===false){b.removeEvent(e,h,m.handle)}delete u[h]}}if(b.isEmptyObject(u)){delete m.handle;b._removeData(e,"events")}},trigger:function(i,n,o,s){var r,l,c,u,d,f,h,p=[o||a],g=_.call(i,"type")?i.type:i,m=_.call(i,"namespace")?i.namespace.split("."):[];c=f=o=o||a;if(o.nodeType===3||o.nodeType===8){return}if(it.test(g+b.event.triggered)){return}if(g.indexOf(".")>=0){m=g.split(".");g=m.shift();m.sort()}l=g.indexOf(":")<0&&"on"+g;i=i[b.expando]?i:new b.Event(g,typeof i==="object"&&i);i.isTrigger=s?2:3;i.namespace=m.join(".");i.namespace_re=i.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;i.result=t;if(!i.target){i.target=o}n=n==null?[i]:b.makeArray(n,[i]);d=b.event.special[g]||{};if(!s&&d.trigger&&d.trigger.apply(o,n)===false){return}if(!s&&!d.noBubble&&!b.isWindow(o)){u=d.delegateType||g;if(!it.test(u+g)){c=c.parentNode}for(;c;c=c.parentNode){p.push(c);f=c}if(f===(o.ownerDocument||a)){p.push(f.defaultView||f.parentWindow||e)}}h=0;while((c=p[h++])&&!i.isPropagationStopped()){i.type=h>1?u:d.bindType||g;r=(b._data(c,"events")||{})[i.type]&&b._data(c,"handle");if(r){r.apply(c,n)}r=l&&c[l];if(r&&b.acceptData(c)&&r.apply&&r.apply(c,n)===false){i.preventDefault()}}i.type=g;if(!s&&!i.isDefaultPrevented()){if((!d._default||d._default.apply(p.pop(),n)===false)&&b.acceptData(o)){if(l&&o[g]&&!b.isWindow(o)){f=o[l];if(f){o[l]=null}b.event.triggered=g;try{o[g]()}catch(v){}b.event.triggered=t;if(f){o[l]=f}}}}return i.result},dispatch:function(e){e=b.event.fix(e);var i,n,o,s,a,r=[],l=g.call(arguments),c=(b._data(this,"events")||{})[e.type]||[],u=b.event.special[e.type]||{};l[0]=e;e.delegateTarget=this;if(u.preDispatch&&u.preDispatch.call(this,e)===false){return}r=b.event.handlers.call(this,e,c);i=0;while((s=r[i++])&&!e.isPropagationStopped()){e.currentTarget=s.elem;a=0;while((o=s.handlers[a++])&&!e.isImmediatePropagationStopped()){if(!e.namespace_re||e.namespace_re.test(o.namespace)){e.handleObj=o;e.data=o.data;n=((b.event.special[o.origType]||{}).handle||o.handler).apply(s.elem,l);if(n!==t){if((e.result=n)===false){e.preventDefault();e.stopPropagation()}}}}}if(u.postDispatch){u.postDispatch.call(this,e)}return e.result},handlers:function(e,i){var n,o,s,a,r=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||e.type!=="click")){for(;c!=this;c=c.parentNode||this){if(c.nodeType===1&&(c.disabled!==true||e.type!=="click")){s=[];for(a=0;a<l;a++){o=i[a];n=o.selector+" ";if(s[n]===t){s[n]=o.needsContext?b(n,this).index(c)>=0:b.find(n,this,null,[c]).length}if(s[n]){s.push(o)}}if(s.length){r.push({elem:c,handlers:s})}}}}if(l<i.length){r.push({elem:this,handlers:i.slice(l)})}return r},fix:function(e){if(e[b.expando]){return e}var t,i,n,o=e.type,s=e,r=this.fixHooks[o];if(!r){this.fixHooks[o]=r=tt.test(o)?this.mouseHooks:et.test(o)?this.keyHooks:{}}n=r.props?this.props.concat(r.props):this.props;e=new b.Event(s);t=n.length;while(t--){i=n[t];e[i]=s[i]}if(!e.target){e.target=s.srcElement||a}if(e.target.nodeType===3){e.target=e.target.parentNode}e.metaKey=!!e.metaKey;return r.filter?r.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){if(e.which==null){e.which=t.charCode!=null?t.charCode:t.keyCode}return e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,o,s,r=i.button,l=i.fromElement;if(e.pageX==null&&i.clientX!=null){o=e.target.ownerDocument||a;s=o.documentElement;n=o.body;e.pageX=i.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0);e.pageY=i.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)}if(!e.relatedTarget&&l){e.relatedTarget=l===e.target?i.toElement:l}if(!e.which&&r!==t){e.which=r&1?1:r&2?3:r&4?2:0}return e}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==at()&&this.focus){try{this.focus();return false}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===at()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(b.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}},_default:function(e){return b.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){if(e.result!==t){e.originalEvent.returnValue=e.result}}}},simulate:function(e,t,i,n){var o=b.extend(new b.Event,i,{type:e,isSimulated:true,originalEvent:{}});if(n){b.event.trigger(o,null,t)}else{b.event.dispatch.call(t,o)}if(o.isDefaultPrevented()){i.preventDefault()}}};b.removeEvent=a.removeEventListener?function(e,t,i){if(e.removeEventListener){e.removeEventListener(t,i,false)}}:function(e,t,i){var n="on"+t;if(e.detachEvent){if(typeof e[n]===o){e[n]=null}e.detachEvent(n,i)}};b.Event=function(e,t){if(!(this instanceof b.Event)){return new b.Event(e,t)}if(e&&e.type){this.originalEvent=e;this.type=e.type;this.isDefaultPrevented=e.defaultPrevented||e.returnValue===false||e.getPreventDefault&&e.getPreventDefault()?ot:st}else{this.type=e}if(t){b.extend(this,t)}this.timeStamp=e&&e.timeStamp||b.now();this[b.expando]=true};b.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ot;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ot;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ot;this.stopPropagation()}};b.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,o=e.relatedTarget,s=e.handleObj;if(!o||o!==n&&!b.contains(n,o)){e.type=s.origType;i=s.handler.apply(this,arguments);e.type=t}return i}}});if(!b.support.submitBubbles){b.event.special.submit={setup:function(){if(b.nodeName(this,"form")){return false}b.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=b.nodeName(i,"input")||b.nodeName(i,"button")?i.form:t;if(n&&!b._data(n,"submitBubbles")){b.event.add(n,"submit._submit",function(e){e._submit_bubble=true});b._data(n,"submitBubbles",true)}})},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;if(this.parentNode&&!e.isTrigger){b.event.simulate("submit",this.parentNode,e,true)}}},teardown:function(){if(b.nodeName(this,"form")){return false}b.event.remove(this,"._submit")}}}if(!b.support.changeBubbles){b.event.special.change={setup:function(){if(K.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){b.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true}});b.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false}b.event.simulate("change",this,e,true)})}return false}b.event.add(this,"beforeactivate._change",function(e){var t=e.target;if(K.test(t.nodeName)&&!b._data(t,"changeBubbles")){b.event.add(t,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){b.event.simulate("change",this.parentNode,e,true)}});b._data(t,"changeBubbles",true)}})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox"){return e.handleObj.handler.apply(this,arguments)}},teardown:function(){b.event.remove(this,"._change");return!K.test(this.nodeName)}}}if(!b.support.focusinBubbles){b.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){b.event.simulate(t,e.target,b.event.fix(e),true)};b.event.special[t]={setup:function(){if(i++===0){a.addEventListener(e,n,true)}},teardown:function(){if(--i===0){a.removeEventListener(e,n,true)}}}})}b.fn.extend({on:function(e,i,n,o,s){var a,r;if(typeof e==="object"){if(typeof i!=="string"){n=n||i;i=t}for(a in e){this.on(a,i,n,e[a],s)}return this}if(n==null&&o==null){o=i;n=i=t}else if(o==null){if(typeof i==="string"){o=n;n=t}else{o=n;n=i;i=t}}if(o===false){o=st}else if(!o){return this}if(s===1){r=o;o=function(e){b().off(e);return r.apply(this,arguments)};o.guid=r.guid||(r.guid=b.guid++)}return this.each(function(){b.event.add(this,e,o,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var o,s;if(e&&e.preventDefault&&e.handleObj){o=e.handleObj;b(e.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler);return this}if(typeof e==="object"){for(s in e){this.off(s,i,e[s])}return this}if(i===false||typeof i==="function"){n=i;i=t}if(n===false){n=st}return this.each(function(){b.event.remove(this,e,n,i)})},trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i){return b.event.trigger(e,t,i,true)}}});var rt=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ct=b.expr.match.needsContext,ut={children:true,contents:true,next:true,prev:true};b.fn.extend({find:function(e){var t,i=[],n=this,o=n.length;if(typeof e!=="string"){return this.pushStack(b(e).filter(function(){for(t=0;t<o;t++){if(b.contains(n[t],this)){return true}}}))}for(t=0;t<o;t++){b.find(e,n[t],i)}i=this.pushStack(o>1?b.unique(i):i);i.selector=this.selector?this.selector+" "+e:e;return i},has:function(e){var t,i=b(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++){if(b.contains(this,i[t])){return true}}})},not:function(e){return this.pushStack(ft(this,e||[],true))},filter:function(e){return this.pushStack(ft(this,e||[],false))},is:function(e){return!!ft(this,typeof e==="string"&&ct.test(e)?b(e):e||[],false).length},closest:function(e,t){var i,n=0,o=this.length,s=[],a=ct.test(e)||typeof e!=="string"?b(e,t||this.context):0;for(;n<o;n++){for(i=this[n];i&&i!==t;i=i.parentNode){if(i.nodeType<11&&(a?a.index(i)>-1:i.nodeType===1&&b.find.matchesSelector(i,e))){i=s.push(i);break}}}return this.pushStack(s.length>1?b.unique(s):s)},index:function(e){if(!e){return this[0]&&this[0].parentNode?this.first().prevAll().length:-1}if(typeof e==="string"){return b.inArray(this[0],b(e))}return b.inArray(e.jquery?e[0]:e,this)},add:function(e,t){var i=typeof e==="string"?b(e,t):b.makeArray(e&&e.nodeType?[e]:e),n=b.merge(this.get(),i);return this.pushStack(b.unique(n))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});function dt(e,t){do{e=e[t]}while(e&&e.nodeType!==1);return e}b.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return b.dir(e,"parentNode")},parentsUntil:function(e,t,i){return b.dir(e,"parentNode",i)},next:function(e){return dt(e,"nextSibling")},prev:function(e){return dt(e,"previousSibling")},nextAll:function(e){return b.dir(e,"nextSibling")},prevAll:function(e){return b.dir(e,"previousSibling")},nextUntil:function(e,t,i){return b.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return b.dir(e,"previousSibling",i)},siblings:function(e){return b.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return b.sibling(e.firstChild)},contents:function(e){return b.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:b.merge([],e.childNodes)}},function(e,t){b.fn[e]=function(i,n){var o=b.map(this,t,i);if(e.slice(-5)!=="Until"){n=i}if(n&&typeof n==="string"){o=b.filter(n,o)}if(this.length>1){if(!ut[e]){o=b.unique(o)}if(lt.test(e)){o=o.reverse()}}return this.pushStack(o)}});b.extend({filter:function(e,t,i){var n=t[0];if(i){e=":not("+e+")"}return t.length===1&&n.nodeType===1?b.find.matchesSelector(n,e)?[n]:[]:b.find.matches(e,b.grep(t,function(e){return e.nodeType===1}))},dir:function(e,i,n){var o=[],s=e[i];while(s&&s.nodeType!==9&&(n===t||s.nodeType!==1||!b(s).is(n))){if(s.nodeType===1){o.push(s)}s=s[i]}return o},sibling:function(e,t){var i=[];for(;e;e=e.nextSibling){if(e.nodeType===1&&e!==t){i.push(e)}}return i}});function ft(e,t,i){if(b.isFunction(t)){return b.grep(e,function(e,n){return!!t.call(e,n,e)!==i})}if(t.nodeType){return b.grep(e,function(e){return e===t!==i})}if(typeof t==="string"){if(rt.test(t)){return b.filter(t,e,i)}t=b.filter(t,e)}return b.grep(e,function(e){return b.inArray(e,t)>=0!==i})}function ht(e){var t=pt.split("|"),i=e.createDocumentFragment();if(i.createElement){while(t.length){i.createElement(t.pop())}}return i}var pt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=new RegExp("<(?:"+pt+")[\\s/>]","i"),vt=/^\s+/,_t=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,wt=/<([\w:]+)/,bt=/<tbody/i,yt=/<|&#?\w+;/,xt=/<(?:script|style|link)/i,jt=/^(?:checkbox|radio)$/i,Ct=/checked\s*(?:[^=]|=\s*.checked.)/i,Et=/^$|\/(?:java|ecma)script/i,kt=/^true\/(.*)/,Tt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,St={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:b.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},It=ht(a),Mt=It.appendChild(a.createElement("div"));St.optgroup=St.option;St.tbody=St.tfoot=St.colgroup=St.caption=St.thead;St.th=St.td;b.fn.extend({text:function(e){return b.access(this,function(e){return e===t?b.text(this):this.empty().append((this[0]&&this[0].ownerDocument||a).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Nt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=Nt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this)}})},after:function(){return this.domManip(arguments,function(e){if(this.parentNode){this.parentNode.insertBefore(e,this.nextSibling)}})},remove:function(e,t){var i,n=e?b.filter(e,this):this,o=0;for(;(i=n[o])!=null;o++){if(!t&&i.nodeType===1){b.cleanData(Pt(i))}if(i.parentNode){if(t&&b.contains(i.ownerDocument,i)){Dt(Pt(i,"script"))}i.parentNode.removeChild(i)}}return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){if(e.nodeType===1){b.cleanData(Pt(e,false))}while(e.firstChild){e.removeChild(e.firstChild)}if(e.options&&b.nodeName(e,"select")){e.options.length=0}}return this},clone:function(e,t){e=e==null?false:e;t=t==null?e:t;return this.map(function(){return b.clone(this,e,t)})},html:function(e){return b.access(this,function(e){var i=this[0]||{},n=0,o=this.length;if(e===t){return i.nodeType===1?i.innerHTML.replace(gt,""):t}if(typeof e==="string"&&!xt.test(e)&&(b.support.htmlSerialize||!mt.test(e))&&(b.support.leadingWhitespace||!vt.test(e))&&!St[(wt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(_t,"<$1></$2>");try{for(;n<o;n++){i=this[n]||{};if(i.nodeType===1){b.cleanData(Pt(i,false));i.innerHTML=e}}i=0}catch(s){}}if(i){this.empty().append(e)}},null,e,arguments.length)},replaceWith:function(){var e=b.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;this.domManip(arguments,function(i){var n=e[t++],o=e[t++];if(o){if(n&&n.parentNode!==o){n=this.nextSibling}b(this).remove();o.insertBefore(i,n)}},true);return t?this:this.remove()},detach:function(e){return this.remove(e,true)},domManip:function(e,t,i){e=h.apply([],e);var n,o,s,a,r,l,c=0,u=this.length,d=this,f=u-1,p=e[0],g=b.isFunction(p);if(g||!(u<=1||typeof p!=="string"||b.support.checkClone||!Ct.test(p))){return this.each(function(n){var o=d.eq(n);if(g){e[0]=p.call(this,n,o.html())}o.domManip(e,t,i)})}if(u){l=b.buildFragment(e,this[0].ownerDocument,false,!i&&this);n=l.firstChild;if(l.childNodes.length===1){l=n}if(n){a=b.map(Pt(l,"script"),At);s=a.length;for(;c<u;c++){o=l;if(c!==f){o=b.clone(o,true,true);if(s){b.merge(a,Pt(o,"script"))}}t.call(this[c],o,c)}if(s){r=a[a.length-1].ownerDocument;b.map(a,Ot);for(c=0;c<s;c++){o=a[c];if(Et.test(o.type||"")&&!b._data(o,"globalEval")&&b.contains(r,o)){if(o.src){b._evalUrl(o.src)}else{b.globalEval((o.text||o.textContent||o.innerHTML||"").replace(Tt,""))}}}}l=n=null}}return this}});function Nt(e,t){return b.nodeName(e,"table")&&b.nodeName(t.nodeType===1?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function At(e){e.type=(b.find.attr(e,"type")!==null)+"/"+e.type;return e}function Ot(e){var t=kt.exec(e.type);if(t){e.type=t[1]}else{e.removeAttribute("type")}return e}function Dt(e,t){var i,n=0;for(;(i=e[n])!=null;n++){b._data(i,"globalEval",!t||b._data(t[n],"globalEval"))}}function Lt(e,t){if(t.nodeType!==1||!b.hasData(e)){return}var i,n,o,s=b._data(e),a=b._data(t,s),r=s.events;if(r){delete a.handle;a.events={};for(i in r){for(n=0,o=r[i].length;n<o;n++){b.event.add(t,i,r[i][n])}}}if(a.data){a.data=b.extend({},a.data)}}function Ht(e,t){var i,n,o;if(t.nodeType!==1){return}i=t.nodeName.toLowerCase();if(!b.support.noCloneEvent&&t[b.expando]){o=b._data(t);for(n in o.events){b.removeEvent(t,n,o.handle)}t.removeAttribute(b.expando)}if(i==="script"&&t.text!==e.text){At(t).text=e.text;Ot(t)}else if(i==="object"){if(t.parentNode){t.outerHTML=e.outerHTML}if(b.support.html5Clone&&(e.innerHTML&&!b.trim(t.innerHTML))){t.innerHTML=e.innerHTML}}else if(i==="input"&&jt.test(e.type)){t.defaultChecked=t.checked=e.checked;if(t.value!==e.value){t.value=e.value}}else if(i==="option"){t.defaultSelected=t.selected=e.defaultSelected}else if(i==="input"||i==="textarea"){t.defaultValue=e.defaultValue}}b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){var i,n=0,o=[],s=b(e),a=s.length-1;for(;n<=a;n++){i=n===a?this:this.clone(true);b(s[n])[t](i);p.apply(o,i.get())}return this.pushStack(o)}});function Pt(e,i){var n,s,a=0,r=typeof e.getElementsByTagName!==o?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==o?e.querySelectorAll(i||"*"):t;if(!r){for(r=[],n=e.childNodes||e;(s=n[a])!=null;a++){if(!i||b.nodeName(s,i)){r.push(s)}else{b.merge(r,Pt(s,i))}}}return i===t||i&&b.nodeName(e,i)?b.merge([e],r):r}function Ft(e){if(jt.test(e.type)){e.defaultChecked=e.checked}}b.extend({clone:function(e,t,i){var n,o,s,a,r,l=b.contains(e.ownerDocument,e);if(b.support.html5Clone||b.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")){s=e.cloneNode(true)}else{Mt.innerHTML=e.outerHTML;Mt.removeChild(s=Mt.firstChild)}if((!b.support.noCloneEvent||!b.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!b.isXMLDoc(e)){n=Pt(s);r=Pt(e);for(a=0;(o=r[a])!=null;++a){if(n[a]){Ht(o,n[a])}}}if(t){if(i){r=r||Pt(e);n=n||Pt(s);for(a=0;(o=r[a])!=null;a++){Lt(o,n[a])}}else{Lt(e,s)}}n=Pt(s,"script");if(n.length>0){Dt(n,!l&&Pt(e,"script"))}n=r=o=null;return s},buildFragment:function(e,t,i,n){var o,s,a,r,l,c,u,d=e.length,f=ht(t),h=[],p=0;for(;p<d;p++){s=e[p];if(s||s===0){if(b.type(s)==="object"){b.merge(h,s.nodeType?[s]:s)}else if(!yt.test(s)){h.push(t.createTextNode(s))}else{r=r||f.appendChild(t.createElement("div"));l=(wt.exec(s)||["",""])[1].toLowerCase();u=St[l]||St._default;r.innerHTML=u[1]+s.replace(_t,"<$1></$2>")+u[2];o=u[0];while(o--){r=r.lastChild}if(!b.support.leadingWhitespace&&vt.test(s)){h.push(t.createTextNode(vt.exec(s)[0]))}if(!b.support.tbody){s=l==="table"&&!bt.test(s)?r.firstChild:u[1]==="<table>"&&!bt.test(s)?r:0;o=s&&s.childNodes.length;while(o--){if(b.nodeName(c=s.childNodes[o],"tbody")&&!c.childNodes.length){s.removeChild(c)}}}b.merge(h,r.childNodes);r.textContent="";while(r.firstChild){r.removeChild(r.firstChild)}r=f.lastChild}}}if(r){f.removeChild(r)}if(!b.support.appendChecked){b.grep(Pt(h,"input"),Ft)}p=0;while(s=h[p++]){if(n&&b.inArray(s,n)!==-1){continue}a=b.contains(s.ownerDocument,s);r=Pt(f.appendChild(s),"script");if(a){Dt(r)}if(i){o=0;while(s=r[o++]){if(Et.test(s.type||"")){i.push(s)}}}}r=null;return f},cleanData:function(e,t){var i,n,s,a,r=0,l=b.expando,c=b.cache,u=b.support.deleteExpando,f=b.event.special;for(;(i=e[r])!=null;r++){if(t||b.acceptData(i)){s=i[l];a=s&&c[s];if(a){if(a.events){for(n in a.events){if(f[n]){b.event.remove(i,n)}else{b.removeEvent(i,n,a.handle)}}}if(c[s]){delete c[s];if(u){delete i[l]}else if(typeof i.removeAttribute!==o){i.removeAttribute(l)}else{i[l]=null}d.push(s)}}}}},_evalUrl:function(e){return b.ajax({url:e,type:"GET",dataType:"script",async:false,global:false,"throws":true})}});b.fn.extend({wrapAll:function(e){if(b.isFunction(e)){return this.each(function(t){b(this).wrapAll(e.call(this,t))})}if(this[0]){var t=b(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){t.insertBefore(this[0])}t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1){e=e.firstChild}return e}).append(this)}return this},wrapInner:function(e){if(b.isFunction(e)){return this.each(function(t){b(this).wrapInner(e.call(this,t))})}return this.each(function(){var t=b(this),i=t.contents();if(i.length){i.wrapAll(e)}else{t.append(e)}})},wrap:function(e){var t=b.isFunction(e);return this.each(function(i){b(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){if(!b.nodeName(this,"body")){b(this).replaceWith(this.childNodes)}}).end()}});var Rt,Bt,Wt,$t=/alpha\([^)]*\)/i,Vt=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,qt=/^(none|table(?!-c[ea]).+)/,Gt=/^margin/,Ut=new RegExp("^("+y+")(.*)$","i"),Jt=new RegExp("^("+y+")(?!px)[a-z%]+$","i"),Yt=new RegExp("^([+-])=("+y+")","i"),Xt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Zt={letterSpacing:0,fontWeight:400},Kt=["Top","Right","Bottom","Left"],ei=["Webkit","O","Moz","ms"];function ti(e,t){if(t in e){return t}var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,o=ei.length;while(o--){t=ei[o]+i;if(t in e){return t}}return n}function ii(e,t){e=t||e;return b.css(e,"display")==="none"||!b.contains(e.ownerDocument,e)}function ni(e,t){var i,n,o,s=[],a=0,r=e.length;for(;a<r;a++){n=e[a];if(!n.style){continue}s[a]=b._data(n,"olddisplay");i=n.style.display;if(t){if(!s[a]&&i==="none"){n.style.display=""}if(n.style.display===""&&ii(n)){s[a]=b._data(n,"olddisplay",ri(n.nodeName))}}else{if(!s[a]){o=ii(n);if(i&&i!=="none"||!o){b._data(n,"olddisplay",o?i:b.css(n,"display"))}}}}for(a=0;a<r;a++){n=e[a];if(!n.style){continue}if(!t||n.style.display==="none"||n.style.display===""){n.style.display=t?s[a]||"":"none"}}return e}b.fn.extend({css:function(e,i){return b.access(this,function(e,i,n){var o,s,a={},r=0;if(b.isArray(i)){s=Bt(e);o=i.length;for(;r<o;r++){a[i[r]]=b.css(e,i[r],false,s)}return a}return n!==t?b.style(e,i,n):b.css(e,i)},e,i,arguments.length>1)},show:function(){return ni(this,true)},hide:function(){return ni(this)},toggle:function(e){if(typeof e==="boolean"){return e?this.show():this.hide()}return this.each(function(){if(ii(this)){b(this).show()}else{b(this).hide()}})}});b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Wt(e,"opacity");return i===""?"1":i}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":b.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,o){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var s,a,r,l=b.camelCase(i),c=e.style;i=b.cssProps[l]||(b.cssProps[l]=ti(c,l));r=b.cssHooks[i]||b.cssHooks[l];if(n!==t){a=typeof n;if(a==="string"&&(s=Yt.exec(n))){n=(s[1]+1)*s[2]+parseFloat(b.css(e,i));a="number"}if(n==null||a==="number"&&isNaN(n)){return}if(a==="number"&&!b.cssNumber[l]){n+="px"}if(!b.support.clearCloneStyle&&n===""&&i.indexOf("background")===0){c[i]="inherit"}if(!r||!("set"in r)||(n=r.set(e,n,o))!==t){try{c[i]=n}catch(u){}}}else{if(r&&"get"in r&&(s=r.get(e,false,o))!==t){return s}return c[i]}},css:function(e,i,n,o){var s,a,r,l=b.camelCase(i);i=b.cssProps[l]||(b.cssProps[l]=ti(e.style,l));r=b.cssHooks[i]||b.cssHooks[l];if(r&&"get"in r){a=r.get(e,true,n)}if(a===t){a=Wt(e,i,o)}if(a==="normal"&&i in Zt){a=Zt[i]}if(n===""||n){s=parseFloat(a);return n===true||b.isNumeric(s)?s||0:a}return a}});if(e.getComputedStyle){Bt=function(t){return e.getComputedStyle(t,null)};Wt=function(e,i,n){var o,s,a,r=n||Bt(e),l=r?r.getPropertyValue(i)||r[i]:t,c=e.style;if(r){if(l===""&&!b.contains(e.ownerDocument,e)){l=b.style(e,i)}if(Jt.test(l)&&Gt.test(i)){o=c.width;s=c.minWidth;a=c.maxWidth;c.minWidth=c.maxWidth=c.width=l;l=r.width;c.width=o;c.minWidth=s;c.maxWidth=a}}return l}}else if(a.documentElement.currentStyle){Bt=function(e){return e.currentStyle};Wt=function(e,i,n){var o,s,a,r=n||Bt(e),l=r?r[i]:t,c=e.style;if(l==null&&c&&c[i]){l=c[i]}if(Jt.test(l)&&!zt.test(i)){o=c.left;s=e.runtimeStyle;a=s&&s.left;if(a){s.left=e.currentStyle.left}c.left=i==="fontSize"?"1em":l;l=c.pixelLeft+"px";c.left=o;if(a){s.left=a}}return l===""?"auto":l}}function oi(e,t,i){var n=Ut.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function si(e,t,i,n,o){var s=i===(n?"border":"content")?4:t==="width"?1:0,a=0;for(;s<4;s+=2){if(i==="margin"){a+=b.css(e,i+Kt[s],true,o)}if(n){if(i==="content"){a-=b.css(e,"padding"+Kt[s],true,o)}if(i!=="margin"){a-=b.css(e,"border"+Kt[s]+"Width",true,o)}}else{a+=b.css(e,"padding"+Kt[s],true,o);if(i!=="padding"){a+=b.css(e,"border"+Kt[s]+"Width",true,o)}}}return a}function ai(e,t,i){var n=true,o=t==="width"?e.offsetWidth:e.offsetHeight,s=Bt(e),a=b.support.boxSizing&&b.css(e,"boxSizing",false,s)==="border-box";if(o<=0||o==null){o=Wt(e,t,s);if(o<0||o==null){o=e.style[t]}if(Jt.test(o)){return o}n=a&&(b.support.boxSizingReliable||o===e.style[t]);o=parseFloat(o)||0}return o+si(e,t,i||(a?"border":"content"),n,s)+"px"}function ri(e){var t=a,i=Xt[e];if(!i){i=li(e,t);if(i==="none"||!i){Rt=(Rt||b("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement);t=(Rt[0].contentWindow||Rt[0].contentDocument).document;t.write("<!doctype html><html><body>");t.close();i=li(e,t);Rt.detach()}Xt[e]=i}return i}function li(e,t){var i=b(t.createElement(e)).appendTo(t.body),n=b.css(i[0],"display");i.remove();return n}b.each(["height","width"],function(e,t){b.cssHooks[t]={get:function(e,i,n){if(i){return e.offsetWidth===0&&qt.test(b.css(e,"display"))?b.swap(e,Qt,function(){return ai(e,t,n)}):ai(e,t,n)}},set:function(e,i,n){var o=n&&Bt(e);return oi(e,i,n?si(e,t,n,b.support.boxSizing&&b.css(e,"boxSizing",false,o)==="border-box",o):0)}}});if(!b.support.opacity){b.cssHooks.opacity={get:function(e,t){return Vt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,o=b.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=n&&n.filter||i.filter||"";i.zoom=1;if((t>=1||t==="")&&b.trim(s.replace($t,""))===""&&i.removeAttribute){i.removeAttribute("filter");if(t===""||n&&!n.filter){return}}i.filter=$t.test(s)?s.replace($t,o):s+" "+o}}}b(function(){if(!b.support.reliableMarginRight){b.cssHooks.marginRight={get:function(e,t){if(t){return b.swap(e,{display:"inline-block"},Wt,[e,"marginRight"])}}}}if(!b.support.pixelPosition&&b.fn.position){b.each(["top","left"],function(e,t){b.cssHooks[t]={get:function(e,i){if(i){i=Wt(e,t);return Jt.test(i)?b(e).position()[t]+"px":i}}}})}});if(b.expr&&b.expr.filters){b.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!b.support.reliableHiddenOffsets&&(e.style&&e.style.display||b.css(e,"display"))==="none"};b.expr.filters.visible=function(e){return!b.expr.filters.hidden(e)}}b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(i){var n=0,o={},s=typeof i==="string"?i.split(" "):[i];for(;n<4;n++){o[e+Kt[n]+t]=s[n]||s[n-2]||s[0]}return o}};if(!Gt.test(e)){b.cssHooks[e+t].set=oi}});var ci=/%20/g,ui=/\[\]$/,di=/\r?\n/g,fi=/^(?:submit|button|image|reset|file)$/i,hi=/^(?:input|select|textarea|keygen)/i;b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&hi.test(this.nodeName)&&!fi.test(e)&&(this.checked||!jt.test(e))}).map(function(e,t){var i=b(this).val();return i==null?null:b.isArray(i)?b.map(i,function(e){return{name:t.name,value:e.replace(di,"\r\n")}}):{name:t.name,value:i.replace(di,"\r\n")}}).get()}});b.param=function(e,i){var n,o=[],s=function(e,t){t=b.isFunction(t)?t():t==null?"":t;o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t){i=b.ajaxSettings&&b.ajaxSettings.traditional}if(b.isArray(e)||e.jquery&&!b.isPlainObject(e)){b.each(e,function(){s(this.name,this.value)})}else{for(n in e){pi(n,e[n],i,s)}}return o.join("&").replace(ci,"+")};function pi(e,t,i,n){var o;if(b.isArray(t)){b.each(t,function(t,o){if(i||ui.test(e)){n(e,o)}else{pi(e+"["+(typeof o==="object"?t:"")+"]",o,i,n)}})}else if(!i&&b.type(t)==="object"){for(o in t){pi(e+"["+o+"]",t[o],i,n)}}else{n(e,t)}}b.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(e,t){b.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}});b.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",i)}});var gi,mi,vi=b.now(),_i=/\?/,wi=/#.*$/,bi=/([?&])_=[^&]*/,yi=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,xi=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ji=/^(?:GET|HEAD)$/,Ci=/^\/\//,Ei=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ki=b.fn.load,Ti={},Si={},Ii="*/".concat("*");try{mi=s.href}catch(Mi){mi=a.createElement("a");mi.href="";mi=mi.href}gi=Ei.exec(mi.toLowerCase())||[];function Ni(e){return function(t,i){if(typeof t!=="string"){i=t;t="*"}var n,o=0,s=t.toLowerCase().match(x)||[];if(b.isFunction(i)){while(n=s[o++]){if(n[0]==="+"){n=n.slice(1)||"*";(e[n]=e[n]||[]).unshift(i)}else{(e[n]=e[n]||[]).push(i)}}}}}function Ai(e,t,i,n){var o={},s=e===Si;function a(r){var l;o[r]=true;b.each(e[r]||[],function(e,r){var c=r(t,i,n);if(typeof c==="string"&&!s&&!o[c]){t.dataTypes.unshift(c);a(c);return false}else if(s){return!(l=c)}});return l}return a(t.dataTypes[0])||!o["*"]&&a("*")}function Oi(e,i){var n,o,s=b.ajaxSettings.flatOptions||{};for(o in i){if(i[o]!==t){(s[o]?e:n||(n={}))[o]=i[o]}}if(n){b.extend(true,e,n)}return e}b.fn.load=function(e,i,n){if(typeof e!=="string"&&ki){return ki.apply(this,arguments)}var o,s,a,r=this,l=e.indexOf(" ");if(l>=0){o=e.slice(l,e.length);e=e.slice(0,l)}if(b.isFunction(i)){n=i;i=t}else if(i&&typeof i==="object"){a="POST"}if(r.length>0){b.ajax({url:e,type:a,dataType:"html",data:i}).done(function(e){s=arguments;r.html(o?b("<div>").append(b.parseHTML(e)).find(o):e)}).complete(n&&function(e,t){r.each(n,s||[e.responseText,t,e])})}return this};b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}});b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mi,type:"GET",isLocal:xi.test(gi[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ii,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":b.parseJSON,"text xml":b.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(e,t){return t?Oi(Oi(e,b.ajaxSettings),t):Oi(b.ajaxSettings,e)},ajaxPrefilter:Ni(Ti),ajaxTransport:Ni(Si),ajax:function(e,i){if(typeof e==="object"){i=e;e=t}i=i||{};var n,o,s,a,r,l,c,u,d=b.ajaxSetup({},i),f=d.context||d,h=d.context&&(f.nodeType||f.jquery)?b(f):b.event,p=b.Deferred(),g=b.Callbacks("once memory"),m=d.statusCode||{},v={},_={},w=0,y="canceled",j={readyState:0,getResponseHeader:function(e){var t;if(w===2){if(!u){u={};while(t=yi.exec(a)){u[t[1].toLowerCase()]=t[2]}}t=u[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return w===2?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();if(!w){e=_[i]=_[i]||e;v[e]=t}return this},overrideMimeType:function(e){if(!w){d.mimeType=e}return this},statusCode:function(e){var t;if(e){if(w<2){for(t in e){m[t]=[m[t],e[t]]}}else{j.always(e[j.status])}}return this},abort:function(e){var t=e||y;if(c){c.abort(t)}E(0,t);return this}};p.promise(j).complete=g.add;j.success=j.done;j.error=j.fail;d.url=((e||d.url||mi)+"").replace(wi,"").replace(Ci,gi[1]+"//");d.type=i.method||i.type||d.method||d.type;d.dataTypes=b.trim(d.dataType||"*").toLowerCase().match(x)||[""];if(d.crossDomain==null){n=Ei.exec(d.url.toLowerCase());d.crossDomain=!!(n&&(n[1]!==gi[1]||n[2]!==gi[2]||(n[3]||(n[1]==="http:"?"80":"443"))!==(gi[3]||(gi[1]==="http:"?"80":"443"))))}if(d.data&&d.processData&&typeof d.data!=="string"){d.data=b.param(d.data,d.traditional)}Ai(Ti,d,i,j);if(w===2){return j}l=d.global;if(l&&b.active++===0){b.event.trigger("ajaxStart")}d.type=d.type.toUpperCase();d.hasContent=!ji.test(d.type);s=d.url;if(!d.hasContent){if(d.data){s=d.url+=(_i.test(s)?"&":"?")+d.data;delete d.data}if(d.cache===false){d.url=bi.test(s)?s.replace(bi,"$1_="+vi++):s+(_i.test(s)?"&":"?")+"_="+vi++}}if(d.ifModified){if(b.lastModified[s]){j.setRequestHeader("If-Modified-Since",b.lastModified[s])}if(b.etag[s]){j.setRequestHeader("If-None-Match",b.etag[s])}}if(d.data&&d.hasContent&&d.contentType!==false||i.contentType){j.setRequestHeader("Content-Type",d.contentType)}j.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+Ii+"; q=0.01":""):d.accepts["*"]);for(o in d.headers){j.setRequestHeader(o,d.headers[o])}if(d.beforeSend&&(d.beforeSend.call(f,j,d)===false||w===2)){return j.abort()}y="abort";for(o in{success:1,error:1,complete:1}){j[o](d[o])}c=Ai(Si,d,i,j);if(!c){E(-1,"No Transport")}else{j.readyState=1;if(l){h.trigger("ajaxSend",[j,d])}if(d.async&&d.timeout>0){r=setTimeout(function(){j.abort("timeout")},d.timeout)}try{w=1;c.send(v,E)}catch(C){if(w<2){E(-1,C)}else{throw C}}}function E(e,i,n,o){var u,v,_,y,x,C=i;if(w===2){return}w=2;if(r){clearTimeout(r)}c=t;a=o||"";j.readyState=e>0?4:0;u=e>=200&&e<300||e===304;if(n){y=Di(d,j,n)}y=Li(d,y,j,u);if(u){if(d.ifModified){x=j.getResponseHeader("Last-Modified");if(x){b.lastModified[s]=x}x=j.getResponseHeader("etag");if(x){b.etag[s]=x}}if(e===204||d.type==="HEAD"){C="nocontent"}else if(e===304){C="notmodified"}else{C=y.state;v=y.data;_=y.error;u=!_}}else{_=C;if(e||!C){C="error";if(e<0){e=0}}}j.status=e;j.statusText=(i||C)+"";if(u){p.resolveWith(f,[v,C,j])}else{p.rejectWith(f,[j,C,_])}j.statusCode(m);m=t;if(l){h.trigger(u?"ajaxSuccess":"ajaxError",[j,d,u?v:_])}g.fireWith(f,[j,C]);if(l){h.trigger("ajaxComplete",[j,d]);if(!--b.active){b.event.trigger("ajaxStop")}}}return j},getJSON:function(e,t,i){return b.get(e,t,i,"json")},getScript:function(e,i){return b.get(e,t,i,"script")}});b.each(["get","post"],function(e,i){b[i]=function(e,n,o,s){if(b.isFunction(n)){s=s||o;o=n;n=t}return b.ajax({url:e,type:i,dataType:s,data:n,success:o})}});function Di(e,i,n){var o,s,a,r,l=e.contents,c=e.dataTypes;while(c[0]==="*"){c.shift();if(s===t){s=e.mimeType||i.getResponseHeader("Content-Type")}}if(s){for(r in l){if(l[r]&&l[r].test(s)){c.unshift(r);break}}}if(c[0]in n){a=c[0]}else{for(r in n){if(!c[0]||e.converters[r+" "+c[0]]){a=r;break}if(!o){o=r}}a=a||o}if(a){if(a!==c[0]){c.unshift(a)}return n[a]}}function Li(e,t,i,n){var o,s,a,r,l,c={},u=e.dataTypes.slice();if(u[1]){for(a in e.converters){c[a.toLowerCase()]=e.converters[a]}}s=u.shift();while(s){if(e.responseFields[s]){i[e.responseFields[s]]=t}if(!l&&n&&e.dataFilter){t=e.dataFilter(t,e.dataType)}l=s;s=u.shift();if(s){if(s==="*"){s=l}else if(l!=="*"&&l!==s){a=c[l+" "+s]||c["* "+s];if(!a){for(o in c){r=o.split(" ");if(r[1]===s){a=c[l+" "+r[0]]||c["* "+r[0]];if(a){if(a===true){a=c[o]}else if(c[o]!==true){s=r[0];u.unshift(r[1])}break}}}}if(a!==true){if(a&&e["throws"]){t=a(t)}else{try{t=a(t)}catch(d){return{state:"parsererror",error:a?d:"No conversion from "+l+" to "+s}}}}}}}return{state:"success",data:t}}b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){b.globalEval(e);return e}}});b.ajaxPrefilter("script",function(e){if(e.cache===t){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});b.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=a.head||b("head")[0]||a.documentElement;return{send:function(t,o){i=a.createElement("script");i.async=true;if(e.scriptCharset){i.charset=e.scriptCharset}i.src=e.url;i.onload=i.onreadystatechange=function(e,t){if(t||!i.readyState||/loaded|complete/.test(i.readyState)){i.onload=i.onreadystatechange=null;if(i.parentNode){i.parentNode.removeChild(i)}i=null;if(!t){o(200,"success")}}};n.insertBefore(i,n.firstChild)},abort:function(){if(i){i.onload(t,true)}}}}});var Hi=[],Pi=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Hi.pop()||b.expando+"_"+vi++;this[e]=true;return e}});b.ajaxPrefilter("json jsonp",function(i,n,o){var s,a,r,l=i.jsonp!==false&&(Pi.test(i.url)?"url":typeof i.data==="string"&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pi.test(i.data)&&"data");if(l||i.dataTypes[0]==="jsonp"){s=i.jsonpCallback=b.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback;if(l){i[l]=i[l].replace(Pi,"$1"+s)}else if(i.jsonp!==false){i.url+=(_i.test(i.url)?"&":"?")+i.jsonp+"="+s}i.converters["script json"]=function(){if(!r){b.error(s+" was not called")}return r[0]};i.dataTypes[0]="json";a=e[s];e[s]=function(){r=arguments};o.always(function(){e[s]=a;if(i[s]){i.jsonpCallback=n.jsonpCallback;Hi.push(s)}if(r&&b.isFunction(a)){a(r[0])}r=a=t});return"script"}});var Fi,Ri,Bi=0,Wi=e.ActiveXObject&&function(){var e;for(e in Fi){Fi[e](t,true)}};function $i(){try{return new e.XMLHttpRequest}catch(t){}}function Vi(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}b.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&$i()||Vi()}:$i;Ri=b.ajaxSettings.xhr();b.support.cors=!!Ri&&"withCredentials"in Ri;Ri=b.support.ajax=!!Ri;if(Ri){b.ajaxTransport(function(i){if(!i.crossDomain||b.support.cors){var n;return{send:function(o,s){var a,r,l=i.xhr();if(i.username){l.open(i.type,i.url,i.async,i.username,i.password)}else{l.open(i.type,i.url,i.async)}if(i.xhrFields){for(r in i.xhrFields){l[r]=i.xhrFields[r]}}if(i.mimeType&&l.overrideMimeType){l.overrideMimeType(i.mimeType)}if(!i.crossDomain&&!o["X-Requested-With"]){o["X-Requested-With"]="XMLHttpRequest"}try{for(r in o){l.setRequestHeader(r,o[r])}}catch(c){}l.send(i.hasContent&&i.data||null);n=function(e,o){var r,c,u,d;try{if(n&&(o||l.readyState===4)){n=t;if(a){l.onreadystatechange=b.noop;if(Wi){delete Fi[a]}}if(o){if(l.readyState!==4){l.abort()}}else{d={};r=l.status;c=l.getAllResponseHeaders();if(typeof l.responseText==="string"){d.text=l.responseText}try{u=l.statusText}catch(f){u=""}if(!r&&i.isLocal&&!i.crossDomain){r=d.text?200:404}else if(r===1223){r=204}}}}catch(h){if(!o){s(-1,h)}}if(d){s(r,u,d,c)}};if(!i.async){n()}else if(l.readyState===4){setTimeout(n)}else{a=++Bi;if(Wi){if(!Fi){Fi={};b(e).unload(Wi)}Fi[a]=n}l.onreadystatechange=n}},abort:function(){if(n){n(t,true)}}}}})}var zi,qi,Gi=/^(?:toggle|show|hide)$/,Ui=new RegExp("^(?:([+-])=|)("+y+")([a-z%]*)$","i"),Ji=/queueHooks$/,Yi=[tn],Xi={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),o=Ui.exec(t),s=o&&o[3]||(b.cssNumber[e]?"":"px"),a=(b.cssNumber[e]||s!=="px"&&+n)&&Ui.exec(b.css(i.elem,e)),r=1,l=20;if(a&&a[3]!==s){s=s||a[3];o=o||[];a=+n||1;do{r=r||".5";a=a/r;b.style(i.elem,e,a+s)}while(r!==(r=i.cur()/n)&&r!==1&&--l)}if(o){a=i.start=+a||+n||0;i.unit=s;i.end=o[1]?a+(o[1]+1)*o[2]:+o[2]}return i}]};function Qi(){setTimeout(function(){zi=t});return zi=b.now()}function Zi(e,t,i){var n,o=(Xi[t]||[]).concat(Xi["*"]),s=0,a=o.length;for(;s<a;s++){if(n=o[s].call(i,t,e)){return n}}}function Ki(e,t,i){var n,o,s=0,a=Yi.length,r=b.Deferred().always(function(){delete l.elem}),l=function(){if(o){return false}var t=zi||Qi(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,s=1-n,a=0,l=c.tweens.length;for(;a<l;a++){c.tweens[a].run(s)}r.notifyWith(e,[c,s,i]);if(s<1&&l){return i}else{r.resolveWith(e,[c]);return false}},c=r.promise({elem:e,props:b.extend({},t),opts:b.extend(true,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:zi||Qi(),duration:i.duration,tweens:[],createTween:function(t,i){var n=b.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);c.tweens.push(n);return n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(o){return this}o=true;for(;i<n;i++){c.tweens[i].run(1)}if(t){r.resolveWith(e,[c,t])}else{r.rejectWith(e,[c,t])}return this}}),u=c.props;en(u,c.opts.specialEasing);for(;s<a;s++){n=Yi[s].call(c,e,u,c.opts);if(n){return n}}b.map(u,Zi,c);if(b.isFunction(c.opts.start)){c.opts.start.call(e,c)}b.fx.timer(b.extend(l,{elem:e,anim:c,queue:c.opts.queue}));return c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function en(e,t){var i,n,o,s,a;for(i in e){n=b.camelCase(i);o=t[n];s=e[i];if(b.isArray(s)){o=s[1];s=e[i]=s[0]}if(i!==n){e[n]=s;delete e[i]}a=b.cssHooks[n];if(a&&"expand"in a){s=a.expand(s);delete e[n];for(i in s){if(!(i in e)){e[i]=s[i];t[i]=o}}}else{t[n]=o}}}b.Animation=b.extend(Ki,{tweener:function(e,t){if(b.isFunction(e)){t=e;e=["*"]}else{e=e.split(" ")}var i,n=0,o=e.length;for(;n<o;n++){i=e[n];Xi[i]=Xi[i]||[];Xi[i].unshift(t)}},prefilter:function(e,t){if(t){Yi.unshift(e)}else{Yi.push(e)}}});function tn(e,t,i){var n,o,s,a,r,l,c=this,u={},d=e.style,f=e.nodeType&&ii(e),h=b._data(e,"fxshow");if(!i.queue){r=b._queueHooks(e,"fx");if(r.unqueued==null){r.unqueued=0;l=r.empty.fire;r.empty.fire=function(){if(!r.unqueued){l()}}}r.unqueued++;c.always(function(){c.always(function(){r.unqueued--;if(!b.queue(e,"fx").length){r.empty.fire()}})})}if(e.nodeType===1&&("height"in t||"width"in t)){i.overflow=[d.overflow,d.overflowX,d.overflowY];if(b.css(e,"display")==="inline"&&b.css(e,"float")==="none"){if(!b.support.inlineBlockNeedsLayout||ri(e.nodeName)==="inline"){d.display="inline-block"}else{d.zoom=1}}}if(i.overflow){d.overflow="hidden";if(!b.support.shrinkWrapBlocks){c.always(function(){d.overflow=i.overflow[0];d.overflowX=i.overflow[1];d.overflowY=i.overflow[2]})}}for(n in t){o=t[n];if(Gi.exec(o)){delete t[n];s=s||o==="toggle";if(o===(f?"hide":"show")){continue}u[n]=h&&h[n]||b.style(e,n)}}if(!b.isEmptyObject(u)){if(h){if("hidden"in h){f=h.hidden}}else{h=b._data(e,"fxshow",{})}if(s){h.hidden=!f}if(f){b(e).show()}else{c.done(function(){b(e).hide()})}c.done(function(){var t;b._removeData(e,"fxshow");for(t in u){b.style(e,t,u[t])}});for(n in u){a=Zi(f?h[n]:0,n,c);if(!(n in h)){h[n]=a.start;if(f){a.end=a.start;a.start=n==="width"||n==="height"?1:0}}}}}function nn(e,t,i,n,o){return new nn.prototype.init(e,t,i,n,o)}b.Tween=nn;nn.prototype={constructor:nn,init:function(e,t,i,n,o,s){this.elem=e;this.prop=i;this.easing=o||"swing";this.options=t;this.start=this.now=this.cur();this.end=n;this.unit=s||(b.cssNumber[i]?"":"px")},cur:function(){var e=nn.propHooks[this.prop];return e&&e.get?e.get(this):nn.propHooks._default.get(this)},run:function(e){var t,i=nn.propHooks[this.prop];if(this.options.duration){this.pos=t=b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration)}else{this.pos=t=e}this.now=(this.end-this.start)*t+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(i&&i.set){i.set(this)}else{nn.propHooks._default.set(this)}return this}};nn.prototype.init.prototype=nn.prototype;nn.propHooks={_default:{get:function(e){var t;if(e.elem[e.prop]!=null&&(!e.elem.style||e.elem.style[e.prop]==null)){return e.elem[e.prop]}t=b.css(e.elem,e.prop,"");return!t||t==="auto"?0:t},set:function(e){if(b.fx.step[e.prop]){b.fx.step[e.prop](e)}else if(e.elem.style&&(e.elem.style[b.cssProps[e.prop]]!=null||b.cssHooks[e.prop])){b.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}};nn.propHooks.scrollTop=nn.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};b.each(["toggle","show","hide"],function(e,t){var i=b.fn[t];b.fn[t]=function(e,n,o){return e==null||typeof e==="boolean"?i.apply(this,arguments):this.animate(on(t,true),e,n,o)}});b.fn.extend({fadeTo:function(e,t,i,n){return this.filter(ii).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=b.isEmptyObject(e),s=b.speed(t,i,n),a=function(){var t=Ki(this,b.extend({},e),s);if(o||b._data(this,"finish")){t.stop(true)}};a.finish=a;return o||s.queue===false?this.each(a):this.queue(s.queue,a)},stop:function(e,i,n){var o=function(e){var t=e.stop;delete e.stop;t(n)};if(typeof e!=="string"){n=i;i=e;e=t}if(i&&e!==false){this.queue(e||"fx",[])}return this.each(function(){var t=true,i=e!=null&&e+"queueHooks",s=b.timers,a=b._data(this);if(i){if(a[i]&&a[i].stop){o(a[i])}}else{for(i in a){if(a[i]&&a[i].stop&&Ji.test(i)){o(a[i])}}}for(i=s.length;i--;){if(s[i].elem===this&&(e==null||s[i].queue===e)){s[i].anim.stop(n);t=false;s.splice(i,1)}}if(t||!n){b.dequeue(this,e)}})},finish:function(e){if(e!==false){e=e||"fx"}return this.each(function(){var t,i=b._data(this),n=i[e+"queue"],o=i[e+"queueHooks"],s=b.timers,a=n?n.length:0;i.finish=true;b.queue(this,e,[]);if(o&&o.stop){o.stop.call(this,true)}for(t=s.length;t--;){if(s[t].elem===this&&s[t].queue===e){s[t].anim.stop(true);s.splice(t,1)}}for(t=0;t<a;t++){if(n[t]&&n[t].finish){n[t].finish.call(this)}}delete i.finish})}});function on(e,t){var i,n={height:e},o=0;t=t?1:0;for(;o<4;o+=2-t){i=Kt[o];n["margin"+i]=n["padding"+i]=e}if(t){n.opacity=n.width=e}return n}b.each({slideDown:on("show"),slideUp:on("hide"),slideToggle:on("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}});b.speed=function(e,t,i){var n=e&&typeof e==="object"?b.extend({},e):{complete:i||!i&&t||b.isFunction(e)&&e,duration:e,easing:i&&t||t&&!b.isFunction(t)&&t};n.duration=b.fx.off?0:typeof n.duration==="number"?n.duration:n.duration in b.fx.speeds?b.fx.speeds[n.duration]:b.fx.speeds._default;if(n.queue==null||n.queue===true){n.queue="fx"}n.old=n.complete;n.complete=function(){if(b.isFunction(n.old)){n.old.call(this)}if(n.queue){b.dequeue(this,n.queue)}};return n};b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}};b.timers=[];b.fx=nn.prototype.init;b.fx.tick=function(){var e,i=b.timers,n=0;zi=b.now();for(;n<i.length;n++){e=i[n];if(!e()&&i[n]===e){i.splice(n--,1)}}if(!i.length){b.fx.stop()}zi=t};b.fx.timer=function(e){if(e()&&b.timers.push(e)){b.fx.start()}};b.fx.interval=13;b.fx.start=function(){if(!qi){qi=setInterval(b.fx.tick,b.fx.interval)}};b.fx.stop=function(){clearInterval(qi);qi=null};b.fx.speeds={slow:600,fast:200,_default:400};b.fx.step={};if(b.expr&&b.expr.filters){b.expr.filters.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length}}b.fn.offset=function(e){if(arguments.length){return e===t?this:this.each(function(t){b.offset.setOffset(this,e,t)})}var i,n,s={top:0,left:0},a=this[0],r=a&&a.ownerDocument;if(!r){return}i=r.documentElement;if(!b.contains(i,a)){return s}if(typeof a.getBoundingClientRect!==o){s=a.getBoundingClientRect()}n=sn(r);return{top:s.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:s.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}};b.offset={setOffset:function(e,t,i){var n=b.css(e,"position");if(n==="static"){e.style.position="relative"}var o=b(e),s=o.offset(),a=b.css(e,"top"),r=b.css(e,"left"),l=(n==="absolute"||n==="fixed")&&b.inArray("auto",[a,r])>-1,c={},u={},d,f;if(l){u=o.position();d=u.top;f=u.left}else{d=parseFloat(a)||0;f=parseFloat(r)||0}if(b.isFunction(t)){t=t.call(e,i,s)}if(t.top!=null){c.top=t.top-s.top+d}if(t.left!=null){c.left=t.left-s.left+f}if("using"in t){t.using.call(e,c)}else{o.css(c)}}};b.fn.extend({position:function(){if(!this[0]){return}var e,t,i={top:0,left:0},n=this[0];if(b.css(n,"position")==="fixed"){t=n.getBoundingClientRect()}else{e=this.offsetParent();t=this.offset();if(!b.nodeName(e[0],"html")){i=e.offset()}i.top+=b.css(e[0],"borderTopWidth",true);i.left+=b.css(e[0],"borderLeftWidth",true)}return{top:t.top-i.top-b.css(n,"marginTop",true),left:t.left-i.left-b.css(n,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||r;while(e&&(!b.nodeName(e,"html")&&b.css(e,"position")==="static")){e=e.offsetParent}return e||r})}});b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);b.fn[e]=function(o){return b.access(this,function(e,o,s){var a=sn(e);if(s===t){return a?i in a?a[i]:a.document.documentElement[o]:e[o]}if(a){a.scrollTo(!n?s:b(a).scrollLeft(),n?s:b(a).scrollTop())}else{e[o]=s}},e,o,arguments.length,null)}});function sn(e){return b.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false}b.each({Height:"height",Width:"width"},function(e,i){b.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,o){b.fn[o]=function(o,s){var a=arguments.length&&(n||typeof o!=="boolean"),r=n||(o===true||s===true?"margin":"border");return b.access(this,function(i,n,o){var s;if(b.isWindow(i)){return i.document.documentElement["client"+e]}if(i.nodeType===9){s=i.documentElement;return Math.max(i.body["scroll"+e],s["scroll"+e],i.body["offset"+e],s["offset"+e],s["client"+e])}return o===t?b.css(i,n,r):b.style(i,n,o,r)},i,a?o:t,a,null)}})});b.fn.size=function(){return this.length};b.fn.andSelf=b.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=b}else{e.jQuery=e.$=b;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return b})}}})(window);jQuery.browser={};(function(){jQuery.browser.msie=false;jQuery.browser.version=0;if(navigator.userAgent.match(/MSIE ([0-9]+)\./)){jQuery.browser.msie=true;jQuery.browser.version=RegExp.$1}})();(function(e){var t="ar"+ +new Date,i=defaults={onResize:e.noop,onBeforeResize:e.noop,onAfterResize:e.noop,animate:{duration:200,complete:e.noop},extraSpace:50,minSize:"original",maxSize:500,delay:100},n=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"],o=["textarea:not(textarea."+t+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=url]"].join(",");function s(t,i){if(t.data("AutoResizer")){t.data("AutoResizer").destroy()}t.data("AutoResizer",this);var n;this.$el=t;this.config=i=e.extend({},defaults,i);this.isTextArea=this.$el.is("textarea");n=this.isTextArea?t.height():t.width();if(i.maxSize==="original"){i.maxSize=n}if(i.minSize==="original"){i.minSize=n}if(this.isTextArea){t.css({resize:"none"})}if(i.animate){i.animate.complete=e.proxy(this.afterResize,this,i.animate.complete)}this.bind();if(!t.is(":hidden")){this.check(true)}}!function(){var i=".autoResize",o;this.unbind=function(){this.$el.unbind(i)};this.bind=function a(){var t=e.proxy(function(){this.check()},this);this.unbind();this.$el.bind("keyup"+i,t).bind("change"+i,t).bind("paste"+i,t)};function s(){if(!o){o=e('<div class="autoresize-clones"/>').appendTo("body").css({position:"absolute",top:-9999,left:-9999,width:0,height:0,padding:0,overflow:"hidden"})}return o}this.getClone=function(){var i,o;if(!this.$clone){i=this.$el;this.$clone=o=e(this.isTextArea?"<textarea/>":"<span/>");e.each(n,function(e,t){o.css(t,i.css(t))});o.addClass(t).attr("tabIndex",-1).css("overflow","hidden");if(this.isTextArea){o.height(0)}else{o.width("auto").css({whiteSpace:"nowrap"})}s().append(o)}return this.$clone};this.afterResize=function(e){var t=this.$el,i=this.config;if(this.isTextArea){if(t.height()===i.maxSize){t.css("overflowY","auto").scrollTop(1e4)}else{t.css("overflowY","hidden")}}i.onAfterResize.call(this.$el);if(e){e.apply(this,arguments)}};this.check=function r(e){var t=this.config,i=this.getClone(),n=this.$el,o=n.val()||"",s=n.width(),a=this.isTextArea?n.height():s,r,l;o=o.length?o:" ";if(o===this.prevValue&&this.prevWidth===s){return}if(this.isTextArea){if(s!==this.prevWidth){i.width(s)}i.val(o).scrollTop(0).scrollTop(1e4);r=i.scrollTop()+t.extraSpace}else{i.text(o);r=i.width()+t.extraSpace}r=Math.min(Math.max(r,t.minSize),t.maxSize);if(a!==r){l={};l[this.isTextArea?"height":"width"]=r}this.prevValue=o;this.prevWidth=s;if(l){t.onBeforeResize.call(n);t.onResize.call(n);if(t.animate&&!e){n.stop(true,true).animate(l,t.animate)}else{n.css(l);this.afterResize()}}};this.destroy=function l(){this.$el.removeData("AutoResizer");this.unbind();if(this.$clone){this.$clone.remove()}delete this.$el;delete this.$clone}}.call(s.prototype);e.fn.autoResize=function a(t){this.filter(o).each(function(){new s(e(this),t)});return this}})(jQuery);(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e}else{e(jQuery)}})(function(e){var t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],n=Array.prototype.slice,o,s;if(e.event.fixHooks){for(var a=t.length;a;){e.event.fixHooks[t[--a]]=e.event.mouseHooks}}var r=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var t=i.length;t;){this.addEventListener(i[--t],l,false)}}else{this.onmousewheel=l}e.data(this,"mousewheel-line-height",r.getLineHeight(this));e.data(this,"mousewheel-page-height",r.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var t=i.length;t;){this.removeEventListener(i[--t],l,false)}}else{this.onmousewheel=null}e.removeData(this,"mousewheel-line-height");e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),n=i["offsetParent"in e.fn?"offsetParent":"parent"]();if(!n.length){n=e("body")}return parseInt(n.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}});function l(t){var i=t||window.event,a=n.call(arguments,1),l=0,d=0,f=0,h=0,p=0,g=0;t=e.event.fix(i);t.type="mousewheel";if("detail"in i){f=i.detail*-1}if("wheelDelta"in i){f=i.wheelDelta}if("wheelDeltaY"in i){f=i.wheelDeltaY}if("wheelDeltaX"in i){d=i.wheelDeltaX*-1}if("axis"in i&&i.axis===i.HORIZONTAL_AXIS){d=f*-1;f=0}l=f===0?d:f;if("deltaY"in i){f=i.deltaY*-1;l=f}if("deltaX"in i){d=i.deltaX;if(f===0){l=d*-1}}if(f===0&&d===0){return}if(i.deltaMode===1){var m=e.data(this,"mousewheel-line-height");l*=m;f*=m;d*=m}else if(i.deltaMode===2){var v=e.data(this,"mousewheel-page-height");l*=v;f*=v;d*=v}h=Math.max(Math.abs(f),Math.abs(d));if(!s||h<s){s=h;if(u(i,h)){s/=40}}if(u(i,h)){l/=40;d/=40;f/=40}l=Math[l>=1?"floor":"ceil"](l/s);d=Math[d>=1?"floor":"ceil"](d/s);f=Math[f>=1?"floor":"ceil"](f/s);if(r.settings.normalizeOffset&&this.getBoundingClientRect){var _=this.getBoundingClientRect();p=t.clientX-_.left;g=t.clientY-_.top}t.deltaX=d;t.deltaY=f;t.deltaFactor=s;t.offsetX=p;t.offsetY=g;t.deltaMode=0;a.unshift(t,l,d,f);if(o){clearTimeout(o)}o=setTimeout(c,200);return(e.event.dispatch||e.event.handle).apply(this,a)}function c(){s=null}function u(e,t){return r.settings.adjustOldDeltas&&e.type==="mousewheel"&&t%120===0}});"use strict";(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{e(jQuery)}})(function(e){var t={wheelSpeed:navigator.platform.toUpperCase().indexOf("WIN")!==-1?15:1,wheelPropagation:false,minScrollbarLength:null,useBothWheelAxes:false,useKeyboard:false,topMargin:0};e.fn.perfectScrollbar=function(i,n){return this.each(function(){var o=e.extend(true,{},t),s=e(this);if(typeof i==="object"){e.extend(true,o,i)}else{n=i}if(n==="update"){if(s.data("perfect-scrollbar-update")){s.data("perfect-scrollbar-update")()}return s}else if(n==="scroll"){if(s.data("perfect-scrollbar-scroll")){s.data("perfect-scrollbar-scroll")()}return s}else if(n==="destroy"){if(s.data("perfect-scrollbar-destroy")){s.data("perfect-scrollbar-destroy")()}return s}if(s.data("perfect-scrollbar")){return s.data("perfect-scrollbar")}s.addClass("ps-container");var a=e("<div class='ps-scrollbar-x-rail'></div>").appendTo(s),r=e("<div class='ps-scrollbar-y-rail'></div>").appendTo(s),l=e("<div class='ps-scrollbar-x'></div>").appendTo(a),c=e("<div class='ps-scrollbar-y'></div>").appendTo(r),u,d,f,h,p,g,m,v,_=parseInt(a.css("bottom"),10),w,b,y=parseInt(r.css("right"),10),x=s.find(".overview"),j=e("#messages-div"),C,E,k,T,S,I=false;var M=function(){var e=parseInt(b*(g-h)/(h-w),10);a.css({bottom:_-e});s.bottomPositionCSS=parseInt(b*(g-h)/(h-w),10);F()};var N=function(){return parseInt(x.css("bottom"))};var A=function(){return parseInt(x.css("top"))};var O=function(){return parseInt(c.css("bottom"))};s.bottomPositionCSS=N();var D=function(){var e=parseInt(v*(p-f)/(f-m),10);s.scrollLeft(e);r.css({right:y-e})};var L=function(e){if(o.minScrollbarLength){e=Math.max(e,o.minScrollbarLength)}return e};var H=function(){C=e("#jivosite-adword");E=e("#input-div");if(S!==0){C.find(".messages-div-blurred").css({bottom:"auto",top:A()});E.find(".messages-div-blurred").css({bottom:"auto",top:A()-j.height()})}else{C.find(".messages-div-blurred").css({bottom:C.height()+N()-j.height(),top:"auto"});E.find(".messages-div-blurred").css({bottom:E.innerHeight()+N(),top:"auto"})}};var P=function(e){S=e;T=(k+S)*-1;if(S!==0){x.css({bottom:"auto",top:T});I=true}else{x.css({bottom:e,top:"auto"});if(typeof updateBlur==="function")updateBlur();I=false}};var F=function(){k=g-h+o.topMargin;if(s.bottomPositionCSS<k){if(s.bottomPositionCSS<=0){P(0);s.bottomPositionCSS=0}else{P(s.bottomPositionCSS*-1)}}else{P(k*-1);s.bottomPositionCSS=k}H()};var R=function(e){a.toggle(u);r.toggle(d);a.css({left:s.scrollLeft(),bottom:_-s.scrollTop(),width:f});r.css({top:s.scrollTop(),right:y-s.scrollLeft(),height:h});l.css({left:v,width:m});c.css({bottom:e?0:b,height:w})};var B=function(e){f=s.width();h=s.height()-o.topMargin;p=x.width();g=x.height()-o.topMargin;if(f<p){u=true;m=L(parseInt(f*f/p,10));v=parseInt(s.scrollLeft()*(f-m)/(p-f),10)}else{u=false;m=0;v=0;s.scrollLeft(0)}if(h<g&&!e){d=true;w=L(parseInt(h*h/g,10));F();b=parseInt(s.bottomPositionCSS*(h-w)/(g-h),10)}else{d=false;w=0;b=0;P(0);H()}if(b>=h-w){b=h-w}if(v>=f-m){v=f-m}R(e)};var W=function(e,t){var i=e+t,n=f-m;if(i<0){v=0}else if(i>n){v=n}else{v=i}a.css({left:s.scrollLeft()});l.css({left:v})};var $=function(e,t){var i=e-t,n=h-w;if(i<0){b=0}else if(i>n){b=n}else{b=i}r.css({top:s.scrollTop()});c.css({bottom:b})};var V=function(){var t,i;l.bind("mousedown.perfect-scrollbar",function(e){i=e.pageX;t=l.position().left;a.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove.perfect-scrollbar",function(e){if(a.hasClass("in-scrolling")){D();W(t,e.pageX-i);e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup.perfect-scrollbar",function(e){if(a.hasClass("in-scrolling")){a.removeClass("in-scrolling")}});t=i=null};var z=function(){var t,i;c.bind("mousedown.perfect-scrollbar",function(e){i=e.pageY;t=O();r.addClass("in-scrolling");e.stopPropagation();e.preventDefault()});e(document).bind("mousemove.perfect-scrollbar",function(e){if(r.hasClass("in-scrolling")){M();$(O(),e.pageY-i);i=e.pageY;e.stopPropagation();e.preventDefault()}});e(document).bind("mouseup.perfect-scrollbar",function(){if(r.hasClass("in-scrolling")){r.removeClass("in-scrolling")}});t=i=null};var q=function(){var e=function(e,t){var i=s.bottomPositionCSS;if(i===0&&t>0&&e===0){return!o.wheelPropagation}else if(i>=g-h&&t<0&&e===0){return!o.wheelPropagation}var n=s.scrollLeft();if(n===0&&e<0&&t===0){return!o.wheelPropagation}else if(n>=p-f&&e>0&&t===0){return!o.wheelPropagation}return true};var t=false;try{var i="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],n;if(window.top&&window.top.addEventListener&&devicejs.safari()){for(n=i.length;n--;){window.top.addEventListener(i[n],function(){})}}}catch(a){}s.bind("mousewheel.perfect-scrollbar",function(i,n,a,r){if(!o.useBothWheelAxes){s.bottomPositionCSS=s.bottomPositionCSS+r*o.wheelSpeed;s.scrollLeft(s.scrollLeft()+a*o.wheelSpeed)}else if(d&&!u){if(r){s.bottomPositionCSS=s.bottomPositionCSS+r*o.wheelSpeed}else{s.bottomPositionCSS=s.bottomPositionCSS-a*o.wheelSpeed}}else if(u&&!d){if(a){s.scrollLeft(s.scrollLeft()+a*o.wheelSpeed)}else{s.scrollLeft(s.scrollLeft()-r*o.wheelSpeed)}}B();t=e(a,r);if(t){i.preventDefault()}});s.bind("MozMousePixelScroll.perfect-scrollbar",function(e){if(t){e.preventDefault()}})};var G=function(){var t=function(e,t){var i=s.bottomPositionCSS;if(i===0&&t>0&&e===0){return false}else if(i>=g-h&&t<0&&e===0){return false}var n=s.scrollLeft();if(n===0&&e<0&&t===0){return false}else if(n>=p-f&&e>0&&t===0){return false}return true};var i=false;s.bind("mouseenter.perfect-scrollbar",function(e){i=true});s.bind("mouseleave.perfect-scrollbar",function(e){i=false});var n=false;e(document).bind("keydown.perfect-scrollbar",function(e){if(!i){return}var a=0,r=0;switch(e.which){case 37:a=-3;break;case 38:r=3;break;case 39:a=3;break;case 40:r=-3;break;default:return}s.bottomPositionCSS=s.bottomPositionCSS+r*o.wheelSpeed;s.scrollLeft(s.scrollLeft()+a*o.wheelSpeed);B();n=t(a,r);if(n){e.preventDefault()}})};var U=function(){var e=function(e){e.stopPropagation()};c.bind("click.perfect-scrollbar",e);r.bind("click.perfect-scrollbar",function(e){var t=parseInt(w/2,10),i=e.pageY-r.offset().top-t,n=h-w,o=i/n;if(o<0){o=0}else if(o>1){o=1}s.bottomPositionCSS=(g-h)*o;B()});l.bind("click.perfect-scrollbar",e);a.bind("click.perfect-scrollbar",function(e){var t=parseInt(m/2,10),i=e.pageX-a.offset().left-t,n=f-m,o=i/n;if(o<0){o=0}else if(o>1){o=1}s.scrollLeft((p-f)*o);B()})};var J=function(){var t=function(e,t){s.bottomPositionCSS=s.bottomPositionCSS+t;s.scrollLeft(s.scrollLeft()-e);B()};var i={},n=0,o={},a=null,r=false,l=false;e(window).bind("touchstart.perfect-scrollbar",function(e){r=true});e(window).bind("touchend.perfect-scrollbar",function(e){r=false});s.bind("touchstart.perfect-scrollbar",function(e){var t=e.originalEvent.targetTouches[0];i.pageX=t.pageX;i.pageY=t.pageY;n=(new Date).getTime();if(a!==null){clearInterval(a)}e.stopPropagation()});s.bind("touchmove.perfect-scrollbar",function(e){if(!r&&e.originalEvent.targetTouches.length===1){var s=e.originalEvent.targetTouches[0];l=true;var a={};a.pageX=s.pageX;a.pageY=s.pageY;var c=a.pageX-i.pageX,u=a.pageY-i.pageY;t(c,u);i=a;var d=(new Date).getTime();o.x=c/(d-n);o.y=u/(d-n);n=d;if(document.documentElement.style.position==="fixed"){e.preventDefault()}}});s.bind("touchend.perfect-scrollbar",function(e){clearInterval(a);if(l){l=false;a=setInterval(function(){if(Math.abs(o.x)<.01&&Math.abs(o.y)<.01){clearInterval(a);return}t(o.x*30,o.y*30);o.x*=.8;o.y*=.8},10)}})};var Y=function(){s.unbind(".perfect-scrollbar");e(window).unbind(".perfect-scrollbar");e(document).unbind(".perfect-scrollbar");s.data("perfect-scrollbar",null);s.data("perfect-scrollbar-update",null);s.data("perfect-scrollbar-scroll",null);s.data("perfect-scrollbar-destroy",null);l.remove();c.remove();a.remove();r.remove();l=c=f=h=p=g=m=v=_=w=b=y=null};var X=function(t){s.addClass("ie").addClass("ie"+t);var i=function(){var t=function(){e(this).addClass("hover")};var i=function(){e(this).removeClass("hover")};s.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);a.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);r.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);l.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i);c.bind("mouseenter.perfect-scrollbar",t).bind("mouseleave.perfect-scrollbar",i)};var n=function(){R=function(){l.css({left:v+s.scrollLeft(),bottom:_,width:m});c.css({bottom:b+s.bottomPositionCSS,right:y,height:w});l.hide().show();c.hide().show()};M=function(){var e=parseInt(b*g/h,10);s.bottomPositionCSS=parseInt(b*g/h,10);l.css({bottom:_});l.hide().show()};D=function(){var e=parseInt(v*p/f,10);s.scrollLeft(e);c.hide().show()}};if(t===6){i();n()}};var Q="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch;var Z=function(){var e=navigator.userAgent.toLowerCase().match(/(msie) ([\w.]+)/);if(e&&e[1]==="msie"){X(parseInt(e[2],10))}B();V();z();U();if(Q){J()}if(s.mousewheel){q()}if(o.useKeyboard){G()}s.data("perfect-scrollbar",s);s.data("perfect-scrollbar-update",B);s.data("perfect-scrollbar-scroll",function(){S=0;b=0;s.bottomPositionCSS=0;B(true)});s.data("perfect-scrollbar-destroy",Y)};Z();return s})}});(function(e){e.fn.typing=function(e){return this.each(function(i,n){t(n,e)})};function t(t,i){var n=e.extend({start:null,stop:null,delay:400},i);var o=e(t),s=false,a;function r(e){if(!s){s=true;if(n.start){n.start(e,o)}}}function l(e,t){if(s){clearTimeout(a);a=setTimeout(function(){s=false;if(n.stop){n.stop(e,o)}},t>=0?t:n.delay)}}o.keypress(r);o.keydown(function(e){if(e.keyCode===8||e.keyCode===46){r(e)}});o.keyup(l);o.blur(function(e){l(e,0)})}})(jQuery);(function(e){e.fn.jivoDragEvent=function(e){return this.each(function(i,n){t(n,e)})};function t(t,i){var n=e.extend({"min-height":300,"min-width":200,opacity:.8,"out-of-border":true,handler:e(),tracker:e(),console:false},i);var o=".jivo-drag",s=e(t),a=n.handler,r=n.tracker,l=e(a.prop("ownerDocument")),c=false,u=0,d=0;function f(e,t){s.trigger({type:e,dx:t.screenX-u,dy:t.screenY-d})}function h(e){c=false;r.hide();f("jivo.drag.stop",e);l.unbind(o)}function p(e){e.preventDefault();if(!c){h(e)}f("jivo.drag.move",e)}function g(e){c=true;u=e.screenX;d=e.screenY;e.preventDefault();l.bind("mouseup"+o,h).bind("mousemove"+o,p);r.show();f("jivo.drag.init",e)}a.mousedown(g);s.bind("jivo.drag.init",function(e){if(n.console)console.log("drag init",e)});s.bind("jivo.drag.move",function(e){if(n.console)console.log("drag move",e)});s.bind("jivo.drag.stop",function(e){if(n.console)console.log("drag stop",e)})}})(jQuery);(function(e,t,i){var n=Object.prototype.toString.call(e.operamini)=="[object OperaMini]";var o="placeholder"in t.createElement("input")&&!n;var s="placeholder"in t.createElement("textarea")&&!n;var a=i.fn;var r=i.valHooks;var l=i.propHooks;var c;var u;if(o&&s){u=a.placeholder=function(){return this};u.input=u.textarea=true}else{u=a.placeholder=function(){var e=this;e.filter((o?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":f,"blur.placeholder":h}).data("placeholder-enabled",true).trigger("blur.placeholder");return e};u.input=o;u.textarea=s;c={get:function(e){var t=i(e);var n=t.data("placeholder-password");if(n){return n[0].value}return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,t){var n=i(e);var o=n.data("placeholder-password");if(o){return o[0].value=t}if(!n.data("placeholder-enabled")){return e.value=t}if(t==""){e.value=t;if(e!=p()){h.call(e)}}else if(n.hasClass("placeholder")){f.call(e,true,t)||(e.value=t)}else{e.value=t}return n}};if(!o){r.input=c;l.value=c}if(!s){r.textarea=c;l.value=c}i(function(){i(t).delegate("form","submit.placeholder",function(){var e=i(".placeholder",this).each(f);setTimeout(function(){e.each(h)},10)})});i(e).bind("beforeunload.placeholder",function(){i(".placeholder").each(function(){this.value=""})})}function d(e){var t={};var n=/^jQuery\d+$/;i.each(e.attributes,function(e,i){if(i.specified&&!n.test(i.name)){t[i.name]=i.value}});return t}function f(e,t){var n=this;var o=i(n);if(n.value==o.attr("placeholder")&&o.hasClass("placeholder")){if(o.data("placeholder-password")){o=o.hide().next().show().attr("id",o.removeAttr("id").data("placeholder-id"));if(e===true){return o[0].value=t}o.focus()}else{n.value="";o.removeClass("placeholder");n==p()&&n.select()}}}function h(){var e;var t=this;var n=i(t);var o=this.id;if(t.value==""){if(t.type=="password"){if(!n.data("placeholder-textinput")){try{e=n.clone().attr({type:"text"})}catch(s){e=i("<input>").attr(i.extend(d(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":n,"placeholder-id":o}).bind("focus.placeholder",f);n.data({"placeholder-textinput":e,"placeholder-id":o}).before(e)}n=n.removeAttr("id").hide().prev().attr("id",o).show()}n.addClass("placeholder");n[0].value=n.attr("placeholder")}else{n.removeClass("placeholder")}}function p(){try{return t.activeElement}catch(e){}}})(this,document,jQuery);(function(){var e=this;var t=e._;var i={};var n=Array.prototype,o=Object.prototype,s=Function.prototype;var a=n.push,r=n.slice,l=n.concat,c=o.toString,u=o.hasOwnProperty;var d=n.forEach,f=n.map,h=n.reduce,p=n.reduceRight,g=n.filter,m=n.every,v=n.some,_=n.indexOf,w=n.lastIndexOf,b=Array.isArray,y=Object.keys,x=false;var j=function(e){if(e instanceof j)return e;if(!(this instanceof j))return new j(e);this._wrapped=e};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=j}exports._=j}else{e._=j}j.VERSION="1.4.4";var C=j.each=j.forEach=function(e,t,n){if(e==null)return;if(d&&e.forEach===d){e.forEach(t,n)}else if(e.length===+e.length){for(var o=0,s=e.length;o<s;o++){if(t.call(n,e[o],o,e)===i)return}}else{for(var a in e){if(j.has(e,a)){if(t.call(n,e[a],a,e)===i)return}}}};j.map=j.collect=function(e,t,i){var n=[];if(e==null)return n;if(f&&e.map===f)return e.map(t,i);C(e,function(e,o,s){n[n.length]=t.call(i,e,o,s)});return n};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(e,t,i,n){var o=arguments.length>2;if(e==null)e=[];if(h&&e.reduce===h){if(n)t=j.bind(t,n);return o?e.reduce(t,i):e.reduce(t)}C(e,function(e,s,a){if(!o){i=e;o=true}else{i=t.call(n,i,e,s,a)}});if(!o)throw new TypeError(E);return i};j.reduceRight=j.foldr=function(e,t,i,n){var o=arguments.length>2;if(e==null)e=[];if(p&&e.reduceRight===p){if(n)t=j.bind(t,n);return o?e.reduceRight(t,i):e.reduceRight(t)}var s=e.length;if(s!==+s){var a=j.keys(e);s=a.length}C(e,function(r,l,c){l=a?a[--s]:--s;if(!o){i=e[l];o=true}else{i=t.call(n,i,e[l],l,c)}});if(!o)throw new TypeError(E);return i};j.find=j.detect=function(e,t,i){var n;k(e,function(e,o,s){if(t.call(i,e,o,s)){n=e;return true}});return n};j.filter=j.select=function(e,t,i){var n=[];if(e==null)return n;if(g&&e.filter===g)return e.filter(t,i);C(e,function(e,o,s){if(t.call(i,e,o,s))n[n.length]=e});return n};j.reject=function(e,t,i){return j.filter(e,function(e,n,o){return!t.call(i,e,n,o)},i)};j.every=j.all=function(e,t,n){t||(t=j.identity);var o=true;if(e==null)return o;if(m&&e.every===m)return e.every(t,n);C(e,function(e,s,a){if(!(o=o&&t.call(n,e,s,a)))return i});return!!o};var k=j.some=j.any=function(e,t,n){t||(t=j.identity);var o=false;if(e==null)return o;if(v&&e.some===v)return e.some(t,n);C(e,function(e,s,a){if(o||(o=t.call(n,e,s,a)))return i});return!!o};j.contains=j.include=function(e,t){if(e==null)return false;if(_&&e.indexOf===_)return e.indexOf(t)!=-1;return k(e,function(e){return e===t})};j.invoke=function(e,t){var i=r.call(arguments,2);var n=j.isFunction(t);return j.map(e,function(e){return(n?t:e[t]).apply(e,i)})};j.pluck=function(e,t){return j.map(e,function(e){return e[t]})};j.where=function(e,t,i){if(j.isEmpty(t))return i?null:[];return j[i?"find":"filter"](e,function(e){for(var i in t){if(t[i]!==e[i])return false}return true})};j.findWhere=function(e,t){return j.where(e,t,true)};j.max=function(e,t,i){if(!t&&j.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.max.apply(Math,e)}if(!t&&j.isEmpty(e))return-Infinity;var n={computed:-Infinity,value:-Infinity};C(e,function(e,o,s){var a=t?t.call(i,e,o,s):e;a>=n.computed&&(n={value:e,computed:a})});return n.value};j.min=function(e,t,i){if(!t&&j.isArray(e)&&e[0]===+e[0]&&e.length<65535){return Math.min.apply(Math,e)}if(!t&&j.isEmpty(e))return Infinity;var n={computed:Infinity,value:Infinity};C(e,function(e,o,s){var a=t?t.call(i,e,o,s):e;a<n.computed&&(n={value:e,computed:a})});return n.value};j.shuffle=function(e){var t;var i=0;var n=[];C(e,function(e){t=j.random(i++);n[i-1]=n[t];n[t]=e});return n};var T=function(e){return j.isFunction(e)?e:function(t){return t[e]}};j.sortBy=function(e,t,i){var n=T(t);return j.pluck(j.map(e,function(e,t,o){return{value:e,index:t,criteria:n.call(i,e,t,o)}}).sort(function(e,t){var i=e.criteria;var n=t.criteria;if(i!==n){if(i>n||i===void 0)return 1;if(i<n||n===void 0)return-1}return e.index<t.index?-1:1}),"value")};var S=function(e,t,i,n){var o={};var s=T(t||j.identity);C(e,function(t,a){var r=s.call(i,t,a,e);n(o,r,t)});return o};j.groupBy=function(e,t,i){return S(e,t,i,function(e,t,i){(j.has(e,t)?e[t]:e[t]=[]).push(i)})};j.countBy=function(e,t,i){return S(e,t,i,function(e,t){if(!j.has(e,t))e[t]=0;e[t]++})};j.sortedIndex=function(e,t,i,n){i=i==null?j.identity:T(i);var o=i.call(n,t);var s=0,a=e.length;while(s<a){var r=s+a>>>1;i.call(n,e[r])<o?s=r+1:a=r}return s};j.toArray=function(e){if(!e)return[];if(j.isArray(e))return r.call(e);if(e.length===+e.length)return j.map(e,j.identity);return j.values(e)};j.size=function(e){if(e==null)return 0;return e.length===+e.length?e.length:j.keys(e).length};j.first=j.head=j.take=function(e,t,i){if(e==null)return void 0;return t!=null&&!i?r.call(e,0,t):e[0]};j.initial=function(e,t,i){return r.call(e,0,e.length-(t==null||i?1:t))};j.last=function(e,t,i){if(e==null)return void 0;if(t!=null&&!i){return r.call(e,Math.max(e.length-t,0))}else{return e[e.length-1]}};j.rest=j.tail=j.drop=function(e,t,i){return r.call(e,t==null||i?1:t)};j.compact=function(e){return j.filter(e,j.identity)};var I=function(e,t,i){C(e,function(e){if(j.isArray(e)){t?a.apply(i,e):I(e,t,i)}else{i.push(e)}});return i};j.flatten=function(e,t){return I(e,t,[])};j.without=function(e){return j.difference(e,r.call(arguments,1))};j.uniq=j.unique=function(e,t,i,n){if(j.isFunction(t)){n=i;i=t;t=false}var o=i?j.map(e,i,n):e;var s=[];var a=[];C(o,function(i,n){if(t?!n||a[a.length-1]!==i:!j.contains(a,i)){a.push(i);s.push(e[n])}});return s};j.union=function(){return j.uniq(l.apply(n,arguments))};j.intersection=function(e){var t=r.call(arguments,1);return j.filter(j.uniq(e),function(e){return j.every(t,function(t){return j.indexOf(t,e)>=0})})};j.difference=function(e){var t=l.apply(n,r.call(arguments,1));return j.filter(e,function(e){return!j.contains(t,e)})};j.zip=function(){var e=r.call(arguments);var t=j.max(j.pluck(e,"length"));var i=new Array(t);for(var n=0;n<t;n++){i[n]=j.pluck(e,""+n)}return i};j.object=function(e,t){if(e==null)return{};var i={};for(var n=0,o=e.length;n<o;n++){if(t){i[e[n]]=t[n]}else{i[e[n][0]]=e[n][1]}}return i};j.indexOf=function(e,t,i){if(e==null)return-1;var n=0,o=e.length;if(i){if(typeof i=="number"){n=i<0?Math.max(0,o+i):i}else{n=j.sortedIndex(e,t);return e[n]===t?n:-1}}if(_&&e.indexOf===_)return e.indexOf(t,i);for(;n<o;n++)if(e[n]===t)return n;return-1};j.lastIndexOf=function(e,t,i){if(e==null)return-1;var n=i!=null;if(w&&e.lastIndexOf===w){return n?e.lastIndexOf(t,i):e.lastIndexOf(t)}var o=n?i:e.length;while(o--)if(e[o]===t)return o;return-1};j.range=function(e,t,i){if(arguments.length<=1){t=e||0;e=0}i=arguments[2]||1;var n=Math.max(Math.ceil((t-e)/i),0);var o=0;var s=new Array(n);while(o<n){s[o++]=e;e+=i}return s};j.bind=function(e,t){if(e.bind===x&&x)return x.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}};j.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}};j.bindAll=function(e){var t=r.call(arguments,1);if(t.length===0)t=j.functions(e);C(t,function(t){e[t]=j.bind(e[t],e)});return e};j.memoize=function(e,t){var i={};t||(t=j.identity);return function(){var n=t.apply(this,arguments);return j.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}};j.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)};j.defer=function(e){return j.delay.apply(j,[e,1].concat(r.call(arguments,1)))};j.throttle=function(e,t){var i,n,o,s;var a=0;var r=function(){a=new Date;o=null;s=e.apply(i,n)};return function(){var l=new Date;var c=t-(l-a);i=this;n=arguments;if(c<=0){clearTimeout(o);o=null;a=l;s=e.apply(i,n)}else if(!o){o=setTimeout(r,c)}return s}};j.debounce=function(e,t,i){var n,o;return function(){var s=this,a=arguments;var r=function(){n=null;if(!i)o=e.apply(s,a)};var l=i&&!n;clearTimeout(n);n=setTimeout(r,t);if(l)o=e.apply(s,a);return o}};j.once=function(e){var t=false,i;return function(){if(t)return i;t=true;i=e.apply(this,arguments);e=null;return i}};j.wrap=function(e,t){return function(){var i=[e];a.apply(i,arguments);return t.apply(this,i)}};j.compose=function(){var e=arguments;return function(){var t=arguments;for(var i=e.length-1;i>=0;i--){t=[e[i].apply(this,t)]}return t[0]}};j.after=function(e,t){if(e<=0)return t();return function(){if(--e<1){return t.apply(this,arguments)}}};j.keys=y||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)if(j.has(e,i))t[t.length]=i;return t};j.values=function(e){var t=[];for(var i in e)if(j.has(e,i))t.push(e[i]);return t};j.pairs=function(e){var t=[];for(var i in e)if(j.has(e,i))t.push([i,e[i]]);return t};j.invert=function(e){var t={};for(var i in e)if(j.has(e,i))t[e[i]]=i;return t};j.functions=j.methods=function(e){var t=[];for(var i in e){if(j.isFunction(e[i]))t.push(i)}return t.sort()};j.extend=function(e){C(r.call(arguments,1),function(t){if(t){for(var i in t){e[i]=t[i]}}});return e};j.pick=function(e){var t={};var i=l.apply(n,r.call(arguments,1));C(i,function(i){if(i in e)t[i]=e[i]});return t};j.omit=function(e){var t={};var i=l.apply(n,r.call(arguments,1));for(var o in e){if(!j.contains(i,o))t[o]=e[o]}return t};j.defaults=function(e){C(r.call(arguments,1),function(t){if(t){for(var i in t){if(e[i]==null)e[i]=t[i]}}});return e};j.clone=function(e){if(!j.isObject(e))return e;return j.isArray(e)?e.slice():j.extend({},e)};j.tap=function(e,t){t(e);return e};var M=function(e,t,i,n){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;if(e instanceof j)e=e._wrapped;if(t instanceof j)t=t._wrapped;var o=c.call(e);if(o!=c.call(t))return false;switch(o){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return false;var s=i.length;while(s--){if(i[s]==e)return n[s]==t}i.push(e);n.push(t);var a=0,r=true;if(o=="[object Array]"){a=e.length;r=a==t.length;if(r){while(a--){if(!(r=M(e[a],t[a],i,n)))break}}}else{var l=e.constructor,u=t.constructor;if(l!==u&&!(j.isFunction(l)&&l instanceof l&&j.isFunction(u)&&u instanceof u)){return false}for(var d in e){if(j.has(e,d)){a++;if(!(r=j.has(t,d)&&M(e[d],t[d],i,n)))break}}if(r){for(d in t){if(j.has(t,d)&&!a--)break}r=!a}}i.pop();n.pop();return r};j.isEqual=function(e,t){return M(e,t,[],[])};j.isEmpty=function(e){if(e==null)return true;if(j.isArray(e)||j.isString(e))return e.length===0;for(var t in e)if(j.has(e,t))return false;return true};j.isElement=function(e){return!!(e&&e.nodeType===1)};j.isArray=b||function(e){return c.call(e)=="[object Array]"};j.isObject=function(e){return e===Object(e)};C(["Arguments","Function","String","Number","Date","RegExp"],function(e){j["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}});if(!j.isArguments(arguments)){j.isArguments=function(e){return!!(e&&j.has(e,"callee"))}}if(typeof/./!=="function"){j.isFunction=function(e){return typeof e==="function"}}j.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))};j.isNaN=function(e){return j.isNumber(e)&&e!=+e};j.isBoolean=function(e){return e===true||e===false||c.call(e)=="[object Boolean]"};j.isNull=function(e){return e===null};j.isUndefined=function(e){return e===void 0};j.has=function(e,t){return u.call(e,t)};j.noConflict=function(){e._=t;return this};j.identity=function(e){return e};j.times=function(e,t,i){var n=Array(e);for(var o=0;o<e;o++)n[o]=t.call(i,o);return n};j.random=function(e,t){if(t==null){t=e;e=0}return e+Math.floor(Math.random()*(t-e+1))};var N={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};N.unescape=j.invert(N.escape);var A={escape:new RegExp("["+j.keys(N.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(N.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(e){j[e]=function(t){if(t==null)return"";return(""+t).replace(A[e],function(t){return N[e][t]})}});j.result=function(e,t){if(e==null)return null;var i=e[t];return j.isFunction(i)?i.call(e):i};j.mixin=function(e){C(j.functions(e),function(t){var i=j[t]=e[t];j.prototype[t]=function(){var e=[this._wrapped];a.apply(e,arguments);return P.call(this,i.apply(j,e))}})};var O=0;j.uniqueId=function(e){var t=++O+"";return e?e+t:t};j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/;var L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var H=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(e,t,i){var n;i=j.defaults({},i,j.templateSettings);var o=new RegExp([(i.escape||D).source,(i.interpolate||D).source,(i.evaluate||D).source].join("|")+"|$","g");var s=0;var a="__p+='";e.replace(o,function(t,i,n,o,r){a+=e.slice(s,r).replace(H,function(e){return"\\"+L[e]});if(i){a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"}if(n){a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"}if(o){a+="';\n"+o+"\n__p+='"}s=r+t.length;return t});a+="';\n";if(!i.variable)a="with(obj||{}){\n"+a+"}\n";a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(r){r.source=a;throw r}if(t)return n(t,j);var l=function(e){return n.call(this,e,j)};l.source="function("+(i.variable||"obj")+"){\n"+a+"}";return l};j.chain=function(e){return j(e).chain()};var P=function(e){return this._chain?j(e).chain():e};j.mixin(j);C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];j.prototype[e]=function(){var i=this._wrapped;t.apply(i,arguments);if((e=="shift"||e=="splice")&&i.length===0)delete i[0];return P.call(this,i)}});C(["concat","join","slice"],function(e){var t=n[e];j.prototype[e]=function(){return P.call(this,t.apply(this._wrapped,arguments))}});j.extend(j.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(){var e=this;var t=e.Backbone;var i=[];var n=i.push;var o=i.slice;var s=i.splice;var a;if(typeof exports!=="undefined"){a=exports}else{a=e.Backbone={}}a.VERSION="1.0.0";var r=e._;if(!r&&typeof require!=="undefined")r=require("underscore");a.$=e.jQuery||e.Zepto||e.ender||e.$;a.noConflict=function(){e.Backbone=t;return this};a.emulateHTTP=false;a.emulateJSON=false;var l=a.Events={on:function(e,t,i){if(!u(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);n.push({callback:t,context:i,ctx:i||this});return this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var n=this;var o=r.once(function(){n.off(e,o);t.apply(this,arguments)});o._callback=t;return this.on(e,o,i)},off:function(e,t,i){var n,o,s,a,l,c,d,f;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i){this._events={};return this}a=e?[e]:r.keys(this._events);for(l=0,c=a.length;l<c;l++){e=a[l];if(s=this._events[e]){this._events[e]=n=[];if(t||i){for(d=0,f=s.length;d<f;d++){o=s[d];if(t&&t!==o.callback&&t!==o.callback._callback||i&&i!==o.context){n.push(o)}}}if(!n.length)delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=o.call(arguments,1);if(!u(this,"trigger",e,t))return this;var i=this._events[e];var n=this._events.all;if(i)d(i,t);if(n)d(n,arguments);return this},stopListening:function(e,t,i){var n=this._listeners;if(!n)return this;var o=!t&&!i;if(typeof t==="object")i=this;if(e)(n={})[e._listenerId]=e;for(var s in n){n[s].off(t,i,this);if(o)delete this._listeners[s]}return this}};var c=/\s+/;var u=function(e,t,i,n){if(!i)return true;if(typeof i==="object"){for(var o in i){e[t].apply(e,[o,i[o]].concat(n))}return false}if(c.test(i)){var s=i.split(c);for(var a=0,r=s.length;a<r;a++){e[t].apply(e,[s[a]].concat(n))}return false}return true};var d=function(e,t){var i,n=-1,o=e.length,s=t[0],a=t[1],r=t[2];switch(t.length){case 0:while(++n<o)(i=e[n]).callback.call(i.ctx);return;case 1:while(++n<o)(i=e[n]).callback.call(i.ctx,s);return;case 2:while(++n<o)(i=e[n]).callback.call(i.ctx,s,a);return;case 3:while(++n<o)(i=e[n]).callback.call(i.ctx,s,a,r);return;default:while(++n<o)(i=e[n]).callback.apply(i.ctx,t)}};var f={listenTo:"on",listenToOnce:"once"};r.each(f,function(e,t){l[t]=function(t,i,n){var o=this._listeners||(this._listeners={});var s=t._listenerId||(t._listenerId=r.uniqueId("l"));o[s]=t;if(typeof i==="object")n=this;t[e](i,n,this);return this}});l.bind=l.on;l.unbind=l.off;r.extend(a,l);var h=a.Model=function(e,t){var i;var n=e||{};t||(t={});this.cid=r.uniqueId("c");this.attributes={};r.extend(this,r.pick(t,p));if(t.parse)n=this.parse(n,t)||{};if(i=r.result(this,"defaults")){n=r.defaults({},n,i)}this.set(n,t);this.changed={};this.initialize.apply(this,arguments)};var p=["url","urlRoot","collection"];r.extend(h.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return r.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,i){var n,o,s,a,l,c,u,d;if(e==null)return this;if(typeof e==="object"){o=e;i=t}else{(o={})[e]=t}i||(i={});if(!this._validate(o,i))return false;s=i.unset;l=i.silent;a=[];c=this._changing;this._changing=true;if(!c){this._previousAttributes=r.clone(this.attributes);this.changed={}}d=this.attributes,u=this._previousAttributes;if(this.idAttribute in o)this.id=o[this.idAttribute];for(n in o){t=o[n];if(!r.isEqual(d[n],t))a.push(n);if(!r.isEqual(u[n],t)){this.changed[n]=t}else{delete this.changed[n]}s?delete d[n]:d[n]=t}if(!l){if(a.length)this._pending=true;for(var f=0,h=a.length;f<h;f++){this.trigger("change:"+a[f],this,d[a[f]],i)}}if(c)return this;if(!l){while(this._pending){this._pending=false;this.trigger("change",this,i)}}this._pending=false;this._changing=false;return this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:true}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,r.extend({},e,{unset:true}))},hasChanged:function(e){if(e==null)return!r.isEmpty(this.changed);return r.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?r.clone(this.changed):false;var t,i=false;var n=this._changing?this._previousAttributes:this.attributes;for(var o in e){if(r.isEqual(n[o],t=e[o]))continue;(i||(i={}))[o]=t}return i},previous:function(e){if(e==null||!this._previousAttributes)return null;return this._previousAttributes[e]},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=e?r.clone(e):{};if(e.parse===void 0)e.parse=true;var t=this;var i=e.success;e.success=function(n){if(!t.set(t.parse(n,e),e))return false;if(i)i(t,n,e);t.trigger("sync",t,n,e)};P(this,e);return this.sync("read",this,e)},save:function(e,t,i){var n,o,s,a=this.attributes;if(e==null||typeof e==="object"){n=e;i=t}else{(n={})[e]=t}if(n&&(!i||!i.wait)&&!this.set(n,i))return false;i=r.extend({validate:true},i);if(!this._validate(n,i))return false;if(n&&i.wait){this.attributes=r.extend({},a,n)}if(i.parse===void 0)i.parse=true;var l=this;var c=i.success;i.success=function(e){l.attributes=a;var t=l.parse(e,i);if(i.wait)t=r.extend(n||{},t);if(r.isObject(t)&&!l.set(t,i)){return false}if(c)c(l,e,i);l.trigger("sync",l,e,i)};P(this,i);o=this.isNew()?"create":i.patch?"patch":"update";if(o==="patch")i.attrs=n;s=this.sync(o,this,i);if(n&&i.wait)this.attributes=a;return s},destroy:function(e){e=e?r.clone(e):{};var t=this;var i=e.success;var n=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(o){if(e.wait||t.isNew())n();if(i)i(t,o,e);if(!t.isNew())t.trigger("sync",t,o,e)};if(this.isNew()){e.success();return false}P(this,e);var o=this.sync("delete",this,e);if(!e.wait)n();return o},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||H();if(this.isNew())return e;return e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},r.extend(e||{},{validate:true}))},_validate:function(e,t){if(!t.validate||!this.validate)return true;e=r.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;if(!i)return true;this.trigger("invalid",this,i,r.extend(t||{},{validationError:i}));return false}});var g=["keys","values","pairs","invert","pick","omit"];r.each(g,function(e){h.prototype[e]=function(){var t=o.call(arguments);t.unshift(this.attributes);return r[e].apply(r,t)}});var m=a.Collection=function(e,t){t||(t={});if(t.url)this.url=t.url;if(t.model)this.model=t.model;if(t.comparator!==void 0)this.comparator=t.comparator;this._reset();this.initialize.apply(this,arguments);if(e)this.reset(e,r.extend({silent:true},t))};var v={add:true,remove:true,merge:true};var _={add:true,merge:false,remove:false};r.extend(m.prototype,l,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return a.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.defaults(t||{},_))},remove:function(e,t){e=r.isArray(e)?e.slice():[e];t||(t={});var i,n,o,s;for(i=0,n=e.length;i<n;i++){s=this.get(e[i]);if(!s)continue;delete this._byId[s.id];delete this._byId[s.cid];o=this.indexOf(s);this.models.splice(o,1);this.length--;if(!t.silent){t.index=o;s.trigger("remove",s,this,t)}this._removeReference(s)}return this},set:function(e,t){t=r.defaults(t||{},v);if(t.parse)e=this.parse(e,t);if(!r.isArray(e))e=e?[e]:[];var i,o,a,l,c,u;var d=t.at;var f=this.comparator&&d==null&&t.sort!==false;var h=r.isString(this.comparator)?this.comparator:null;var p=[],g=[],m={};for(i=0,o=e.length;i<o;i++){if(!(a=this._prepareModel(e[i],t)))continue;if(c=this.get(a)){if(t.remove)m[c.cid]=true;if(t.merge){c.set(a.attributes,t);if(f&&!u&&c.hasChanged(h))u=true}}else if(t.add){p.push(a);a.on("all",this._onModelEvent,this);this._byId[a.cid]=a;if(a.id!=null)this._byId[a.id]=a}}if(t.remove){for(i=0,o=this.length;i<o;++i){if(!m[(a=this.models[i]).cid])g.push(a)}if(g.length)this.remove(g,t)}if(p.length){if(f)u=true;this.length+=p.length;if(d!=null){s.apply(this.models,[d,0].concat(p))}else{n.apply(this.models,p)}}if(u)this.sort({silent:true});if(t.silent)return this;for(i=0,o=p.length;i<o;i++){(a=p[i]).trigger("add",a,this,t)}if(u)this.trigger("sort",this,t);return this},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;i<n;i++){this._removeReference(this.models[i])}t.previousModels=this.models;this._reset();this.add(e,r.extend({silent:true},t));if(!t.silent)this.trigger("reset",this,t);return this},push:function(e,t){e=this._prepareModel(e,t);this.add(e,r.extend({at:this.length},t));return e},pop:function(e){var t=this.at(this.length-1);this.remove(t,e);return t},unshift:function(e,t){e=this._prepareModel(e,t);this.add(e,r.extend({at:0},t));return e},shift:function(e){var t=this.at(0);this.remove(t,e);return t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){if(e==null)return void 0;return this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){if(r.isEmpty(e))return t?void 0:[];return this[t?"find":"filter"](function(t){for(var i in e){if(e[i]!==t.get(i))return false}return true})},findWhere:function(e){return this.where(e,true)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");e||(e={});if(r.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(r.bind(this.comparator,this))}if(!e.silent)this.trigger("sort",this,e);return this},sortedIndex:function(e,t,i){t||(t=this.comparator);var n=r.isFunction(t)?t:function(e){return e.get(t)};return r.sortedIndex(this.models,e,n,i)},pluck:function(e){return r.invoke(this.models,"get",e)},fetch:function(e){e=e?r.clone(e):{};if(e.parse===void 0)e.parse=true;var t=e.success;var i=this;e.success=function(n){var o=e.reset?"reset":"set";i[o](n,e);if(t)t(i,n,e);i.trigger("sync",i,n,e)};P(this,e);return this.sync("read",this,e)},create:function(e,t){t=t?r.clone(t):{};if(!(e=this._prepareModel(e,t)))return false;if(!t.wait)this.add(e,t);var i=this;var n=t.success;t.success=function(o){if(t.wait)i.add(e,t);if(n)n(e,o,t)};e.save(null,t);return e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(e,t){if(e instanceof h){if(!e.collection)e.collection=this;return e}t||(t={});t.collection=this;var i=new this.model(e,t);if(!i._validate(e,t)){this.trigger("invalid",this,e,t);return false}return i},_removeReference:function(e){if(this===e.collection)delete e.collection;e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){if((e==="add"||e==="remove")&&i!==this)return;if(e==="destroy")this.remove(t,n);if(t&&e==="change:"+t.idAttribute){delete this._byId[t.previous(t.idAttribute)];if(t.id!=null)this._byId[t.id]=t}this.trigger.apply(this,arguments)}});var w=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];r.each(w,function(e){m.prototype[e]=function(){var t=o.call(arguments);t.unshift(this.models);return r[e].apply(r,t)}});var b=["groupBy","countBy","sortBy"];r.each(b,function(e){m.prototype[e]=function(t,i){var n=r.isFunction(t)?t:function(e){return e.get(t)};return r[e](this.models,n,i)}});var y=a.View=function(e){this.cid=r.uniqueId("view");this._configure(e||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var x=/^(\S+)\s*(.*)$/;var j=["model","collection","el","id","attributes","className","tagName","events"];r.extend(y.prototype,l,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(e,t){if(this.$el)this.undelegateEvents();this.$el=e instanceof a.$?e:a.$(e);this.el=this.$el[0];if(t!==false)this.delegateEvents();return this},delegateEvents:function(e){if(!(e||(e=r.result(this,"events"))))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(!r.isFunction(i))i=this[e[t]];if(!i)continue;var n=t.match(x);var o=n[1],s=n[2];i=r.bind(i,this);o+=".delegateEvents"+this.cid;if(s===""){this.$el.on(o,i)}else{this.$el.on(o,s,i)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(e){if(this.options)e=r.extend({},r.result(this,"options"),e);r.extend(this,r.pick(e,j));this.options=e},_ensureElement:function(){if(!this.el){var e=r.extend({},r.result(this,"attributes"));if(this.id)e.id=r.result(this,"id");if(this.className)e["class"]=r.result(this,"className");var t=a.$("<"+r.result(this,"tagName")+">").attr(e);this.setElement(t,false)}else{this.setElement(r.result(this,"el"),false)}}});a.sync=function(e,t,i){var n=C[e];r.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var o={type:n,dataType:"json"};if(!i.url){o.url=r.result(t,"url")||H()}if(i.data==null&&t&&(e==="create"||e==="update"||e==="patch")){o.contentType="application/json";o.data=JSON.stringify(i.attrs||t.toJSON(i))}if(i.emulateJSON){o.contentType="application/x-www-form-urlencoded";o.data=o.data?{model:o.data}:{}}if(i.emulateHTTP&&(n==="PUT"||n==="DELETE"||n==="PATCH")){o.type="POST";if(i.emulateJSON)o.data._method=n;var s=i.beforeSend;i.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",n);if(s)return s.apply(this,arguments)}}if(o.type!=="GET"&&!i.emulateJSON){o.processData=false}if(o.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var l=i.xhr=a.ajax(r.extend(o,i));t.trigger("request",t,l,i);return l};var C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var E=a.Router=function(e){e||(e={});if(e.routes)this.routes=e.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var k=/\((.*?)\)/g;var T=/(\(\?)?:\w+/g;var S=/\*\w+/g;var I=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(E.prototype,l,{initialize:function(){},route:function(e,t,i){if(!r.isRegExp(e))e=this._routeToRegExp(e);if(r.isFunction(t)){i=t;t=""}if(!i)i=this[t];var n=this;a.history.route(e,function(o){var s=n._extractParameters(e,o);i&&i.apply(n,s);n.trigger.apply(n,["route:"+t].concat(s));n.trigger("route",t,s);a.history.trigger("route",n,t,s)});return this},navigate:function(e,t){a.history.navigate(e,t);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=r.result(this,"routes");var e,t=r.keys(this.routes);while((e=t.pop())!=null){this.route(e,this.routes[e])}},_routeToRegExp:function(e){e=e.replace(I,"\\$&").replace(k,"(?:$1)?").replace(T,function(e,t){return t?e:"([^/]+)"}).replace(S,"(.*?)");return new RegExp("^"+e+"$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return r.map(i,function(e){return e?decodeURIComponent(e):null})}});var M=a.History=function(){this.handlers=[];r.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var N=/^[#\/]|\s+$/g;var A=/^\/+|\/+$/g;var O=/msie [\w.]+/;var D=/\/$/;M.started=false;r.extend(M.prototype,l,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null){if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(D,"");if(!e.indexOf(i))e=e.substr(i.length)}else{e=this.getHash()}}return e.replace(N,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=true;this.options=r.extend({},{root:"/"},this.options,e);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment();var i=document.documentMode;var n=O.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(A,"/");if(n&&this._wantsHashChange){this.iframe=a.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(t)}if(this._hasPushState){a.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!n){a.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=t;var o=this.location;var s=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&s&&o.hash){this.fragment=this.getHash().replace(N,"");this.history.replaceState({},document.title,this.root+this.fragment+o.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);M.started=false},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe){t=this.getFragment(this.getHash(this.iframe))}if(t===this.fragment)return false;if(this.iframe)this.navigate(t);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e);var i=r.any(this.handlers,function(e){if(e.route.test(t)){e.callback(t);return true}});return i},navigate:function(e,t){if(!M.started)return false;if(!t||t===true)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var i=this.root+e;if(this._hasPushState){this.history[t.replace?"replaceState":"pushState"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,e,t.replace);if(this.iframe&&e!==this.getFragment(this.getHash(this.iframe))){if(!t.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,e,t.replace)}}else{return this.location.assign(i)}if(t.trigger)this.loadUrl(e)},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else{e.hash="#"+t}}});a.history=new M;var L=function(e,t){var i=this;var n;if(e&&r.has(e,"constructor")){n=e.constructor}else{n=function(){return i.apply(this,arguments)}}r.extend(n,i,t);var o=function(){this.constructor=n};o.prototype=i.prototype;n.prototype=new o;if(e)r.extend(n.prototype,e);n.__super__=i.prototype;return n};h.extend=m.extend=E.extend=y.extend=M.extend=L;var H=function(){throw new Error('A "url" property or function must be specified')};var P=function(e,t){var i=t.error;t.error=function(n){if(i)i(e,n,t);e.trigger("error",e,n,t)}}}).call(this);(function(e){e(_,Backbone)})(function(e,t){function i(t){var n={},o=a.keyPathSeparator;for(var s in t){var r=t[s];if(r&&r.constructor===Object&&!e.isEmpty(r)){var l=i(r);for(var c in l){var u=l[c];n[s+o+c]=u}}else{n[s]=r}}return n}function n(t,i,n){var o=a.keyPathSeparator;var s=i.split(o);var r=t;n||n===false;for(var l=0,c=s.length;l<c;l++){if(n&&!e.has(r,s[l])){return false}r=r[s[l]];if(r==null&&l<c-1){r={}}if(typeof r==="undefined"){if(n){return true}return r}}if(n){return true}return r}function o(t,i,n,o){o=o||{};var s=a.keyPathSeparator;var r=i.split(s);var l=t;for(var c=0,u=r.length;c<u&&l!==undefined;c++){var d=r[c];if(c===u-1){o.unset?delete l[d]:l[d]=n}else{if(typeof l[d]==="undefined"||!e.isObject(l[d])){l[d]={}}l=l[d]}}}function s(e,t){o(e,t,null,{unset:true})}var a=t.Model.extend({constructor:function(t,i){var n;var o=t||{};this.cid=e.uniqueId("c");this.attributes={};if(i&&i.collection)this.collection=i.collection;if(i&&i.parse)o=this.parse(o,i)||{};if(n=e.result(this,"defaults")){o=e.deepExtend({},n,o)}this.set(o,i);this.changed={};this.initialize.apply(this,arguments)},toJSON:function(t){return e.deepClone(this.attributes)},get:function(e){return n(this.attributes,e)},set:function(t,r,l){var c,u,d,f,h,p,g,m;if(t==null)return this;if(typeof t==="object"){u=t;l=r||{}}else{(u={})[t]=r}l||(l={});if(!this._validate(u,l))return false;d=l.unset;h=l.silent;f=[];p=this._changing;this._changing=true;if(!p){this._previousAttributes=e.deepClone(this.attributes);this.changed={}}m=this.attributes,g=this._previousAttributes;if(this.idAttribute in u)this.id=u[this.idAttribute];u=i(u);for(c in u){r=u[c];if(!e.isEqual(n(m,c),r))f.push(c);if(!e.isEqual(n(g,c),r)){o(this.changed,c,r)}else{s(this.changed,c)}d?s(m,c):o(m,c,r)}if(!h){if(f.length)this._pending=true;var v=a.keyPathSeparator;var _={};for(var w=0,b=f.length;w<b;w++){var t=f[w];if(!_.hasOwnProperty(t)||!_[t]){_[t]=true;this.trigger("change:"+t,this,n(m,t),l)}var y=t.split(v);for(var x=y.length-1;x>0;x--){var j=e.first(y,x).join(v),C=j+v+"*";if(!_.hasOwnProperty(C)||!_[C]){_[C]=true;this.trigger("change:"+C,this,n(m,j),l)}if(!_.hasOwnProperty(j)||!_[j]){_[j]=true;this.trigger("change:"+j,this,n(m,j),l)}}}}if(p)return this;if(!h){while(this._pending){this._pending=false;this.trigger("change",this,l)}}this._pending=false;this._changing=false;return this},clear:function(t){var n={};var o=i(this.attributes);for(var s in o)n[s]=void 0;return this.set(n,e.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!e.isEmpty(this.changed);return n(this.changed,t)!==undefined},changedAttributes:function(t){if(!t)return this.hasChanged()?i(this.changed):false;var n=this._changing?this._previousAttributes:this.attributes;t=i(t);n=i(n);var o,s=false;for(var a in t){if(e.isEqual(n[a],o=t[a]))continue;(s||(s={}))[a]=o}return s},previous:function(e){if(e==null||!this._previousAttributes)return null;return n(this._previousAttributes,e)},previousAttributes:function(){return e.deepClone(this._previousAttributes)}});a.keyPathSeparator=".";t.DeepModel=a;if(typeof module!="undefined")module.exports=a;return t});var machina=function(e,t){var i=[].slice;var n="transition";var o="handler";var s="handling";var a="handled";var r="nohandler";var l="transition";var c="invalidstate";var u="deferred";var d="newfsm";var f={makeFsmNamespace:function(){var e=0;return function(){return"fsm."+e++}}(),getDefaultOptions:function(){return{initialState:"uninitialized",eventListeners:{"*":[]},states:{},eventQueue:[],namespace:f.makeFsmNamespace(),targetReplayState:"",state:t,priorState:t,_priorAction:"",_currentAction:""}}};if(!e.deepExtend){var h={"*":function(e,t,i){e[t]=i},object:function(e,t,i){e[t]=m({},e[t]||{},i)},array:function(t,i,n){t[i]=[];e.each(n,function(e,n){h[g(e)](t[i],n,e)},this)}},p=function(t){if(e.isArray(t)){return"array"}if(e.isDate(t)){return"date"}if(e.isRegExp(t)){return"regex"}return typeof t},g=function(e){var t=p(e);return h[t]?t:"*"},m=function(t){e.each(i.call(arguments,1),function(i){e.each(i,function(e,i){h[g(e)](t,i,e)})});return t};e.mixin({deepExtend:m})}var v=function(t){e.extend(this,t);e.defaults(this,f.getDefaultOptions());this.initialize.apply(this,arguments);b.emit(d,this);if(this.initialState){this.transition(this.initialState)}};e.extend(v.prototype,{initialize:function(){},emit:function(t){var n=arguments;if(this.eventListeners["*"]){e.each(this.eventListeners["*"],function(e){try{e.apply(this,i.call(n,0))}catch(t){reportException(t);log(t.message)}},this)}if(this.eventListeners[t]){e.each(this.eventListeners[t],function(e){try{e.apply(this,i.call(n,1))}catch(t){reportException(t);log(t.message)}},this)}},handle:function(n){if(!this.inExitHandler){var l=this.states,c=this.state,u=i.call(arguments,0),d,f,h,p;this.currentActionArgs=u;if(l[c][n]||l[c]["*"]||this["*"]){d=l[c][n]?n:"*";h=d==="*";if(l[c][d]){f=l[c][d];p=c+"."+d}else{f=this["*"];p="*"}if(!this._currentAction)this._currentAction=p;this.emit.call(this,s,{inputType:n,args:u.slice(1)});if(e.isFunction(f))f=f.apply(this,h?u:u.slice(1));if(e.isString(f))this.transition(f);this.emit.call(this,a,{inputType:n,args:u.slice(1)});this._priorAction=this._currentAction;this._currentAction="";this.processQueue(o)}else{this.emit.call(this,r,{inputType:n,args:u.slice(1)})}this.currentActionArgs=t}},transition:function(e){if(!this.inExitHandler&&e!==this.state){var t;if(this.states[e]){this.targetReplayState=e;this.priorState=this.state;this.state=e;t=this.priorState;if(this.states[t]&&this.states[t]._onExit){this.inExitHandler=true;this.states[t]._onExit.call(this);this.inExitHandler=false}this.emit.call(this,l,{fromState:t,action:this._currentAction,toState:e});if(this.states[e]._onEnter){try{this.states[e]._onEnter.call(this)}catch(i){reportException(i);log(i.message)}}if(this.targetReplayState===e){this.processQueue(n)}return}this.emit.call(this,c,{state:this.state,attemptedState:e})}},processQueue:function(t){var i=t===n?function(e){return e.type===n&&(!e.untilState||e.untilState===this.state)}:function(e){return e.type===o};var s=e.filter(this.eventQueue,i,this);this.eventQueue=e.difference(this.eventQueue,s);e.each(s,function(e){this.handle.apply(this,e.args)},this)},clearQueue:function(t,i){if(!t){this.eventQueue=[]}else{var s;if(t===n){s=function(e){return e.type===n&&(i?e.untilState===i:true)}}else if(t===o){s=function(e){return e.type===o}}this.eventQueue=e.filter(this.eventQueue,s)}},deferUntilTransition:function(e){if(this.currentActionArgs){var t={type:n,untilState:e,args:this.currentActionArgs};this.eventQueue.push(t);this.emit.call(this,u,{state:this.state,queuedArgs:t})}},deferUntilNextHandler:function(){if(this.currentActionArgs){var e={type:n,args:this.currentActionArgs};this.eventQueue.push(e);this.emit.call(this,u,{state:this.state,queuedArgs:e})}},on:function(e,t){var i=this;if(!i.eventListeners[e]){i.eventListeners[e]=[]}i.eventListeners[e].push(t);return{eventName:e,callback:t,off:function(){i.off(e,t)}}},off:function(t,i){if(!t){this.eventListeners={}}else{if(this.eventListeners[t]){if(i){this.eventListeners[t]=e.without(this.eventListeners[t],i)}else{this.eventListeners[t]=[]}}}}});v.prototype.trigger=v.prototype.emit;var _=function(){};var w=function(t,i,n){var o;if(i&&i.hasOwnProperty("constructor")){o=i.constructor}else{o=function(){t.apply(this,arguments)}}e.deepExtend(o,t);_.prototype=t.prototype;o.prototype=new _;if(i){e.deepExtend(o.prototype,i)}if(n){e.deepExtend(o,n)}o.prototype.constructor=o;o.__super__=t.prototype;return o};v.extend=function(e,t){var i=w(this,e,t);i.extend=this.extend;return i};var b={Fsm:v,utils:f,on:function(e,t){if(!this.eventListeners[e]){this.eventListeners[e]=[]}this.eventListeners[e].push(t);return t},off:function(t,i){if(this.eventListeners[t]){this.eventListeners[t]=e.without(this.eventListeners[t],i)}},trigger:function(t){var n=0,o,s=arguments,a=this.eventListeners[t]||[];if(a&&a.length){e.each(a,function(e){e.apply(null,i.call(s,1))})}},eventListeners:{newFsm:[]}};b.emit=b.trigger;return b}(_);if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,o,s,a=gap,r,l=t[e];if(l&&typeof l==="object"&&typeof l.toJSON==="function"){l=l.toJSON(e)}if(typeof rep==="function"){l=rep.call(t,e,l)}switch(typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l){return"null"}gap+=indent;r=[];if(Object.prototype.toString.apply(l)==="[object Array]"){s=l.length;for(i=0;i<s;i+=1){r[i]=str(i,l)||"null"}o=r.length===0?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+a+"]":"["+r.join(",")+"]";gap=a;return o}if(rep&&typeof rep==="object"){s=rep.length;for(i=0;i<s;i+=1){if(typeof rep[i]==="string"){n=rep[i];o=str(n,l);if(o){r.push(quote(n)+(gap?": ":":")+o)}}}}else{for(n in l){if(Object.prototype.hasOwnProperty.call(l,n)){o=str(n,l);if(o){r.push(quote(n)+(gap?": ":":")+o)}}}}o=r.length===0?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+a+"}":"{"+r.join(",")+"}";gap=a;return o}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,i){var n;gap="";indent="";if(typeof i==="number"){for(n=0;n<i;n+=1){indent+=" "}}else if(typeof i==="string"){indent=i}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(e,t){var i,n,o=e[t];if(o&&typeof o==="object"){for(i in o){if(Object.prototype.hasOwnProperty.call(o,i)){n=walk(o,i);if(n!==undefined){o[i]=n}else{delete o[i]}}}}return reviver.call(e,t,o)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();(function(){var e,t,i,n;t=window.device;e={};window.device=e;n=window.navigator.userAgent.toLowerCase();e.safari=function(){return i("safari")&&!e.chrome()};e.chrome=function(){return i("chrome")};e.ios=function(){return e.iphone()||e.ipod()||e.ipad()};e.iphone=function(){return!e.windows()&&i("iphone")};e.ipod=function(){return i("ipod")};e.ipad=function(){return i("ipad")};e.chromeIOS=function(){return i("crios")};e.android=function(){return!e.windows()&&i("android")};e.androidPhone=function(){return e.android()&&i("mobile")};e.androidTablet=function(){return e.android()&&!i("mobile")};e.blackberry=function(){return i("blackberry")||i("bb10")||i("rim")};e.blackberryPhone=function(){return e.blackberry()&&!i("tablet")};e.blackberryTablet=function(){return e.blackberry()&&i("tablet")};e.windows=function(){return i("windows")};e.windowsPhone=function(){return e.windows()&&i("phone")};e.windowsTablet=function(){return e.windows()&&(i("touch")&&!e.windowsPhone()&&!i("trident"))};e.fxos=function(){return(i("(mobile;")||i("(tablet;"))&&i("; rv:")};e.fxosPhone=function(){return e.fxos()&&i("mobile")};e.fxosTablet=function(){return e.fxos()&&i("tablet")};e.meego=function(){return i("meego")};e.cordova=function(){return window.cordova&&location.protocol==="file:"};e.nodeWebkit=function(){return typeof window.process==="object"};e.mobile=function(){return e.androidPhone()||e.iphone()||e.ipod()||e.windowsPhone()||e.blackberryPhone()||e.fxosPhone()||e.meego()};e.tablet=function(){return e.ipad()||e.androidTablet()||e.blackberryTablet()||e.windowsTablet()||e.fxosTablet()};e.desktop=function(){return!e.tablet()&&!e.mobile()};e.television=function(){var e;var t=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","roku","pov_tv","hbbtv","ce-html"];e=0;while(e<t.length){if(i(t[e])){return true}e++}return false};e.portrait=function(){return window.innerHeight/window.innerWidth>1};e.landscape=function(){return window.innerHeight/window.innerWidth<1};e.noConflict=function(){window.device=t;return this};i=function(e){return n.indexOf(e)!==-1}}).call(this);(function(e){var t=e.setTimeout,i=e.document,n=0;e.jivoXHR=function(){var o,s,a,r=null;function l(){try{a.parentNode.removeChild(a)}catch(e){}}function c(){s=false;o="";l();a=null}function u(e){try{r.onerror.call(r,e,o)}catch(t){throw new Error(e)}}function d(){if(this.readyState&&this.readyState!=="complete"&&this.readyState!=="loaded"||s){return}this.onload=this.onreadystatechange=null;s=true;if(r.readyState!==4){u("Script failed to load ["+o+"].")}l()}function f(e){e=e||[];r.readyState=4;r.status=200;if(typeof r.onload==="function"){r.onload.apply(r,e)}}r={onerror:null,onload:null,readyState:0,open:function(t,i){c();var s="cb"+n++;(function(t){e.jivoXHR[t]=function(){try{f.call(r,arguments)}catch(i){r.readyState=-1;u(i.message)}e.jivoXHR[t]=null}})(s);o=i.replace(/=\?/,"=jivoXHR."+s)},send:function(){t(function(){a=i.createElement("script");a.setAttribute("type","text/javascript");a.charset="UTF-8";a.onload=a.onreadystatechange=function(){d.call(a)};a.setAttribute("src",o);i.getElementsByTagName("head")[0].appendChild(a)},0)},abort:function(){},setRequestHeader:function(){},getResponseHeader:function(){return""},getAllResponseHeaders:function(){return[]}};c();return r}})(window);function log(){if(!("logs"in config)){return}var e=Array.prototype.slice.call(arguments);if(typeof console!="undefined"&&typeof console.log=="function"){if(window.opera){var t=0;while(t<arguments.length){console.log("Item "+(t+1)+": "+arguments[t]);t++}}else if(e.length==1&&typeof e[0]=="string"){console.log(e.toString())}else{console.log(e)}}else if(typeof console!="undefined"&&typeof console.log=="object"){Function.prototype.call.call(console.log,console,e)}}function hexToR(e){return parseInt(cutHex(e).substring(0,2),16)}function hexToG(e){return parseInt(cutHex(e).substring(2,4),16)}function hexToB(e){return parseInt(cutHex(e).substring(4,6),16)}function cutHex(e){return e.charAt(0)=="#"?e.substring(1,7):e}function rgbToHex(e,t,i){return toHex(e)+toHex(t)+toHex(i)}function toHex(e){e=parseInt(e,10);if(isNaN(e))return"00";e=Math.max(0,Math.min(e,255));return"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)}function adjustLightness(e,t,i){var n=hexToR(e);var o=hexToG(e);var s=hexToB(e);log("r="+n+" g="+o+" b="+s);var a=ColorConverter.toHSV(new RGB(n,o,s));if(a.v>0)a.v=a.v*t;else a.v=100*(t-1);a.s=a.s*i;var r=ColorConverter.toRGB(a);var l=rgbToHex(r.r,r.g,r.b);return"#"+l}function getLightness(e){var t=hexToR(e);var i=hexToG(e);var n=hexToB(e);var o=ColorConverter.toHSV(new RGB(t,i,n));log("hsv.v="+o.v);return o.v}function isLightColor(e){return getLightness(e)>65}function HSV(e,t,i){if(e<=0){e=0}if(t<=0){t=0}if(i<=0){i=0}if(e>360){e=360}if(t>100){t=100}if(i>100){i=100}this.h=e;this.s=t;this.v=i}function RGB(e,t,i){if(e<=0){e=0}if(t<=0){t=0}if(i<=0){i=0}if(e>255){e=255}if(t>255){t=255}if(i>255){i=255}this.r=e;this.g=t;this.b=i}function CMYK(e,t,i,n){if(e<=0){e=0}if(t<=0){t=0}if(i<=0){i=0}if(n<=0){n=0}if(e>100){e=100}if(t>100){t=100}if(i>100){i=100}if(n>100){n=100}this.c=e;this.m=t;this.y=i;this.k=n}var ColorConverter={_RGBtoHSV:function(e){var t=new HSV(0,0,0);var i=e.r/255;var n=e.g/255;var o=e.b/255;var s=Math.min(i,n,o);var a=Math.max(i,n,o);var r=a-s;t.v=a;if(r==0){t.h=0;t.s=0}else{t.s=r/a;var l=((a-i)/6+r/2)/r;var c=((a-n)/6+r/2)/r;var u=((a-o)/6+r/2)/r;if(i==a){t.h=u-c}else if(n==a){t.h=1/3+l-u}else if(o==a){t.h=2/3+c-l}if(t.h<0){t.h+=1}if(t.h>1){t.h-=1}}t.h=Math.round(t.h*360);t.s=Math.round(t.s*100);t.v=Math.round(t.v*100);return t},_HSVtoRGB:function(e){var t=new RGB(0,0,0);var i=e.h/360;var n=e.s/100;var o=e.v/100;if(n==0){t.r=o*255;t.g=o*255;t.b=o*255}else{var s=i*6;var a=Math.floor(s);var r=o*(1-n);var l=o*(1-n*(s-a));var c=o*(1-n*(1-(s-a)));var u,d,f;if(a==0){u=o;d=c;f=r}else if(a==1){u=l;d=o;f=r}else if(a==2){u=r;d=o;f=c}else if(a==3){u=r;d=l;f=o}else if(a==4){u=c;d=r;f=o}else{u=o;d=r;f=l}t.r=u*255;t.g=d*255;t.b=f*255;t.r=Math.round(t.r);t.g=Math.round(t.g);t.b=Math.round(t.b)}return t},_CMYKtoRGB:function(e){var t=new RGB(0,0,0);var i=e.c/100;var n=e.m/100;var o=e.y/100;var s=e.k/100;t.r=1-Math.min(1,i*(1-s)+s);t.g=1-Math.min(1,n*(1-s)+s);t.b=1-Math.min(1,o*(1-s)+s);t.r=Math.round(t.r*255);t.g=Math.round(t.g*255);t.b=Math.round(t.b*255);return t},_RGBtoCMYK:function(e){var t=new CMYK(0,0,0,0);var i=e.r/255;var n=e.g/255;var o=e.b/255;t.k=Math.min(1-i,1-n,1-o);t.c=(1-i-t.k)/(1-t.k);t.m=(1-n-t.k)/(1-t.k);t.y=(1-o-t.k)/(1-t.k);t.c=Math.round(t.c*100);t.m=Math.round(t.m*100);t.y=Math.round(t.y*100);t.k=Math.round(t.k*100);return t},toRGB:function(e){if(e instanceof RGB){return e}if(e instanceof HSV){return this._HSVtoRGB(e)}if(e instanceof CMYK){return this._CMYKtoRGB(e)}},toHSV:function(e){if(e instanceof HSV){return e}if(e instanceof RGB){return this._RGBtoHSV(e)}if(e instanceof CMYK){return this._RGBtoHSV(this._CMYKtoRGB(e))}},toCMYK:function(e){if(e instanceof CMYK){return e}if(e instanceof RGB){return this._RGBtoCMYK(e)}if(e instanceof HSV){return this._RGBtoCMYK(this._HSVtoRGB(e))}}};var underscore=_.noConflict(),devicejs=device.noConflict();underscore.templateSettings.interpolate=/\{\{(.+?)\}\}/g;var appVersion=navigator.appVersion;var ie8=appVersion.indexOf("MSIE 8.")!==-1;var ie9=appVersion.indexOf("MSIE 9.")!==-1;var ie=appVersion.indexOf("MSIE")!==-1;function addListener(e,t,i){if(e.addEventListener){e.addEventListener(t,i,false)}else if(e.attachEvent){e.attachEvent("on"+t,function(e){return function(){i.call(e,window.event)}}(e));e=null}}function removeEvent(e,t,i){if(window.removeEventListener){e.removeEventListener(t,i,false)}else if(window.detachEvent){var n=function(){i.call(e)};e.detachEvent("on"+t,n)}else{return false}}function loadScript(e,t,i){var n=document.createElement("script");n.type="text/javascript";if(n.readyState){n.onreadystatechange=function(){if(n.readyState=="loaded"||n.readyState=="complete"){n.onreadystatechange=null;t()}else{i({target:n,readyState:readyState})}}}else{n.onload=function(){t()};n.onerror=function(e){i(e)}}n.src=e;if(typeof log!="undefined")log("adding script "+e);document.getElementsByTagName("head")[0].appendChild(n)}function setIframeLoadCallback(e,t){if(e.readyState){log("Using readyState callback");e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){e.onreadystatechange=null;t()}}}else{log("Using onload callback");e.onload=function(){if(e.contentWindow.location.href!="about:blank"){t();e.onload=null}}}}var dateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,n=function(e,t){e=String(e);t=t||2;while(e.length<t)e="0"+e;return e};return function(o,s,a){var r=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(o)=="[object String]"&&!/\d/.test(o)){s=o;o=undefined}if(typeof o==="string"&&isNaN(new Date(o))){o=o.replace(/-/g,"/").replace("T"," ").split(".").shift()+"Z"}o=o?new Date(o):new Date;if(isNaN(o))throw SyntaxError("invalid date");s=String(r.masks[s]||s||r.masks["default"]);if(s.slice(0,4)=="UTC:"){s=s.slice(4);a=true}var l=a?"getUTC":"get",c=o[l+"Date"](),u=o[l+"Day"](),d=o[l+"Month"](),f=o[l+"FullYear"](),h=o[l+"Hours"](),p=o[l+"Minutes"](),g=o[l+"Seconds"](),m=o[l+"Milliseconds"](),v=a?0:o.getTimezoneOffset(),_={d:c,dd:n(c),ddd:r.i18n.dayNames[u],dddd:r.i18n.dayNames[u+7],m:d+1,mm:n(d+1),mmm:r.i18n.monthNames[d],mmmm:r.i18n.monthNames[d+12],yy:String(f).slice(2),yyyy:f,h:h%12||12,hh:n(h%12||12),H:h,HH:n(h),M:p,MM:n(p),s:g,ss:n(g),l:n(m,3),L:n(m>99?Math.round(m/10):m),t:h<12?"a":"p",tt:h<12?"am":"pm",T:h<12?"A":"P",TT:h<12?"AM":"PM",Z:a?"UTC":(String(o).match(t)||[""]).pop().replace(i,""),o:(v>0?"-":"+")+n(Math.floor(Math.abs(v)/60)*100+Math.abs(v)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return s.replace(e,function(e){return e in _?_[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};var base_langpack={"b_onlineCallDefaultText":"\u041f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u043d\u0430\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e!","cw_callAfter":"\u0417\u0432\u043e\u043d\u043e\u043a \u0447\u0435\u0440\u0435\u0437","cw_callButtonText":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u044c","cw_callFree":"\u0417\u0432\u043e\u043d\u043e\u043a \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0439. \u0421\u0435\u0440\u0432\u0438\u0441 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d","cw_chat":"\u0427\u0430\u0442","cw_chatWithOperator":"\u0447\u0430\u0442 \u0441 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u043e\u043c","cw_close":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","cw_code_restrict":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043c\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u043c \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u043d\u0430 \u044d\u0442\u043e\u0442 \u043d\u043e\u043c\u0435\u0440","cw_connecting":"\u0421\u043e\u0435\u0434\u0438\u043d\u044f\u0435\u043c","cw_enterPhonePlaceholder":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0432\u0430\u0448 \u0442\u0435\u043b\u0435\u0444\u043e\u043d","cw_errInfoText":"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437, \u0438\u043b\u0438 \u043d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u043d\u0430\u043c \u0432 \u0447\u0430\u0442.","cw_formCenterText":"\u041d\u0435 \u043d\u0430\u0448\u043b\u0438, \u0447\u0442\u043e \u0438\u0441\u043a\u0430\u043b\u0438?","cw_form_second":"\u0441\u0435\u043a\u0443\u043d\u0434\u0443","cw_form_secondd":"\u0441\u0435\u043a\u0443\u043d\u0434","cw_form_seconds":"\u0441\u0435\u043a\u0443\u043d\u0434\u044b","cw_pickUpPhone":"\u0412\u043e\u0437\u044c\u043c\u0438\u0442\u0435 \u0442\u0440\u0443\u0431\u043a\u0443","cw_rate_limit":"\u0412\u044b\u0437\u043e\u0432 \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d","cw_repeatCall":"\u043f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u044c","cw_repeatCallAgain":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u0442\u044c \u0435\u0449\u0435 \u0440\u0430\u0437","cw_reportPlaceholder":"\u0421\u043e\u043e\u0431\u0449\u0438\u0442\u0435 \u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0435, \u043c\u044b \u0440\u0430\u0437\u0431\u0435\u0440\u0435\u043c\u0441\u044f!","cw_reportProblem":"\u0441\u043e\u043e\u0431\u0449\u0438\u0442\u044c \u043e \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0435","cw_seconds":"\u0441\u0435\u043a\u0443\u043d\u0434","cw_textSend":"\u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c","cw_thxForCall":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0412\u0430\u043c \u0437\u0430 \u0437\u0432\u043e\u043d\u043e\u043a!","cw_typeInChat":"\u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0432 \u0447\u0430\u0442","cw_unableToConnect":"\u041d\u0435 \u0441\u043c\u043e\u0433\u043b\u0438 \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f?","cw_weCalling":"\u041c\u044b \u0432\u0430\u043c \u0437\u0432\u043e\u043d\u0438\u043c","cw_weRecallAfter":"\u041f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u0447\u0435\u0440\u0435\u0437","c_callConnected":"\u0412\u044b\u0437\u043e\u0432 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d","c_callDisconnected":"\u0412\u044b\u0437\u043e\u0432 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d","c_callProcessing":"\u0412\u044b\u0437\u044b\u0432\u0430\u0435\u043c \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430...","defCallformTitle":"\u041d\u0443\u0436\u043d\u0430 \u043f\u043e\u043c\u043e\u0449\u044c? <br>\u041c\u044b \u043f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u0447\u0435\u0440\u0435\u0437 <span style='color: #40cd72'>_SEC_<\/span> \u0441\u0435\u043a\u0443\u043d\u0434!","defOfflineFormText":"\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0441\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432 \u044d\u0442\u043e\u0439 \u0444\u043e\u0440\u043c\u0435, \u0438 \u043c\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043c \u0435\u0433\u043e \u043d\u0430 e-mail \u0438 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0442\u0432\u0435\u0442\u0438\u043c!","defOfflineWidgetLabel":"\u041e\u0442\u043f\u0440\u0430\u0432\u044c\u0442\u0435 \u043d\u0430\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","defOfflineWidgetLabelMobile":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","defOnlineWidgetLabel":"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u043d\u0430\u043c, \u043c\u044b \u043e\u043d\u043b\u0430\u0439\u043d!","defOnlineWidgetLabelMobile":"\u041a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442","defRuleInvitationText":"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435! \u042f \u043c\u043e\u0433\u0443 \u0432\u0430\u043c \u0447\u0435\u043c-\u0442\u043e \u043f\u043e\u043c\u043e\u0447\u044c?","defRuleRetaining":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435. \u0421\u0435\u0439\u0447\u0430\u0441 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u0437\u0430\u043d\u044f\u0442\u044b, \u043d\u043e \u0441\u043a\u043e\u0440\u043e \u043a\u0442\u043e-\u043d\u0438\u0431\u0443\u0434\u044c \u043e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442\u0441\u044f \u0438 \u043e\u0442\u0432\u0435\u0442\u0438\u0442 \u0432\u0430\u043c!","lblAgentDisconnected":"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043e\u0442\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f","lblCallMe":"\u041f\u043e\u0437\u0432\u043e\u043d\u0438\u0442\u044c","lblCaptcha":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0441 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438","lblCaptchaError":"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043a\u043e\u0434, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437","lblChatEnded":"\u0414\u0438\u0430\u043b\u043e\u0433 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d","lblChatIsOnline":"\u041a\u043e\u043d\u0441\u0443\u043b\u044c\u0442\u0430\u043d\u0442 \u043e\u043d\u043b\u0430\u0439\u043d","lblConnectedToAgent":"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435!","lblConnectionLost":"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043e. \u0412\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u043c...","lblDeclineFile":"\u041e\u0442\u043a\u043b\u043e\u043d\u0438\u0442\u044c","lblDefaultCobrowseComment":"\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435","lblEnterMessageHere":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 Enter","lblEnterMessageOrPhoneHere":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0438\u043b\u0438 \u043d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 (\u043f\u0435\u0440\u0435\u0437\u0432\u043e\u043d\u0438\u043c \u043c\u0433\u043d\u043e\u0432\u0435\u043d\u043d\u043e)","lblEvaluateCancel":"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c","lblEvaluatePlease":"\u041e\u0446\u0435\u043d\u0438\u0442\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u044f","lblEvaluateThanks":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0437\u0430 \u043e\u0446\u0435\u043d\u043a\u0443!","lblHangUp":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435","lblHangUpShort":"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c","lblIntroduceButton":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c\u0441\u044f","lblIntroduceName":"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f","lblIntroduceRequest":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0442\u0435\u0441\u044c, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430","lblIntroduceRequestBefore":"\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u044c\u0442\u0435\u0441\u044c \u0438 \u043d\u0430\u0447\u043d\u0438\u0442\u0435 \u0447\u0430\u0442!","lblLeaveMessage":"\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblLookingForFreeAgent":"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u043c\u0441\u044f...","lblMessageError":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043d\u0435 \u0431\u044b\u043b\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c","lblMessageHere":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblNegative":"\u041f\u043b\u043e\u0445\u043e","lblNewMessage":"\u041d\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435!","lblNoOperators":"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c","lblOfflineMessageSend":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e","lblOperatorsOnline":"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u044b \u043e\u043d\u043b\u0430\u0439\u043d","lblPencilHint":"\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043d\u0430\u0431\u0438\u0440\u0430\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblPhoneHint":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u00ab\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044c\u00bb, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430 \u0434\u043b\u044f \u0440\u0430\u0437\u0433\u043e\u0432\u043e\u0440\u0430.\r\n\u0412\u0430\u0448\u0430 \u0432\u0435\u0431-\u043a\u0430\u043c\u0435\u0440\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043d\u0435 \u0431\u0443\u0434\u0435\u0442","lblPositive":"\u0425\u043e\u0440\u043e\u0448\u043e","lblPwrBy":"\u0427\u0430\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d <a href=\"http:\/\/www.jivosite.ru\/_URL_\" target=\"_blank\"><span class=\"j1\">Jivo<\/span><span class=\"j2\">Site<\/span><\/a>","lblReceiveFile":"\u041f\u0440\u0438\u043d\u044f\u0442\u044c","lblReopenedElseWhere":"\u0414\u0438\u0430\u043b\u043e\u0433 \u043e\u0442\u043a\u0440\u044b\u0442 \u0432 \u0434\u0440\u0443\u0433\u043e\u043c \u043e\u043a\u043d\u0435","lblReply":"\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c","lblSelectDep":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0442\u0434\u0435\u043b","lblSend":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c","lblSendBefore":"\u041d\u0430\u0447\u0430\u0442\u044c \u0434\u0438\u0430\u043b\u043e\u0433","lblSendingFile":"_AGENT_ \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442 \u0412\u0430\u043c \u0444\u0430\u0439\u043b: _FILE_","lblThanks":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e!","lblThankYouMessage":"\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0437\u0430 \u0432\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435! \u041c\u044b&nbsp;\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0441\u0432\u044f\u0436\u0435\u043c\u0441\u044f \u0441&nbsp;\u0412\u0430\u043c\u0438 \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f","lblTransferred":"\u0414\u0438\u0430\u043b\u043e\u0433 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0443 _AGENT_","lblView":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c","lblWaitForOperator":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043e\u0436\u0438\u0434\u0430\u0439\u0442\u0435 \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430...","lblWebPhoneFlashError":"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043d\u0430\u044f \u0432\u0435\u0440\u0441\u0438\u044f Flash \u043d\u0435 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0441\u043e\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0432\u044b\u0437\u043e\u0432. \u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0447\u0430\u0442\u043e\u043c","lblWebPhoneMicError":"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043c\u0438\u043a\u0440\u043e\u0444\u043e\u043d. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0430\u0442\u043e\u043c","lblWebPhoneNotAvail":"\u0412\u044b\u0437\u043e\u0432 \u043d\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u0435\u043d \u0438\u0437-\u0437\u0430 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0430\u0442\u043e\u043c","lblWebPhoneNotConnected":"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0433\u043e\u043b\u043e\u0441\u043e\u0432\u043e\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u0447\u0430\u0442\u043e\u043c","lblYourEmail":"\u0412\u0430\u0448 E-mail","lblYourMessage":"\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","lblYourPhone":"\u0412\u0430\u0448 \u0442\u0435\u043b\u0435\u0444\u043e\u043d","lnkCloseThisWindow":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","lnkRestartChat":"\u0412\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c","ofl_enterEmail":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 e-mail","ofl_enterMessage":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435","ofl_enterName":"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f","ofl_enterValidEmail":"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 e-mail","ofl_enterValidPhone":"\u0423\u043a\u0430\u0437\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u0435\u043b\u0435\u0444\u043e\u043d","seo_copyrightTextNew":"\u0427\u0430\u0442 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d <a href=\"http:\/\/www.jivosite.ru\/\" target=\"_blank\" id=\"jivosite-copyright\" class=\"jivo-_COLOR_ jivo-ru\"><\/a>"};function translate(e){if("custom_langpack"in config&&e in config.custom_langpack){return config.custom_langpack[e].replace(/\n/g,"<br />").replace(/'/g,"&#039;")}return translate_basic(e)}function translate_basic(e){if(e in base_langpack){return base_langpack[e].replace(/\n/g,"<br />")}return e}function cookie(e,t,i){if(e!="__utmz"){e=["jv",e,config.widget_id].join("_")}if(arguments.length>1&&String(t)!=="[object Object]"){if(typeof i==="undefined"){i={}}if(t===null||t===undefined){log("Clearing COOKIE "+e);i.expires=-1}else{log("Set COOKIE "+e+" with value "+t)}if(typeof i.expires==="number"){var n=i.expires,o=i.expires=new Date;o.setDate(o.getDate()+n)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",config.cookie_domain&&!jivo.isSeparateWindow()?"; domain="+config.cookie_domain:"","; path=/"].join("")}i=t||{};var s,a=i.raw?function(e){return e}:decodeURIComponent;return(s=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?a(s[1]):null}function getJSONP(e,t){var i=new jivoXHR;i.open("GET",e);i.onload=t;i.send()}function getJSONPWithData(e,t,i){e+="?cb=?";t["t"]=(new Date).getTime();for(var n in t){e+="&"+n+"="+encodeURIComponent(t[n])}return getJSONP(e,i)}var error_sent_cnt=0;function reportException(e){if("production"=="production"&&!config["disable_error_reporting"]){if(++error_sent_cnt>3){return}try{getJSONPWithData("//err.jivosite.com/widget",{widget_id:config.widget_id,message:e.message,url:window.top.location.href,lineNumber:e.lineNumber,fileName:e.fileName},log)}catch(e){log(e.message)}}else{log("REPORT",e)}}function telemetry(e,t){if(typeof t!="object"){t={}}t.event=e;t.widget_id=config.widget_id;t.chat_mode=config.chat_mode;if(cookie("client_id")){t.client_id=cookie("client_id").split(".")[0]}if("production"!="production"){log("TELEMETRY",t);return}try{getJSONPWithData("//telemetry.jivosite.com/w",t,log)}catch(i){log(i.message)}}function callWidgetPing(e,t){var i={name:"cw_ping"};if(cookie("client_id")){i.jv_client_id=cookie("client_id")}if(cookie("sess_id")){i.jv_sess_id=cookie("sess_id")}if(t){i=underscore.extend(i,t)}getJSONPWithData(chatServerUrl(config.widget_id,config.site_id),i,function(t){if(t.result==="ok"){e(t)}})}function setUTMParams(e){var t=e.substr(e.indexOf("?")+1),i=t.split("&"),n,o,s="";for(o=i.length;o--;){n=i[o].split("=");if(n[0].indexOf("utm_")>=0){n=i[o];s+=(s.length>0?"|":"")+n.substr(n.indexOf("utm_")+4)}}if(s){cookie("utm",s)}}function setImplicitGuiMessage(e,t){var i=0,n=t||"";underscore.each(underscore.pairs(e),function(e){if(i<10){n=n+e[0]+": "+e[1]+"; \n";i+=1}});if(i>0){jivo.handle("gui_message",n,{implicit:1})}}function highlightUrls(e){var t=/(\s|"|'|^)((?:(?:http|https|ftp|ftps|mailto):\/\/)?)((?:[a-zA-Zа-яА-Я0-9]|[\~\!\#$\%\^\&\*\(\)\+\=\_\-\:\;?\/\[\]\{\}\`\.]|(?:,(?!\s)))*\.(?:рф|com|aero|biz|com|coop|edu|eu|gov|info|int|mil|museum|name|net|org|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|travel|xxx|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)(?:[a-zA-Zа-яА-Я0-9]|[\~\!\#$\%\^\&\*\(\)\+\=\_\-\:\;?\/\[\]\{\}\`\.]|(?:,(?!\s)))*)/gim;e=e.replace(/^(\n)/,"");e=e.replace(/([\n]{2,})/g,"\n\n");return stripBrackets(e).replace(t,function(e,t,i,n){if(!i){i="http://"}var o=document.domain;o=o.replace("www.","");var s;if(n.indexOf(o,0)==-1){s="_blank"}else{s="col_old_page"}return t+"<a href='"+i+n+"' target='"+s+"'>"+n+"</a>"})}function nl2br(e){return e.replace(/\n/g,"<br />")}function stripBrackets(e){if(underscore.isUndefined(e))return"";else return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}var CLASS_LIST_SUPPORTED="classList"in document.documentElement;function splitClasses(e){return underscore.isArray(e)?e:e.replace(/^\s+|\s+$/g,"").split(/\s+/)}function forceRedraw(e){e.offsetHeight}function getClasses(e){return splitClasses(e.className)}function setClasses(e,t){var i=t.join(" ");if(e.className!==i){e.className=i;forceRedraw(e)}}var hasClass=CLASS_LIST_SUPPORTED?function e(t,i){return t.classList.contains(i)}:function t(e,i){return e.className!==""&&underscore.contains(getClasses(e),i)};var addClass=CLASS_LIST_SUPPORTED?function i(e,t){underscore.each(splitClasses(t),function(t){if(e){e.classList.add(t)}});forceRedraw(e)}:function n(e,t){var i=getClasses(e),n=underscore.union(i,splitClasses(t));setClasses(e,n)};var removeClass=CLASS_LIST_SUPPORTED?function o(e,t){underscore.each(splitClasses(t),function(t){e.classList.remove(t)});forceRedraw(e)}:function s(e,t){var i=getClasses(e),n=underscore.difference(i,splitClasses(t));setClasses(e,n)};var toggleClass=CLASS_LIST_SUPPORTED?function a(e,t,i){t=underscore.uniq(splitClasses(t));underscore.each(t,function(t){e.classList.toggle(t,i)});forceRedraw(e)}:function r(e,t,i){var n=getClasses(e),o=[],s=[],a;underscore.each(splitClasses(t),function(e){var t=underscore.contains(n,e)?i!==true&&s:i!==false&&o;if(t){t.push(e)}});a=underscore.union(underscore.difference(n,s),o);setClasses(e,a)};function removeProperty(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else e.style.removeAttribute(t)}function removeElement(e){e.parentNode.removeChild(e)}function prefixedEvent(e,t,i){var n=["webkit","moz","MS","o",""];for(var o=0;o<n.length;o++){if(!n[o])t=t.toLowerCase();if(e.addEventListener){e.addEventListener(n[o]+t,i,false)}else{e.attachEvent(n[o]+t,i)}}}function css3AnimationIsSupported(){var e=utils.browser,t=e.name;return!!(t==="Firefox"&&e.mV>23||t==="Chrome"&&e.mV>28||t==="Safari"&&e.mV>5)}function switchClasses(e,t,i){removeClass(e,t);addClass(e,i)}function getOffsetRect(e){var t=e.getBoundingClientRect();var i=document.body;var n=document.documentElement;var o=window.pageYOffset||n.scrollTop||i.scrollTop;var s=window.pageXOffset||n.scrollLeft||i.scrollLeft;var a=n.clientTop||i.clientTop||0;var r=n.clientLeft||i.clientLeft||0;var l=t.top+o-a;var c=t.left+s-r;return{top:Math.round(l),left:Math.round(c)}}function getElementPosition(e){function t(e){return e.compatMode&&e.compatMode!="BackCompat"?e.documentElement:e.body}var i=e.ownerDocument,n=i.all&&!window.opera,o=n?t(i):i.defaultView||i.parentWindow,s={left:0,top:0},a;if(e.getBoundingClientRect){s=underscore.extend(s,e.getBoundingClientRect())}else{a=e;while(a){s.left+=a.offsetLeft;s.top+=a.offsetTop;a=a.offsetParent}}s.width=e.offsetWidth;s.height=e.offsetHeight;s.windowWidth=n?o.clientWidth:o.innerWidth;s.windowHeight=n?o.clientHeight:o.innerHeight;return s}function setElementPosition(e,t){e.style.cssText+=""+"; top: "+t.top+"px"+"; left : "+t.left+"px"+"; width : "+t.width+"px"+"; height: "+t.height+"px";return this}function setSubstrTitle(e){return e.substr(0,255)}function getConfigContactsAsk(){var e=true;underscore.each(["name","phone","email"],function(t){if(config.contacts_settings[t].show){e=false}},this);if(e){config.contacts_ask=2}}function getIconLocale(){if(config.iconLocale===undefined){var e=underscore.find(["ru_RU","be","kk","uk"],function(e){return e===config.locale});config.iconLocale=e?e:"en"}return config.iconLocale}function getURLParam(e,t){var i=(t||window.location||"").search.substring(1);var n=i.split("&");for(var o=0;o<n.length;o++){var s=n[o].split("=");if(s[0]==e){return decodeURIComponent(s[1])}}}function getByIdFromParent(e){var t=window.parent.document,i=t.getElementById(e);return i&&$(i)}function proxy(e,t,i){return e[t].apply(e,i)}var utils={fields:["client_name","phone","email"],phoneReg:/^\+?[0-9() -]+$/i,showAd:function(){return!(config.options&8&&config.hide_ad)},hideOffline:function(){return config.hide_offline>0&&config.options&512},isValidValue_phone:function(e){return e.replace(/\D+/g,"").length>=5&&this.phoneReg.test(e)},isValidValue_mobilePhone:function(e){var t=e.replace(/\D+/g,""),i=-1;if(underscore.indexOf(["7","8"],t.charAt(0))!==-1){i=11}else if(t.charAt(0)==="9"){i=10}return underscore.indexOf(["7","8","9"],t.charAt(0))!==-1&&t.length===i&&this.phoneReg.test(e)},isValidValue_email:function(e){return e.length>=4&&/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)},isValidValue_name:function(e){return e.length>0&&e.length<100}};(function(e){if(e.browser)return;e.browser={};e.browser.mozilla=false;e.browser.webkit=false;e.browser.opera=false;e.browser.msie=false;var t=navigator.userAgent;e.browser.ua=t;e.browser.name=navigator.appName;e.browser.fV=""+parseFloat(navigator.appVersion);e.browser.mV=parseInt(navigator.appVersion,10);var i,n,o;if((n=t.indexOf("Opera"))!=-1){e.browser.opera=true;e.browser.name="Opera";e.browser.fV=t.substring(n+6);if((n=t.indexOf("Version"))!=-1)e.browser.fV=t.substring(n+8)}else if((n=t.indexOf("MSIE"))!=-1){e.browser.msie=true;e.browser.name="Microsoft Internet Explorer";e.browser.fV=t.substring(n+5)}else if(t.indexOf("Trident")!=-1){e.browser.msie=true;e.browser.name="Microsoft Internet Explorer";var s=t.indexOf("rv:")+3;var a=s+4;e.browser.fV=t.substring(s,a)}else if((n=t.indexOf("Chrome"))!=-1){e.browser.webkit=true;e.browser.name="Chrome";e.browser.fV=t.substring(n+7)}else if((n=t.indexOf("Safari"))!=-1){e.browser.webkit=true;e.browser.name="Safari";e.browser.fV=t.substring(n+7);if((n=t.indexOf("Version"))!=-1)e.browser.fV=t.substring(n+8)}else if((n=t.indexOf("AppleWebkit"))!=-1){e.browser.webkit=true;e.browser.name="Safari";e.browser.fV=t.substring(n+7);if((n=t.indexOf("Version"))!=-1)e.browser.fV=t.substring(n+8)}else if((n=t.indexOf("Firefox"))!=-1){e.browser.mozilla=true;e.browser.name="Firefox";e.browser.fV=t.substring(n+8)}else if((i=t.lastIndexOf(" ")+1)<(n=t.lastIndexOf("/"))){e.browser.name=t.substring(i,n);e.browser.fV=t.substring(n+1);if(e.browser.name.toLowerCase()==e.browser.name.toUpperCase()){e.browser.name=navigator.appName}}if((o=e.browser.fV.indexOf(";"))!=-1)e.browser.fV=e.browser.fV.substring(0,o);if((o=e.browser.fV.indexOf(" "))!=-1)e.browser.fV=e.browser.fV.substring(0,o);e.browser.mV=parseInt(""+e.browser.fV,10);if(isNaN(e.browser.mV)){e.browser.fV=""+parseFloat(navigator.appVersion);e.browser.mV=parseInt(navigator.appVersion,10)}e.browser.version=e.browser.mV})(utils);function staticUrl(e,t){if(!t){e+="?rnd=1453900664"}if(config.static_host){return"//"+config.static_host+e}return config.base_url+e}function chatServerUrl(){var e=window.location.protocol+"//";if("comet"in config){e+=config.comet.host;if(window.location.protocol=="https:"){if("secure_port"in config.comet){e+=":"+config.comet.secure_port}}else{if("plain_port"in config.comet){e+=":"+config.comet.plain_port}}}else{e+="node.jivosite.com"}return e+"/jsonp/"+underscore.toArray(arguments).join("/")}(window.jivo_init=function(){function e(e,t){var i=document;if(t){i=t}var n;try{n=i.getElementsByClassName(e)}catch(o){n=[];var s=new RegExp("\\b"+e+"\\b");var a=i.getElementsByTagName("*");for(var r=0;r<a.length;r++){var l=a[r].className;if(s.test(l)){n.push(a[r])}}}return n}var t=window._templates={chat:underscore.template(["<div dir='ltr' class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-chat-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-noise jivo-noise-pattern'></div>","<div id='jivo-css-leaf' class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo_iframe_wrap'>","<div id='jivo_iframe_placeholder'>","<div id='inner-chat' style='display: none;' <% if (jivo.isTablet()) {%>class='tablet-version-widget'<% } %>>","<div id='web_phone' class='phone_hidden'>","<div id='rtc_placeholder'></div>","<div id='up_arrow'></div>","<div id='phone_hint'></div>","</div>","<div id='sound_player'></div>","<div id='contents_placeholder'></div>","</div>","</div>","</div>"].join("\n")),label:{top:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper'>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='height: {{ height }}px'>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","<div id='jivo-label-text' <% if (locale) {%>class='jivo-{{ locale }}'<% } %>>{{ text }}</div>","<div id='jivo-label-indicator'></div>","<div id='jivo-label-status' class='jivo-{{ type }}'></div>","</div>","</div>","</div>"].join("\n")),bottom:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square jivo-{{ jivo_config.chat_mode }}'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='height: {{ height }}px'>","<div id='jivo-label-status' class='jivo-{{ type }} jivo-{{ jivo_config.chat_mode }}'></div>","<div id='jivo-label-text' <% if (locale) {%>class='jivo-{{ locale }}'<% } %>>{{ text }}</div>","<div id='jivo-label-indicator'></div>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","</div>","</div>","</div>"].join("\n")),left:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='width: {{ height }}px'>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","<div id='jivo-label-text' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'>","<div id='jivo-text-container'>","<div>{{ text }}</div>","</div>","</div>","<div id='jivo-label-status' class='jivo-{{ type }}'></div>","<div id='jivo-label-indicator'></div>","</div>","</div>","</div>"].join("\n")),right:underscore.template(["<div id='jivo_chat_widget_online'>","<div id='jivo-label' class='jivo-fixed-{{ orientation }} jivo-animate jivo-{{ jivo_config.chat_mode }}'>","<div class='jivo-triangle-wraper '>","<div class='jivo-triangle-clip'>","<div class='jivo-triangle jivo-label-triangle'><div class='jivo-triangle-inner'></div></div>","<div class='jivo-noise jivo-noise-pattern-{{ jivo_config.widget_font_color }}'></div>","<div class='jivo-css-leaf jivo-{{ jivo_config.chat_mode }} jivo-{{ jivo_config.widget_font_color }}'>","<div class='jivo-top-right-square'>","<div class='jivo-bottom-left-square'></div>","</div>","</div>","</div>","</div>","<div id='jivo-label-wrapper' style='width: {{ height }}px'>","<div id='jivo-label-copyright' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'></div>","<div id='jivo-label-text' class='jivo-{{ type }} <% if (locale) {%>jivo-{{ locale }}<% } %>'>","<div id='jivo-text-container'>","<div>{{ text }}</div>","</div>","</div>","<div id='jivo-label-status' class='jivo-{{ type }}'></div>","<div id='jivo-label-indicator'></div>","</div>","</div>","</div>"].join("\n"))},message:{message:underscore.template(["<% if (jivo.isSeparateWindow()) {%>","<div id='jivo_action'>","<div id='jivo_close_button' data-action='close'></div>","</div>","<% } %>","<div id='header-avatar' class='header {{ jivo_config.widget_font_color }}'>","<div id='header-avatar-container'>","<div id='header-animate-container'>","<div class='info'>","<div class='agent-name'>{{ header }}</div>","</div>","</div>","</div>","<div class='clear'></div>","</div>","<div class='special-logo'></div>","<div id='offline-form' class='message<% if (templateData.nologo) {%> nologo<% } %>'>","<div id='offline-form-inner' class='system-message-container'>","<div class='description message'>{{ msg }}</div>","<div id='buttons'></div>","</div>","<div id='jivosite-adword' class='<% if (templateData.locale) {%>jivosite-adword-{{ templateData.locale }}<% } %>'>","<div class='content'>","{{ templateData.link }}","</div>","</div>","</div>"].join("\n"))},offline:{form:underscore.template(["<% if (jivo.isSeparateWindow()) {%>","<div id='jivo_action'>","<div id='jivo_close_button' data-action='close'></div>","</div>","<% } %>","<div id='header-avatar' class='header {{ jivo_config.widget_font_color }}'>","<div id='header-avatar-container'>","<div id='header-animate-container'>","<div class='info'>","<div class='agent-name'>{{ header }}</div>","</div>","</div>","</div>","<div class='clear'></div>","</div>","<div class='special-logo'></div>","<div id='offline-form'<% if (nologo) {%> class='nologo'<% } %>>","<div id='offline-form-inner'>","<div id='offline-form-fields'>","<div class='description'>{{ text }}</div>","<% if (fields.get('message').show()) {%>","<div class='field-wrapper message'>","<textarea id='message' maxlength='{{ maxMessageLength }}' class='input-field' placeholder='{{ translate('lblYourMessage') }}<% if (fields.get('message').required()) {%>*<% } %>'>{{fields.get('message').value()}}</textarea>","<div id='error-message' class='error-balloon multiline'>{{ translate('ofl_enterMessage') }}</div>","</div>","<% } %>","<% if (fields.get('name').show()) {%>","<div class='field-wrapper'>","<input id='name' type='text' class='input-field' placeholder='{{ translate('lblIntroduceName') }}<% if (fields.get('name').required()) {%>*<% } %>' value='{{ cookie('client_name') }}'>","<div id='error-name' class='error-balloon'>{{ translate('ofl_enterName') }}</div>","</div>","<% } %>","<% if (fields.get('phone').show()) {%>","<div class='field-wrapper'>","<input id='phone' type='tel' class='input-field' placeholder='{{ translate('lblYourPhone') }}<% if (fields.get('phone').required()) {%>*<% } %>' value='{{ cookie('phone') }}'>","<div id='error-phone' class='error-balloon'>{{ translate('ofl_enterValidPhone') }}</div>","</div>","<% } %>","<% if (fields.get('email').show()) {%>","<div class='field-wrapper'>","<input id='email' type='email' class='input-field' placeholder='{{ translate('lblYourEmail') }}<% if (fields.get('email').required()) {%>*<% } %>' value='{{ cookie('email') }}'>","<div id='error-email' class='error-balloon'>{{ translate('ofl_enterValidEmail') }}</div>","</div>","<% } %>","<div class='buttons'>","<div class='left-button'>","<a id='cancel' class='jivoBtn cancel' href='#'>{{ translate('lblEvaluateCancel') }}</a>","</div>","<div>","<input id='submit' type='button' value='{{ translate('lblSend') }}' class='jivoBtn accept'>","</div>","</div>","<div class='captcha-container'>","<div class='body'>","<img src='' alt='captcha code image'>","<input type='text' class='input-field cap_symbols' value='' placeholder='{{ translate('lblCaptcha') }}'>","<input id='resend' type='button' class='jivoBtn accept' value='Ok'>","</div>","<p><div class='error'>{{ translate('lblCaptchaError') }}</div></p>","</div>","<a id='cancelCap' class='jivoBtn cancel' href='#'>{{ translate('lblEvaluateCancel') }}</a>","<div class='clear'/>","</div>","<div id='jivosite-adword' class='<% if (locale) {%>jivosite-adword-{{ locale }}<% } %>'>","<div class='content'>","{{ link }}","</div>","</div>","</div>"].join("\n"))},online:{chat:underscore.template(["<% if (jivo.isSeparateWindow()) {%>","<div id='jivo_action'>","<div id='jivo_close_button' data-action='close'></div>","</div>","<% } %>","<div id='jivosite-iframe-chat'>","<div id='header-avatar' class='header {{ jivo_config.widget_font_color }}'>","<div id='header-avatar-container'>","<div id='header-animate-container'>","<div class='header-animate-info header-animate-first'>","<div class='avatar'></div>","<div class='info'>","<div class='agent-name'>{{ agent.name }}</div>","<div class='title'>{{ agent.title }}</div>","</div>","</div>","<div class='header-animate-info header-animate-second'>","<div class='avatar'></div>","<div class='info'>","<div class='agent-name'></div>","<div class='title'></div>","</div>","</div>","</div>","</div>","<div class='clear'></div>","<div class='sound_player'></div>","</div>","<div id='chat-body'<% if (templateData.nologo) {%> class='nologo'<% } %>>","<div id='jivo-chat'>","<div id='scrollbar-container'>","<div id='messages-div' class='viewport'>","<div id='messages-div-outer'>","<div id='messages-div-inner' class='overview messages-div-inner'>","<div id='messages-div-inner-clear'></div>","</div>","</div>","<div id='agent-typing'></div>","</div>","</div>","</div>","<div id='jivosite-adword' class='<% if (templateData.locale) {%>jivosite-adword-{{ templateData.locale }}<% } %>'>","<div class='content'>","{{ templateData.link }}","</div>","</div>","<div id='input-div' class='<% if (devicejs.iphone()) {%>input-div-iphone<% } %>'>","<div class='input-div-table'>","<div class='td-textarea'>","<textarea id='input-field' class='<% if (jivo.getCallWidget()) {%>input-field-callwidget<%}%>' name='input-field' maxlength='{{ templateData.maxMessageLength }}' placeholder='{{templateData.lblEnterMessageHere}}' autocomplete='off'></textarea>","</div>","<div class='td-button'>","<input id='input-button' type='button' value=<% if (jivo.isTablet() && !jivo.isSeparateWindow()) {%>'{{ translate('lblReply') }}'<% } else {%>'{{ translate('lblSend') }}' disabled<% } %> class='jivoBtn accept'>","</div>","</div>","</div>","</div>","</div>","<div class='special-logo'></div>","<svg id='svg-image-blur'>","<filter id='blur-effect'>","<feGaussianBlur stdDeviation='5' />","</filter>","</svg>"].join("\n")),agentMessage:underscore.template(["<div class='new-msg-container {{ type }} {{ color }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='pip'></div>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'>{{ nl2br(highlightUrls(text)) }}</div>","</div>","</div>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),clientMessage:underscore.template(["<div class='new-msg-container {{ type }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='pip'></div>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'>{{ nl2br(highlightUrls(text)) }}</div>","</div>","</div>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),systemMessage:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='new-msg-body {{ type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ text }}</div>","</div>","</div>","</div>","</div>"].join("\n")),emptyMessage:underscore.template(["<div class='new-msg-container {{ type }}' style='visible:hidden'>","</div>"].join("\n")),connectionError:underscore.template(["<div class='connectionError new-msg-container systemMessage'>","<div class='new-msg-body systemMessage'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ text }}</div>","</div>","</div>","</div>","</div>"].join("\n")),cobrowse_highlight:underscore.template(["<div class='new-msg-container agentHighlight {{ color }} <% if (history && history === true) {%>new-msg-container-history<% } %>'>","<div class='pip'></div>","<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'>{{ highlightUrls(comment) }}</div>","</div>","<div class='cobrowse-btn-container'>","<a href='#' data-url='{{ page_url }}' data-hash='{{ hash }}'>","<div class='white-cloud'></div>{{ translate('lblView') }}","</a>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),messageNode:underscore.template(["<div class='new-msg-text <% if (history && history === true) {%>new-msg-text-history<% } %>'>","<div class='new-msg-text-inner'><% if (type !== 'connectionError') {%>{{ nl2br(highlightUrls(text)) }}<% } else { %>{{ text }}<% } %></div>","</div>"].join("\n")),typing:underscore.template(["<div class='agent-typing-wrapper'>","<div class='agent-typing'>","{{ translate('lblPencilHint') }}","</div>","</div>"].join("\n")),receiveFile:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='new-msg-body'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ translate('lblSendingFile').replace('_FILE_', fileName).replace('_AGENT_', agentName) }}</div>","</div>","<div class='evaluation-btn-container'>","<a href='{{ fileUrl }}' id='receive_file_{{ fileId }}' data-id='{{ fileId }}' data-name='{{ fileName }}' target='_blank' class='button accept'>{{ translate('lblReceiveFile') }}</a>","<a href='#' class='button decline' data-id='{{ fileId }}' data-name='{{ fileName }}'>{{ translate('lblDeclineFile') }}</a>","</div>","</div>","</div>","</div>"].join("\n")),highlight:underscore.template(["<div class='new-msg-container {{ type }}'>","<div class='pip'></div>","<div class='new-msg-body {{type }}'>","<div class='new-msg-body-inner'>","<div class='new-msg-text'>","<div class='new-msg-text-inner'>{{ text }}</div>","</div>","<div class='cobrowse-btn-container'>","<a href='#' data-href='{{ hash }}'>","<div class='white-cloud'></div>{{ lblView }}","</a>","</div>","</div>","</div>","<div class='new-time'>{{ dateFormat(time, 'H:MM') }}</div>","</div>"].join("\n")),introduceForm:underscore.template(["<div id='introduce-form'<% if (nologo) {%> class='nologo'<% } %>>","<div id='jivosite-adword' class='<% if (locale) {%>jivosite-adword-{{ locale }}<% } %>'>","<div class='content'>","{{ link }}","</div>","</div>","<div id='introduce-avatar'>","<img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHMAAABzCAYAAACrQz3mAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADkdJREFUeNrsXQu0VkUVHn4el8fVFAIFcwmCRiBYKd0lj1zx8oFIAipaUGgSxIqHddUkWCVSBMrjQgsVgtQgwgcLFB9Qll5AeabiJSyIWyQqmhYgL3m0P8++9nPunnP/85/HzHDvXmuvH84598ye/Z09s2fPnplaJ06cUNm0bt065RAVErcj7kDcivlc4ibMBcSnEdcmPka8j/gw8b+ZdxHvZN5CvJV4v3KU6jgm7/nE3Yi7MLcL8bcA9Az+91kBzwHQNcylxH93RTm1LLfMBsR9ia8i7k3cwoAMu4lXEj9L/DTxAWfAtIHog7qZfgYxkLbRU8SLi4qKFiVUd/fBpEq0oZ9i4iHE9R1o1Q4RP0I8lYDdXgOmJ/xl9HMX8bV5/PlHxGXsvMCJKWenpsLBgbOzj5R9lMqpw85QQZaDBGepJTtOcKLaEzfKQ47lxJOpnJerJZgk9CX0M5H7w1zpHe6/4JysJt5GCjweo0wZ+mlL3JUdLPTTZ4d4xXPEPyaZNlULMEnYpvRTwn1iLgTLW8J91aukqBMpylqLfr5IfA3xjWy5udDjxN8jWd87ZcEkQWfQz+gcHv2A+6P5pJAtFjlmaIpv4X69cQ5/MpPkH3NKgUkCdqKfOcSXVPEoxnjTiH9DSjhsq+dD9UG/+03i23MY624mHkH1We88mCTcdPqp6ut8jXgCmtI0m9GYmmEMn37KzXEQzaC6jXUSTG6SfkXcKeCxch6OPOESiBpQBxD/nLhNwKMbiG8N6jqsA5MEupp+fk3cVPPIQeJJaFKpYgdjqkxD4i9ws3ch8ZlZXDdrKLOLPyIMIzYSH4mx6g246R3H/5YITtFQqvcK68EkYUbSz+yAR14gHkaV2RFDZb5EfB3x19nTzIQUF4H359m7Lo2j/lQv1AEx5LnE3QMe/T49OztOMDMxAzktAEhETEYR99QBmSPB+bgNY0x2LsbzgD+fuiCIMJD4JWJYynkxAYrgfE+u7yHNY7NYX7FRLJbJ3h0srrPmESh+IFWyLKIDgGHBvcTNE+r+drM1vRnFMn31ac/jzraaP1mLMiu8d6OWSYXj634xAMgnvTpWDWQAIQqznB2qpIAEYVbmMeLWcb2Q6/0VOHmaR6C3F0mPp0ctK45mdhVk1tybxBa5N8L7LyBer9KbQUGTjcD5+8qb9hpMXC8ioOibr+dWRXyEeCUBGqmcSM0sFQ6noatwC7P6t1ElFkQMZ6GJ+r0KFx9Ngt4i/gnxvLDNrFC/oewc1dY0uV1St0wSarIGSLj61+cDpI8+Q7zMAiBB5zAAmMMsjGilC9hKj2ia3GmpgklADqefOzVA9ieBl8agwLlx9l0x0U3cdxdEBHQpD6kkQBElGp4KmBwQmCPcQnt9i24wHJL68NdrI32NOGqrA0Cf4Y/jmHAb+r06UTAJyIs4siPRnSTgwhiUBZkmK7sJIAyIAdAnecws0cPEFyVpmfOVHKLDLPvUmBTVJ2wlDNEU9f8wYdQ+VPp4P8v6jh9Mnv2QguYYP90do5JuVW4QQnbXxvSuuzXjUOh7eqxDE56PXK+J7BRFHEdml9OYozAFjgAKZ6hfmKFJQN0RNHhFeZMFfkLQYUNclik5PId4CLI3RuX0cAhI0BUqpkxC1uMNSo7lzomlmeVUDylD4A4S4I2YlXOZcosKVNXZE2EAhT6LhVsoY0YkMAnIZkrO2UFQfXYCyumk3KNLY37fL1m/fgIOzaJYZolwDZPJwxLKDLjAQTDbxPky1usw1nMueFQNJlnll5WXXuiniRHnI3Xl1VP6zASb6by4X8j6nSjcujGoWQ+yzEnCtZ1hXOWQ1ELFPFmeEp2R0Huns75zwUUPJlkJAr5XCrcQ5TmUkPANlZvUIImXsp7v0HjQXcJYphREf1V5M+ZJUV1HwUxyjSsCCX+WRhI5gUlWeaEmsjEh4XRIV8FMqqWqcIYmCLeAT9tcLPOHwjVkmj/tqlISpoMJv38F699Pt+cC5mDh2n0pJCn/x1Ew303y5az3KcKtIYFgUhOLqR1/eArrHBeloJT/OgpmeQplLGYcsgnRp28EWeZNwoseTWkRz/4Umqwk6J9JF8D6f0S4NUgEk6yyYjMIPy1IQyPcnOyssUwtSXOb12QP6TI+D8lPZaTk10+lr9xVmTkI/4bGs60EppRzsiRlxexwDEh0C39NsTwJj6skMHsJDy5PWTmvOQYm9i74OMXyJDx6nQQm9ZdIafSn/e82oFzXwEx7B6zXGZdsAm6tsy2zm/CHqwwsgMW6jGMOgbkhzcIYj1XCrW7ZYEqZ6avT1gwJ+5Gmk7eRoNhSA+VKuHTNBlNK11hrSEkvOQLmZqHJS4PWCNc+mUXJUH9Zsc1nNsFCthlS0hpHwHzGULlvMj7ZhKB7YUbJW5+UxbnzVUhyZb/Xd0wUyrhIa13bAcyLNV5T+q7hunVtDYxt86USjeOYBkl+RQeA2Uq4YSqshsWormQcYH3lVENlS8GV1gCzpXCj3IBVYhbgSsfGmcg0N7GhsYRPS4D5OeHGvwwIiMFvI8fArKVp2ZKmXcK1cwGmlFj7rgEBDys36aiBMvcI15oCTGl3xg8NeYcunlzwNwNlSvg0BpgFNlgJh6q2OQbk28rbTtWGVqwgo/EeTZ0QsNIxMFcZKlfCpyHArCNYyceGhHzCMTCNyKvBp05G6sBpmFDXkJCId77gCJB/UV4aZOqkwedoRmeyBpX0XeVt42kzITb6bWVuuk7sGgGmlHxs8lwRbHXWlZsw27L10LzhhITLlbwtQFok4XMoo/HGGhtWGvJqsHXoTMvARNwYOTebDMsh4fNBRhMgOMsS5W21DExb5JECPXsApjTB2sISoW2b27RFnnOEa28BzHLhRktLhMaOyrakX8LpedkSWSR8ygGmNN3VyiJrWGaJHAhoHLFElvOFazsAppTe2NEiMB+2RI5HLdJJB+HaloymU2/Ph5zZQMh6+JNhGbAE4SkblMG4SGeSbc0UFRXtFwDFvGJbi77E6YbLf1CZmeqS6POq8rwvJij2V1if1LF3tghMpOWbSv3E0K3EIl1IuHyimwowtYm1FhF2fjRxxBSOhLJpnlVKIivNBlPKzO7FZ1zZQjhuY3bKZa41UGZQfwk8pAVeqz8Fk3eEelsIHHS0zDqLU2xukZqBlck2rX3poCoHdIDb9mzLBEkTrf0sAxMz7Feo5FeLHeG+aZdl9Zfw+BS3bDCfFR68QdlH+1NQMj4aGxf+Sng8J4G5TDPe7GhhpU44/v58+kvsWy/tXb+sEph8jqU0MB5qIZjHqxuYyjvUzk/YaOuAZJmg3wp/MJizzauTZR63zCqh/yHCrcXZ/zkJTLJOgOnPPGii5P2BaprZ9GgQ4+Dv1xdqwWSSAsrFlo05Gzj+/rBjS2kXy0qbPElg3i9cwxrOPhaB2SgFMOtYUtc+Sl5DO61KMKmpxcpcaYuSeyyyzsIUymhoiVXeI9wCPttysUyQtIsiDuseUI3ALLSgngNY77ngI4NJ1olcl+ell9DXUr8GzFSssr4GNOCyJmcwmcYJ15BOMsYwkPDq0kgFNX0sxxglp++M0/2BFkyyTuSG/k64NZ539DJF2Kk6jXHvXcpbTGvCKqHf8cIt4LEpNJhMozSOwQOGnCHMsf4gxbLGGnJ6HtA4YKOC/jYQTLJOTANJs+w9iUemXE8czoK9d9Jc1HSfSv8IyJGsXz8Bhz15g8mAjtaY9hQO/qZBvRnI01JWLKwEJ+SNTqPJJX221zg9m5R8Jls4MJlGaAbWS0iAJBXcgCuHaZ5mhvpotAQ4IS/Rk+lZj48pOfo0Ipd35AQmWSd2b5QW8eDgzgUJ9J/YYweHm2FOsdiUI+IjbHmODPvJcbcQrL/5Sj4IFXrfEBuYDChc5Y2age3PYqoUvNRvsfBIb2yu7CJYDU5jQmoq4qVnxvRe6G+gcH1jmKFgTscUZykbfeQflXe4daUhAwF+f54govkarryFtmcrdwjrTxDwnqW8ldShjymmumNqS8raf5+4O/GWRMDkwhH4lU4fwosGU2UWhnhXZ+4PkA5RT7lLFZv64iDTFaSDYznWv7/y1nzWFm7jZIRQy+xDg8lCDFfyOchIhOpPlVkR8LdwZJC98B0V80GiltCH7MiUkB7KAvSAAw6Waj7iETzWVImDycJMVvJpfgB0EFVkadaz+PIgPI6m6ue4FYYhDCkeUt5BPwez9HGd8rIE6mnGk6PzKSxvMFmoUiVnvh9jy0OTO4ijNher6kv/4OHNPHZ05mmaVuQEd8l7UBwFTAb0FfT7mts4rv50VUMVhJQc3awTTmL4qoqwBjSOZXu9lP5IiBogT6YgIHtTUxxpMW9kMEmAfcrbSmVtDVZ5EfR2Oelxb9QXRW5mfU3udGV+vtMlmkEgjvXp0Jxl+qwUgo2qwSgnGuUHMirFvtSdBJzFA973avASCZGdvqwnZTWYDCiCBj1UyscrOUCItXYn/SRyfnesfWZNPxpIM3myoip92WWZQj+KcejmagriZk8NRYl/0Ilbpu+rQxRkdDUCsoQzNcLoyF7L9Fkpvk5ssvj4KQ4i6tc8LJBOWabvC7xUebP2PSwGBcoJk+XwB+IfcWZGvnpxD8ws4RGoR46qyYVJR5iR6ZBP9h+8918Ql4adnHa2mdU0vauJMS7FjmCYLjJxWA2mogpDAgk55yovbwfyl5rWpXHL1HyZNytv6qyvhU0vtgrAXOQizcdpzDIrgRnlZQlQQ/7qsZU2cmdNbGqMzZVXMiPd8oCylGwH009Yg4E+FluOdVHJbNaIdY9rudnEzlfbXXGhXQPTT8hfRRY4dq7ChrotlXfqIFaJNWGHBs9gVh/ZD/vY0UF8FAcN4DTCcuXlwyILroyfcZL+J8AADxI/P7hyHu8AAAAASUVORK5CYII=' />","</div>","<div id='introduce-caption'>{{ translate('lblIntroduceRequest') }}</div>","<% if (fields.get('name').show()) {%>","<div class='field-wrapper'>","<input id='name' type='text' class='input-field' placeholder='{{ translate('lblIntroduceName') }}<% if (fields.get('name').required()) {%>*<% } %>' value='{{ cookie('client_name') }}'>","<div id='error-name' class='error-balloon'>{{ translate('ofl_enterName') }}</div>","</div>","<% } %>","<% if (fields.get('email').show()) {%>","<div class='field-wrapper'>","<input id='email' type='email' class='input-field' placeholder='{{ translate('lblYourEmail') }}<% if (fields.get('email').required()) {%>*<% } %>' value='{{ cookie('email') }}'>","<div id='error-email' class='error-balloon'>{{ translate('ofl_enterValidEmail') }}</div>","</div>","<% } %>","<% if (fields.get('phone').show()) {%>","<div class='field-wrapper'>","<input id='phone' type='tel' class='input-field' placeholder='{{ translate('lblYourPhone') }}<% if (fields.get('phone').required()) {%>*<% } %>' value='{{ cookie('phone') }}'>","<div id='error-phone' class='error-balloon'>{{ translate('ofl_enterValidPhone') }}</div>","</div>","<% } %>","<div class='message field-wrapper'>","<textarea id='message' class='input-field' placeholder='{{ translate('lblYourMessage') }}<% if (fields.get('message').required()) {%>*<% } %>' maxlength='{{ maxMessageLength }}'><% if (typeof valueInputField !== 'undefined') {%>{{ valueInputField }}<% } %></textarea>","<div id='error-message' class='error-balloon multiline'>{{ translate('ofl_enterMessage') }}</div>","</div>","<% if (departments) { %>","<div class='departments'>","<div id='current-department' class='input-field' data-id='{{ departments[0].id }}'>{{ departments[0].name }}</div>","<ul id='departments-list'>","<% _.each(departments, function(department) { %>","<li data-id='{{ department.id }}'>{{ department.name }}</li>","<% }) %>","</ul>","</div>","<% } %>","<div class='buttons'><div id='cancel-introduce' class='left-button'><a id='cancel' class='jivoBtn cancel' href='#'>{{ translate('lblEvaluateCancel') }}</a></div><div><input id='submit' type='button' value='{{ send }}' class='jivoBtn accept'></div></div>","</div>"].join("\n")),introducePopup:underscore.template(["<div id='introduce-popup' style='height: 0'>","<div id='introduce-popup-content'>","<% if (config.contacts_ask !== -1) {%><a id='cancel' href='#'></a><% } %>","<i class='icon-thx'></i>","<div class='text-field'>{{ translate('lblIntroduceRequest') }}:</div>","<% if (fields.get('name').show()) {%>","<div class='field-wrapper'>","<input id='name' type='text' class='input-field' placeholder='{{ translate('lblIntroduceName') }}<% if (fields.get('name').required()) {%>*<% } %>' value='{{ cookie('client_name') }}'>","<div id='error-name' class='error-balloon'>{{ translate('ofl_enterName') }}</div>","</div>","<% } %>","<% if (fields.get('email').show()) {%>","<div class='field-wrapper'>","<input id='email' type='email' class='input-field' placeholder='{{ translate('lblYourEmail') }}<% if (fields.get('email').required()) {%>*<% } %>' value='{{ cookie('email') }}'>","<div id='error-email' class='error-balloon'>{{ translate('ofl_enterValidEmail') }}</div>","</div>","<% } %>","<% if (fields.get('phone').show()) {%>","<div class='field-wrapper'>","<input id='phone' type='tel' class='input-field' placeholder='{{ translate('lblYourPhone') }}<% if (fields.get('phone').required()) {%>*<% } %>' value='{{ cookie('phone') }}'>","<div id='error-phone' class='error-balloon'>{{ translate('ofl_enterValidPhone') }}</div>","</div>","<% } %>","<div class='buttons'><input id='submit' type='button' value='{{ send }}' class='jivoBtn accept'></div>","</div>","</div>"].join("\n")),departments:underscore.template(["<div id='departments'<% if (nologo) {%> class='nologo'<% } %>>","<% _.each(departments, function(department) { %>","<a class='department' data-id='{{ department.id }}'>{{ department.name }}</a>","<% }) %>","</div>"].join("\n")),callButton:underscore.template("<div id='callme'><div></div></div>"),evaluation:underscore.template(["<div id='evaluation-popup'>","<div class='evaluation-text'>","<div class='evaluation-text-inner'>{{ translate('lblEvaluatePlease') }}</div>","</div>","<div class='evaluation-btn-container visible'>","<a href='#' class='button' id='positive'></a>","<a href='#' class='button' id='negative'></a>","<a href='#' class='cancel-icon' id='close-eval'></a>","</div>","<div class='evaluation-btn-container close-btn-container hidden'>","<a href='#' class='button' id='cancel'>{{ translate('lblEvaluateCancel') }}</a>","</div>","</div>"].join("\n"))},actionButton:underscore.template(["<div dir='ltr' id='jivo_action' style='display: none;' class='jivo-{{ mobile }}'>","<div id='jivo_close_button' data-action='close'></div>","</div>"].join("\n")),dragHandle:underscore.template(["<% if (jivo_config.chat_mode == 'online') { %>","<div id='jivo-mouse-tracker' style='display: none;'></div>","<div id='jivo-drag-handle' style='display: none;'></div>","<% } %>"].join("\n")),sound_player:underscore.template(["<source src='{{ mp3 }}' type='audio/mpeg'>","<source src='{{ ogg }}' type='audio/ogg; codecs=vorbis'>","<source src='{{ wav }}' type='audio/wav'>"].join("\n"))};machina.on("newfsm",function(e){e.on("handling",function(e){log(this.namespace+": handling "+e.inputType+" in state "+this.state)});e.on("nohandler",function(e){log(this.namespace+": unhandled "+e.inputType+" in state "+this.state)});e.on("transition",function(e){log([this.namespace+":","transition from:",e.fromState,"to:",e.toState,"action:",e.action].join(" "))})});var i=machina.Fsm.extend({_fireEvent:function(e){delete this._scheduled_events[e];this.handle(e)},_scheduleEvent:function(e,t){if(!(e in this._scheduled_events)){log(this.namespace+": scheduling "+e+" for "+t);this._scheduled_events[e]=setTimeout(underscore.bind(this._fireEvent,this,e),t)}else{log(this.namespace+": attempt to re-schedule event"+e)}},_cancelEvent:function(e){if(e in this._scheduled_events){clearTimeout(this._scheduled_events[e]);delete this._scheduled_events[e]}else{log(this.namespace+": attempt to cancel not scheduled event",e)}},constructor:function(){this._scheduled_events={};machina.Fsm.apply(this,arguments)}});(function(e){var t={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3};var i={1e3:"Normal Closure",1001:"Going away",1002:"Protocol error",1003:"Unsupported data",1004:"reserved",1005:null,1006:null,1007:"Invalid frame payload data",1008:"Policy violation",1009:"Message Too Big",1010:"Mandatory Ext.",1011:"Internal Error",1012:"Service Restart",1013:"Try Again Later",1014:"Unassigned",1015:"TLS handshake",3001:"Attempts have Ended",3333:"Spam detected"};var n=1e4;var o=2e4;var s=20;var a=2;var r=60;var l=0;var c=1e3;var u=function(){};var d=function(){throw new Error("Not implemented")};var f=function(){return(new Date).getTime()};var h=function(e,t){this.name="NetworkError";this.code=t<<0;this.message=String(e)};h.prototype.toString=function(){return this.name+":"+(this.code<<0||"")+" "+this.message};var p=function(e,t,i){if(e&&"function"===typeof e[t]){try{e[t](i)}catch(n){if("onerror"===String(t)){throw n}else{try{arguments.callee(e,"onerror",n)}catch(n){}}}}};var g={};var m;if(window&&("function"===typeof window.WebSocket||"object"===typeof window.WebSocket)){var v=window.WebSocket;m=function(e,i){var n,o=this,a;this.url=e;this.readyState=t.CONNECTING;this.close=function(e,i){if(this.readyState===t.CONNECTING){this.readyState=t.CLOSING;clearTimeout(a);a=setTimeout(function(){o.readyState=t.CLOSED;p(o,"onclose",{wasClean:false,code:1006,reason:""})},s)}else if(this.readyState===t.OPEN){this.readyState=t.CLOSING;try{if(i){n.close(e,i)}else if(e){n.close(e)}else{n.close(1e3)}}catch(r){p(o,"onerror",r);p(o,"onclose",{wasClean:false,code:1006,reason:""})}}};this.send=function(e){if(!n||n.OPEN!==n.readyState){throw new Error("Socket is not open")}n.send(e)};a=setTimeout(function(){try{if(i){n=new v(e,i)}else{n=new v(e)}n.onclose=function(e){clearTimeout(a);o.readyState=t.CLOSED;p(o,"onclose",e)};n.onerror=function(e){if(!e.name&&!e.message){e.name="WebSocketError";e.message="Unknown"}p(o,"onerror",e)};n.onmessage=function(e){p(o,"onmessage",e)};n.onopen=function(e){o.readyState=t.OPEN;o.protocol=n.protocol;p(o,"onopen",e)}}catch(s){p(o,"onerror",s)}},s)};for(var _ in t){m.prototype[_]=t[_]}}if(window&&window.navigator){if(/iP(hone|od|ad)/.test(window.navigator.platform)){var w=/OS (\d+)_(\d+)_?(\d+)?/.exec(window.navigator.appVersion);if(w&&6>w[1]){m=d}}if(/apple/i.test(window.navigator.vendor)){var w=/\bVersion\/(\d+)\./.exec(window.navigator.userAgent);if(w&&6>w[1]){m=d}}}g["ws"]=g["wss"]=m;var b=function(){var e=window.document.getElementsByTagName("head")[0];var t,i,n,o,s=this;this.withCredentials=false;this.readyState=0;this.responseText="";this.status=0;this.statusText="";this.timeout=void 0;var a=function(){if(!t){return}clearTimeout(o);t.onreadystatechange=u;t.onload=u;t.onerror=u;t.parentNode.removeChild(t);t=null;i=null;n=null;s.responseText="";s.status=0;s.statusText="";s.timeout=void 0;s.withCredentials=false;try{delete window[n]}catch(e){window[n]=void 0}p(s,"onloadend")};var r=function(){if(!t){return}p(s,"onerror");a()};this.open=function(e,t){if(i||!t){return}s.readyState=1;i=String(t).replace(/#.*$/,"");n="_jivo"+b._count++;i+=(-1===i.indexOf("?")?"?":"&")+"cb="+n};this.send=function(l){if(!i){return}l=l?"&msg="+encodeURIComponent(l):"";window[n]=function(e){s.readyState=4;if(b._statusBody.test(e)){s.status=b._statusBody.exec(e)[1]<<0;s.statusText="";s.responseText="";p(s,"onerror");a()}else{s.status=200;s.statusText="OK";s.responseText=e;p(s,"onload");a()}};t=document.createElement("script");t.charset="utf-8";t.type="text/javascript";t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){setTimeout(r,0)}};if(!t.readyState){t.onload=t.onerror=r}t.src=i+l;e.appendChild(t);s.timeout<<=0;if(0<s.timeout){o=setTimeout(function(){p(s,"ontimeout");a()},s.timeout)}};this.abort=function(){p(s,"onabort");a()};this.setRequestHeader=u};b._statusBody=/^(\d{3})\n$/m;b._count=0;b.prototype={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};var y=3e3;var x=function(){if(x._stack.length){return x._stack.pop()}var e;try{e=new XMLHttpRequest;if(!("withCredentials"in e)){e=null}}catch(t){}e=e||new b;e.release=function(){x._stack.push(e)};return e};x._stack=[];var j=function(e){var t,i,n,o=y,s=u;for(var a=1;a<arguments.length;a++){if(arguments[a]){switch(typeof arguments[a]){case"object":i=arguments[a];break;case"string":n=arguments[a];break;case"number":o=arguments[a];break;case"function":s=arguments[a];break;default:break}}}if("string"!==typeof e){s(TypeError("Bad URL"));return null}try{t=x();t.open(n?"POST":"GET",e,true);if(n){t.setRequestHeader("Content-Type","text/plain")}}catch(r){s(r);t.release();return null}o<<=0;if(0<o){try{t.timeout=o}catch(r){}}t.onloadend=function(){t.release()};t.onload=function(){if(200===t.status){s(null,t.responseText)}else{s(new h(t.statusText,t.status))}};t.onabort=function(){s(new h("Aborted"))};t.ontimeout=function(){s(new h("Timeout"))};t.onerror=function(){s(new h("Unknown"))};if(i){for(var a in i){t.setRequestHeader(a,i[a])}}try{t.send(n||null)}catch(r){s(r);t.release();return null}return function(){s=u}};e.request=j;var C=2e4;var E=/([^\n]*)\n/gm;var k=function(e){if("string"!==typeof e){return e}var t={},i,n;E.lastIndex=0;while(null!==(i=E.exec(e))){if(!i[1]){t.message=e.substring(i.index+1);break}i=i[1].split(/\t/);n=i[0];if(n){i.shift();t[n]=i}}return t};var T=function(e,n){if(/[^\/]$/.test(e)){e+="/"}var o=this,a=u,r="open",l,c,d=C,h=0,g,m;this.readyState=t.CONNECTING;var v=function(e,n,s){if(t.CLOSED===o.readyState){return}clearTimeout(g);o.readyState=t.CLOSED;p(o,"onclose",{wasClean:!!s,code:n||1006,reason:i[n]||e||""})};var _=function(t,i){a();a=j(e+r+(t?"/"+t:"")+"?"+f(),d,i,w)};var w=function(e,i){var n=k(i);switch(o.readyState){case t.CONNECTING:if(e){p(o,"onerror",e);v("Open error");break}else if(n&&n.open&&n.open[0]){r=n.open[0];o.protocol=n.open[1];o.readyState=t.OPEN;p(o,"onopen")}else{v("No response in state open");break}case t.OPEN:var s="";if(n){if(n.timeout&&0<n.timeout[0]){d=Math.ceil(n.timeout[0])}if(n.etag&&n.etag[0]){var a=n.etag[0]<<0;var u=a-h;if(0<u){if(1!==u){p(o,"onerror",new Error("Missing "+u+" etags"))}if(n.message){p(o,"onmessage",{data:n.message})}}h=a;s="etag/"+a}if(n.close){o.readyState=t.CLOSING;s="close/"+(n.close[0]||"")+"/"+(n.close[1]||"")}}else if(e){if(204===e.status){break}p(o,"onerror",e);if(!e.status){v();return}}_(s);break;case t.CLOSING:if(n&&n.close){var f=n.close[0]<<0;v(n.close[1],f,!l||l===f)}else{v(c,l,false)}break;case t.CLOSED:default:break}};this.close=function(e,i){if(t.CONNECTING===this.readyState){clearTimeout(m);a();g=setTimeout(v,s)}else if(t.OPEN===this.readyState){l=e<<0||1e3;c=i||"";this.readyState=t.CLOSING;_("close/"+l+"/"+c)}};this.send=function(e){if(t.OPEN!==this.readyState){throw new Error("Socket is not open")}if(e&&"string"===typeof e){_("send",e)}else{throw new TypeError("Bad data type")}};var b=[];if(n){if("string"===typeof n){b.push(n)}else if(n instanceof Array){for(var y=0;y<n.length;y++){b.push(String(n[y]))}}}m=setTimeout(function(){_(b.join("/"))},s)};for(var _ in t){T.prototype[_]=t[_]}g["http"]=g["https"]=T;var S=/^\s*(?:([^\;\/\?\:\@\&\=\+\$\,\#\n\r\s]{1,8})\:\/\/)([^\s\n\r]+)\s*$/;var I=function(e,t){if(!t){t=[];t.index=0;t.add=function(e){t.unshift({value:String(e),health:l});t.index=0}}if(e){if("string"===typeof e||e instanceof String){t.push({value:String(e),health:l})}else if(0<e.length){for(var i=0;i<e.length;i++){arguments.callee(e[i],t)}}}return t};var M=function(e){if("string"!==typeof e){throw new TypeError("Bad URL type")}var t=S.exec(e);if(null===t){throw new Error("Bad URL")}else if(!g[t[1]]){throw new Error("Not supported URL scheme: "+t[1])}return new g[t[1]](e)};var N=function(e,t,i){var n=e[t]=i;return function(i){if(arguments.length){n=e[t]=i}return n}};var A=function(e,t){var i=1e3,n;var o=function(){if(e&&0<=e.health){t(++e.health);i<<=1;n=setTimeout(o,i)}};n=setTimeout(o,i);return function(){clearTimeout(n)}};var O=function(){var e=0;setInterval(function(){if(0<e){e-=a;if(!(0<=e)){e=0}}},1e3);return function(){return r<++e}}();var D=function(e){var s=I(e);var a=null;var r=this;var d=u;var f={connecting:u,open:u,close:u,error:u,message:u};var h=N(this,"state",t.CLOSED);var p=N(this,"url",void 0);var g=N(this,"health",void 0);var m=function(e,t){clearTimeout(m.value);if(e){m.value=setTimeout(e,t)}};var v=function(e){d();d=u;m();h(t.CLOSED);try{f.close(e)}catch(i){b(i)}p(void 0);g(void 0)};var _=function(){if(O()){d();d=u;if(a){a.onclose=null;a.onerror=null;a.onmessage=null;a.onopen=null;a.close(3333);a=null;for(var e=0;e<s.lenght;e++){s[e].health=-1}}return true}return false};var w=function(e){d();d=u;m();if(!e){e={wasClean:false,code:1005,reason:"No Status Rcvd"}}if(!e.wasClean){g(--s[s.index].health)}if(1012===e.code){h(t.CONNECTING);try{f.connecting(s[s.index].health)}finally{return m(C,n+(Math.random()*o<<0))}}else if(1005===e.code||1e3===e.code||4e3<=e.code&&5e3>e.code){v(e)}else{C()}};var b=function(e){try{f.error(e)}catch(t){throw t}};var y=function(e){try{f.message(e.data)}catch(t){b(t)}};var x=function(){m();h(t.OPEN);d=A(s[s.index],g);try{f.open()}catch(e){b(e)}};var j=function(){var e=s[s.index];try{a=M(e.value)}catch(t){e.health=-1;++s.index;b(t);return C()}a.onclose=w;a.onerror=b;a.onmessage=y;a.onopen=x};var C=function(e){m();if(s.index>=s.length){p(void 0);g(void 0);v({wasClean:false,code:3001,reason:i[3001]})}else if(0>s[s.index].health){b(new Error("Sick URL"));++s.index;C()}else{if(a){a.onclose=null;a.onerror=null;a.onmessage=null;a.onopen=null;try{a.close()}catch(n){}}h(t.CONNECTING);var o=s[s.index];if(p()!==o.value){p(o.value);g(o.health)}try{f.connecting(o.health)}catch(n){}if(e||l===s[s.index].health){j()}else{m(j,c)}}};this.open=function(e){if(_()){return v({wasClean:false,code:3333,reason:i[3333]})}if(t.CONNECTING===h()||t.OPEN===h()){return}if(e){e=String(e);for(var n=0;n<s.length;n++){if(e===s[n].value){s.index=n;return C(true)}}s.add(e)}C(true)};this.close=function(e,n){m();if(t.CLOSING!==h()&&t.CLOSED!==h()){if(a&&(a.CONNECTING===a.readyState||a.OPEN===a.readyState)){e<<=0;if(4e3>e||5e3<=e){a.close()}else if(n){a.close(e,String(n))}else{a.close(e)}a.onclose=v;h(t.CLOSING)}else{v({wasClean:false,code:1011,reason:i[1011]})}}};this.send=function(e){if(t.OPEN!==h()){return new Error("Connection is not open")}if(_()){v({wasClean:false,code:3333,reason:i[3333]});return new Error("Spam detected")}try{a.send(e)}catch(n){return n}return null};var E=function(e,t){return function(){t.apply(e,arguments)}};this.on=function(e,t){if(e&&"object"===typeof e){for(var i in e){this.on(i,E(e,e[i]))}}else if(f[e]&&"function"===typeof t){f[e]=t}};this.off=function(){for(var e in f){f[e]=u}};this.getHealthyURLs=function(){var e=[];for(var t=0;t<s.length;t++){if(0<=s[t].health){e.push(s[t])}}e.sort(function(e,t){return t.health-e.health});for(var t=0;t<e.length;t++){e[t]=e[t].value}return e}};D.prototype={valueOf:function(){return this.toString()},toString:function(){return t.OPEN===this.state()?this.url:""},toJSON:function(e){switch(e){case"url":return'"'+this.url+'"';case"state":return this.state;case"health":return this.health;default:break}if(!arguments.length){return'{"state":'+this.state+', "health":'+this.health+', "url":"'+this.url+'"}'}return""}};for(var _ in t){D.prototype[_]=t[_]}e.Connection=D})(utils);var n=new i({namespace:"CONMANAGER",msg_buf:[],jconnection:null,send:function(e){log("SEND: ",e);this.handle("send",e)},sendIfConnected:function(e){if(this.isConnected()){log("SEND IF CONNECTION: ",e);this.handle("send",e)}},resume:function(){this.handle("resume")},setupConnection:function(){if(this.jconnection){return}var e=[];if("production"=="production"){e.unshift("https://"+config.comet.host+"/cometcn");if(!cookie("use_lp")){if(!ie){e.unshift("wss://"+config.comet.host+"/cometcn")}}}else{e.unshift("http://"+config.comet.host+"/cometcn");if(!cookie("use_lp")){if(!ie){e.unshift("ws://"+config.comet.host+"/cometcn")}}}log("CONNECTION: url",e);this.jconnection=new utils.Connection(e);this.jconnection.on("connecting",underscore.bind(this.handle,this,"socket_connecting"));this.jconnection.on("open",underscore.bind(this.handle,this,"socket_connect"));this.jconnection.on("close",underscore.bind(this.handle,this,"socket_disconnect"));this.jconnection.on("error",function(e){log("CONNECTION: error",e.name+": "+e.message)});this.jconnection.on("message",function(e){var t;try{t=JSON.parse(e)}catch(i){return log("ERROR parse error",i)}if(!t||"object"!==typeof t){return log("ERROR bad message")}n.handle("socket_message",t)});this.jconnection.open()},_sendSocketEvent:function(e){var t;try{t=JSON.stringify(e)}catch(i){return log("ERROR stringify error",i)}if(typeof e=="object"){if("name"in e){log("Sending "+e.name);var n=this.jconnection.send(t);if(n){log("ERROR send error",n)}}else{log("ERROR Attempt to send event without name")}}else{log("ERROR Socket event must be object")}},_bufferMessage:function(e){this.msg_buf.push(e)},_flushMessageBuffer:function(){var e;while(e=this.msg_buf.shift()){this._sendSocketEvent(e)}},isConnected:function(){return this.state==="CONNECTED"},setCustomData:function(e){if(this.isConnected()){this.send({name:"update_custom_data",custom_data:e})}else{this.custom_data=e}},setUserToken:function(e){if(this.isConnected()){this.send({name:"update_user_token",user_token:e})}else{this.user_token=e}},createClientModel:function(){if(!this.clientModel){this.clientModel={chat_opened:cookie("gui_state")==="CHAT",page_visible:d.pageVisible()}}},updateClient:function(e){var t={name:"update_client",jv_sess_id:cookie("sess_id")};this.createClientModel();var i=underscore.clone(this.clientModel);underscore.extend(this.clientModel,e);if(!underscore.isEqual(this.clientModel,i)){underscore.extend(t,e);this.sendIfConnected(t)}},requestTelemetry:function(e){var t=this.jconnection,i={};if(t){i.state=t.state;i.url=t.url;i.health=t.health}telemetry(e,i)},states:{uninitialized:{_onEnter:function(){if(this.jconnection){this.jconnection.off();this.jconnection.close();this.jconnection=null}},send:function(e){this._bufferMessage(e);this.transition("CONNECTING")},resume:function(){this.transition("CONNECTING")},startup:function(){cookie("sess_id",null);this.transition("CONNECTING")}},CONNECTING:{_onEnter:function(){this.setupConnection()},socket_connect:function(){if(this.jconnection.url.indexOf("http")==0){cookie("use_lp",1)}if(cookie("sess_id")){this.transition("RESUMING")}else{this.transition("STARTING_UP")}},send:function(e){this._bufferMessage(e)},socket_disconnect:function(){this.requestTelemetry("Disconnected while connecting");this.transition("uninitialized")},socket_connecting:function(){}},STARTING_UP:{_onEnter:function(){this.createClientModel();var e={name:"startup",jv_widget_id:config.widget_id,site_id:config.site_id,current_page:d.getCurrentPage(),is_mobile:d.isMobile(),visits_count:cookie("visits_count")-0};e=underscore.extend(e,this.clientModel);if(cookie("client_id")){e.jv_client_id=cookie("client_id");log("CONNECTION: restored client #"+e.jv_client_id)}if(cookie("__utmz")){e.g_utmz=cookie("__utmz")}if(cookie("agent_info")){e.pa_id=cookie("agent_info").split("$$")[0];log("CONNECTION: restored agent #"+e.pa_id)}if(cookie("client_name")){e.client_name=cookie("client_name");log("CONNECTION: restored client name="+e.client_name)}if(cookie("email")){e.email=cookie("email");log("CONNECTION: restored client email="+e.email)}if(cookie("phone")){e.phone=cookie("phone");log("CONNECTION: restored client phone="+e.phone)}if(cookie("refer")){e.refer=cookie("refer");if(cookie("utm")){e.utm=cookie("utm")}}if(d.invitationText){e.proactive_rule={invitation_text:d.invitationText,agent_info:d.agentInfo}}if(this.custom_data){e.custom_data=this.custom_data}if(this.user_token){e.user_token=this.user_token}this._sendSocketEvent(e);this._scheduleEvent("startup_timeout",3e3)},startup_timeout:function(){this.requestTelemetry("Startup Timeout")},send:function(e){this._bufferMessage(e)},socket_message:function(e){if(e.name==="startup_ok"){this._cancelEvent("startup_timeout");cookie("sess_id",e.jv_sess_id,{expires:1,path:"/"});cookie("client_id",e.jv_client_id,{expires:365,path:"/"});this.transition("CONNECTED")}else if(e.name==="startup_error"){d.handle("force_offline",e);this.transition("DISCONNECTING")}}},RESUMING:{_onEnter:function(){this.createClientModel();this._sendSocketEvent(underscore.extend({name:"resume",jv_sess_id:cookie("sess_id"),jv_widget_id:config.widget_id,site_id:config.site_id,visits_count:cookie("visits_count")-0,separate_window:d.isSeparateWindow(),current_page:d.getCurrentPage()},this.clientModel));this._scheduleEvent("resume_timeout",3e3)},socket_message:function(e){this._cancelEvent("resume_timeout");if(e.name=="resume_ok"){d.handle(e.name,e);this.transition("CONNECTED")}else{d.handle("resume_failed");this.transition("STARTING_UP")}},resume_timeout:function(){this.requestTelemetry("Resume Timeout")}},CONNECTED:{_onEnter:function(){d.handle("startup_ok");this._flushMessageBuffer()},socket_message:function(e){switch(e.name){case"agent_chat_close":if(!d.isVisitorsInsight()){this.transition("DISCONNECTING")}break;case"force_offline":this.transition("DISCONNECTING");break;case"blacklist":cookie("client_id","z"+cookie("client_id"));this.transition("DISCONNECTING");break;case"cw_call_end":case"cw_error":if(d.state=="OFFLINE"){this.transition("DISCONNECTING")}break;case"accept":case"transferred":cookie("agent_info",[e.agent_info.agent_id].join("$$"));break;case"offline_ack":if(!("cap_id"in e)){this.transition("DISCONNECTING")}break}d.handle(e.name,e)},send:function(e){this._sendSocketEvent(e)},socket_disconnect:function(e){log("CONNECTION: close",e.wasClean,e.code,e.reason);if(e.code==1e3){d.handle("reopened_elsewhere")}this.transition("uninitialized")},startup:function(){d.handle("startup_ok")},socket_connecting:function(){setTimeout(underscore.bind(function(){this.requestTelemetry("JC reconnect")},this),2e3);this.transition("CONNECTING")}},DISCONNECTING:{_onEnter:function(){cookie("sess_id",null);this.jconnection.close()},socket_disconnect:function(e){this.transition("uninitialized")}}}});var o={inited:false,initialize:function(){if(this.inited)return;this.initScroll();this.initClose();this.inited=true},initScroll:function(){window.parent.onscroll=underscore.throttle(underscore.bind(this._scroll,this),150)},initClose:function(){this.last_position={};window.parent.onmousemove=underscore.throttle(underscore.bind(this._mouse,this),150)},_mouse:function(e){if(typeof this.last_position.x!=="undefined"){var t=this.last_position.x-e.clientX,i=this.last_position.y-e.clientY;if(Math.abs(t)>Math.abs(i)&&t>0){}else if(Math.abs(t)>Math.abs(i)&&t<0){}else if(Math.abs(i)>Math.abs(t)&&i>0){if(e.clientY<30){d.handle("move_close_button")}}else if(Math.abs(i)>Math.abs(t)&&i<0){}}this.last_position={x:e.clientX,y:e.clientY}},_scroll:function(e){var t=(window.parent.document.documentElement.scrollTop+window.parent.document.body.scrollTop)/(window.parent.document.documentElement.scrollHeight-window.parent.document.documentElement.clientHeight)*100;d.handle("move_scroll",Math.round(t))}};var s=i.extend({initialize:function(){this.namespace="RULE#"+this.name.replace(" ","_");this.initialState="unreachable";var e=[],t=false,i,n=this.commands[0];if(cookie(n.command+"_onceADay")){return}while(i=this.conditions.pop()){if(this.isGoalCondition(i)){o.initialize()}if(this.isTimeCondition(i)||this.isGoalCondition(i)){e.push(i)}else{if(i.condition==="page_url"){i.value=i.value.replace("http://","").replace("https://","")}else if(i.condition=="ab_test_group"){if(!cookie("ab_test_group")){var s=Math.round(Math.random());var a=i.group_name?i.group_name:"JivoSite A/B Group";cookie("ab_test_group",s?"group_a":"group_b");h.setABTestGroupContacts(a,s?"Group A":"Group B")}}if(this.checkCondition(i)){t=true}else{if(this.type==="all"){return}}}}if(e.length>0){this.conditions=e;if(this.checkTimeConditions()){this.initialState="triggered"}else{this.initialState="time_wait"}return}if(t){this.initialState="triggered"}},checkTimeConditions:function(){var e=false;for(var t=0;t<this.conditions.length;t++){if(this.checkCondition(this.conditions[t])){e=true}else{if(this.type==="all"){return false}}}return e},isTimeCondition:function(e){return e.condition.indexOf("time")>=0},isGoalCondition:function(e){return e.condition=="goal_close"||e.condition=="goal_scroll"},checkCondition:function(e){var t=this.getValue(e.condition);var i=this.compare(t,e.value,e.comparator);if(!i){log(this.namespace+": failed condition "+e.condition+"; expected="+e.value+"; actual="+t)}return i},getValue:function(e){switch(e){case"online":return config.chat_mode==="online";case"page_url":return d.getPageWindow().location.href.replace("http://","").replace("https://","");case"hour":return(new Date).getHours();case"page_title":return d.getPageWindow().document.title;case"week_day":return(new Date).getDay();case"time_after_close":var t=cookie("close_time");return t===null?Number.MAX_VALUE:this.timeDiff(t);case"time_after_first_message":return a.firstMessageTime!==null?this.timeDiff(a.firstMessageTime.getTime()):NaN;case"time_after_invitation":var i=cookie("invitation_time");return i===null||i===""?Number.MAX_VALUE:this.timeDiff(i);case"time_on_page":return this.timeDiff(a.pageEnterTime);case"time_on_site":return this.timeDiff(cookie("enter_ts"));case"number_of_visits":return cookie("visits_count");case"goal_close":return a.movedToCloseButton;case"goal_scroll":return a.scrollPosition;default:return cookie(e)}},timeDiff:function(e){return Math.round(((new Date).getTime()-e)/1e3)},compare:function(e,t,i){switch(i){case"contain":return e.toLowerCase().indexOf(t.toLowerCase())!=-1;case"greater":return e>t;case"greater_equal":return e>=t;case"lower":return e<t;case"lower_equal":return e<=t;case"not_contain":return e.toLowerCase().indexOf(t.toLowerCase())===-1;case"not_equal":return t!=e;case"regexp":return new RegExp(e,"i").test(t);default:return t==e}},states:{time_wait:{_onEnter:function(){this._scheduleEvent("tick",1e3)},tick:function(){if(this.checkTimeConditions()){this.transition("triggered")}else{this._scheduleEvent("tick",1e3)}},cancel:"unreachable"},unreachable:{},triggered:{_onEnter:function(){var e=this.commands[0],t;if(typeof e.params==="object"&&e.params.onceADay){t=e.command+"_onceADay"}if(underscore.indexOf(["uninitialized","WIDGET"],d.gui.state)===-1&&underscore.indexOf(["proactive","open_offline","show_callform"],e.command)!==-1){return}switch(e.command){case"proactive":a.showProactive(e.params.message,e.params.department,this.name,t);break;case"open_offline":if(config.chat_mode==="online"){return}cookie("invitation_time",(new Date).getTime());if(t){a.addOnceADayCookie(t)}if(e.params){if(e.params.title){config.offline_form_title=e.params.title;chat_view_offline.instance.models.form.set("templateData.header",e.params.title)}if(e.params.message){config.offline_form_text=e.params.message;chat_view_offline.instance.models.form.set("templateData.text",e.params.message)}}setTimeout(function(){if(!d.isMobileOrTablet()){d.handle("gui_maximize");d.soundPlayer.incomingMessage()}else{d.gui.incrementCounter()}},0);break;case"hide":d.handle("hide");break;case"system_message":d.handle("system_message",{message:e.params.message});break;case"show_callform":log(this.namespace+"rule triggered: show_callform",e);a.showCallForm(e.params.title,t);break}}}}});var a=new i({initialState:false,isInited:false,namespace:"ruleManager",scrollPosition:false,movedToCloseButton:false,init:function(){this.rules=[];underscore.defaults(config,{rules:[]});this.pageEnterTime=(new Date).getTime();if(!cookie("pages_count")){cookie("pages_count",1)}else{cookie("pages_count",parseInt(cookie("pages_count"))+1)}d.on("handling",underscore.bind(this.onJivoHandling,this));if(config.rules.length==0&&underscore.isArray(config.proactive_rules)&&config.proactive_rules.length>0){this.importLegacy();this.transition("ready");return}if(this.needGeo()){log("RULE MANAGER NEED GEO");this.transition("fetch_geo");return}this.isInited=true;log("RULE MANAGER READY");this.transition("ready")},needGeo:function(){var e,t;for(var i=0;i<config.rules.length;i++){e=config.rules[i];for(var n=0;n<e.conditions.length;n++){t=e.conditions[n];if(t.condition=="country"||t.condition=="city"){if(cookie("country")==null){return true}}}}return false},states:{fetch_geo:{_onEnter:function(){getJSONP(config.base_url+"/script/geo?cb=?",underscore.bind(this.handle,this,"geo_data"))},geo_data:function(e){log("RULE MANAGER GEO DATA",e);cookie("country",e.country,{expires:1});cookie("city",e.city,{expires:1});this.transition("ready")}},ready:{_onEnter:function(){for(var e=0;e<config.rules.length;e++){this.rules.push(new s(config.rules[e]))}log(this.namespace+": rules count="+this.rules.length+"; wait count="+underscore.where(this.rules,{state:"time_wait"}).length);this.emit("ready")}}},firstMessageTime:null,canInvite:true,importLegacy:function(){log(this.namespace+": importing from proactive_rules");var e;var t=["contain","equal","regexp"];for(var i=0;i<config.proactive_rules.length;i++){e=config.proactive_rules[i];underscore.defaults(e,{name:e.invitationText,urlPrefix:[{url:"/",mm:0}],page_timeout:20,close_timeout:300,enter_timeout:0,pages_count:0});for(var n=0;n<e.urlPrefix.length;n++){config.rules.push({legacyId:e.id,name:e.name,type:"all",conditions:[{condition:"online",value:true},{condition:"time_on_page",comparator:"greater_equal",value:e.page_timeout},{condition:"time_after_close",comparator:"greater_equal",value:e.close_timeout},{condition:"time_on_site",comparator:"greater_equal",value:e.enter_timeout},{condition:"pages_count",comparator:"greater_equal",value:e.pages_count},{condition:"page_url",comparator:t[e.urlPrefix[n].mm],value:e.urlPrefix[n].url}],commands:[{command:"proactive",params:{message:e.invitationText}}]})}}},onJivoHandling:function(e){switch(e.inputType){case"gui_minimize":cookie("close_time",(new Date).getTime());break;case"gui_message":if(!this.firstMessageTime){this.firstMessageTime=new Date}this.cancelRule("proactive");this.cancelRule("show_callform");break;case"accept":this.allRulesCancel();break;case"invitation":cookie("invitation_time",(new Date).getTime());break;case"callback_invitation":cookie("invitation_time",(new Date).getTime());break;case"move_close_button":underscore.each(this.rules,function(e){this.movedToCloseButton=true;e.handle("tick")},this);break;case"move_scroll":underscore.each(this.rules,function(t){this.scrollPosition=e.args;t.handle("tick")},this);break;case"api_open":if(e.args&&typeof e.args[0]==="object"&&e.args[0].start==="call"){this.allRulesCancel()}break;break}},cancelRule:function(e){log(this.namespace+": cancel "+e);for(var t=0;t<this.rules.length;t+=1){if(this.rules[t].state==="time_wait"&&this.rules[t].commands[0].command===e){this.rules[t].handle("cancel")}}if(e==="proactive"){this.canInvite=false}},allRulesCancel:function(){for(var e=0;e<this.rules.length;e++){if(this.rules[e].state==="time_wait"){this.rules[e].handle("cancel")}}},restoreAgentInfo:function(){var e=cookie("agent_info");if(e){var t=e.split("$$");return{agent_id:t[0]}}return false},addOnceADayCookie:function(e){cookie(e,1,{expires:1,path:"/"})},showProactive:function(e,t,i,n){if(!this.canInvite){return}if(typeof e=="number"){var o=parseInt(e),s=false;if(o){for(var a=0;a<this.rules.length;a++){if(this.rules[a].commands[0].command=="proactive"){if(this.rules[a].legacyId==o){e=this.rules[a].commands[0].params.message;log(this.namespace+": legacy rule found by ID="+o+"; message="+e);s=true;break}}}if(!s){log(this.namespace+": legacy rule not found by ID="+o);return}}}var r=this.restoreAgentInfo();var l={name:"active_agent"};if(t&&config.departments&&underscore.findWhere(config.departments,{id:t})){l.department=t}if(r){l.agent_id=r.agent_id}if(cookie("client_id")){l.jv_client_id=cookie("client_id")}getJSONPWithData(chatServerUrl(config.widget_id,config.site_id),l,underscore.bind(function(t){if(underscore.indexOf(["uninitialized","WIDGET"],d.gui.state)!==-1){if(t){d.handle("invitation",{name:i,invitationText:e},t);if(n){this.addOnceADayCookie(n)}}else{log("JIVO: invitation failed, no agent")}}},this))},showCallForm:function(e,t){callWidgetPing(underscore.bind(function(i){if(i.show_form&&underscore.indexOf(["uninitialized","WIDGET"],d.gui.state)!==-1){log("showCallForm title:"+e);d.handle("callback_invitation",{title:e});d.soundPlayer.incomingMessage();if(t){this.addOnceADayCookie(t)}}},this))}});var r=i.extend({namespace:"WIDGET",fade:false,position:{},initialState:"HIDDEN",initialize:function(){this._templateData={orientation:config.widget_orientation,height:config.widget_height,style:config.style_string,text:config.chat_mode=="online"?config.online_widget_label:config.offline_widget_label,type:config.widget_font_color,locale:getIconLocale()};this._widgetDiv=document.createElement("div");this._widgetDiv.onclick=underscore.bind(this.handle,this,"click");this._widgetContainer=window.parent.document.getElementById("jivo-iframe-container");addClass(this._widgetContainer,"jivo-iframe-container-"+config.widget_orientation);log(this._widgetDiv,t,config.widget_orientation,this._templateData);this._widgetDiv.setAttribute("id","jivo_chat_widget");this._widgetDiv.innerHTML=t.label[config.widget_orientation](this._templateData);this.topWrap.appendChild(this._widgetDiv);this._label=document.getElementById("jivo-label");this.widgetWidth=null;this.widgetHeight=null;this.setColor();this.setFontStyle();this.setPosition()},isCustomLabel:function(){var e=parent.document.getElementById("jivo_custom_widget");if(e){return true}},isCustom:function(){var e=this._widgetDiv.currentStyle?this._widgetDiv.currentStyle.display:getComputedStyle(this._widgetDiv,null).display;return e==="none"},states:{VISIBLE:{_onEnter:function(){log(this.namespace,"WIDGET VISIBLE",this.fade);removeClass(this._widgetContainer,"jivo-expanded");addClass(this._widgetContainer,"jivo-no-transition");var e=config.widget_orientation,t=this._widgetContainer.style;if(d.isMobile()){e="bottom"}switch(e){case"left":t.marginLeft="0";t.left="0";t.marginBottom=this.widgetMarginBottom;if(config.widget_padding=="0"){t.bottom="100%"}else if(config.widget_padding=="50"){t.bottom="50%"}else if(config.widget_padding=="100"){t.bottom="10px"}t.height=this.widgetHeight;break;case"right":t.marginRight="0";t.left="auto";t.right="0";t.marginBottom=this.widgetMarginBottom;if(config.widget_padding=="0"){t.bottom="100%"}else if(config.widget_padding=="50"){t.bottom="50%"}else if(config.widget_padding=="100"){t.bottom="10px"}t.height=this.widgetHeight;break;case"top":t.top="0";t.bottom="100%";if(config.widget_padding=="0"){t.right="";t.left="30px"}else if(config.widget_padding=="50"){t.left="";t.marginRight=this.widgetWidth/2*-1+"px";t.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){t.left="";t.right="30px"}t.width=this.widgetWidth;break;case"bottom":if(config.widget_padding=="0"){t.right="";t.left="30px"}else if(config.widget_padding=="50"){t.left="";t.marginRight=this.widgetWidth/2*-1+"px";t.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){t.left="";t.right="30px"}t.width=this.widgetWidth;break}if(d.isMobile()){t.marginLeft="0";t.left="0";t.marginBottom="0";t.right="auto"}d.transferProportion({width:document.getElementById("jivo-label").offsetWidth,height:config.widget_height-0});if(this.isCustomLabel()){addClass(this._widgetContainer,"jivo-custom-label");d.gui.jivoframecontainer.element.style.visibility="hidden"}else{this._label.style.display="block";this._label.style.visibility="visible";if(!this._hideLabelForCallWidget){this._label.style.visibility="visible"}if(this.fade){}removeClass(this._widgetContainer,"jivo-no-transition");if(!d.isMobile()&&config.style_string){setTimeout(underscore.bind(function(){addClass(this._widgetContainer,config.style_string)},this),300)}}},click:function(){log("widget visible click",d.isMobileOrTablet());d.isClicked=true;d.handle("gui_maximize")},hide:"HIDDEN"},HIDDEN:{_onEnter:function(){removeClass(this._label,"jivo-fade-in");this._label.style.visibility="hidden"},show:"VISIBLE"}},setText:function(e){if(!this._widgetDiv)return;var t;if(underscore.indexOf(["right","left"],config["widget_orientation"])>=0){t=document.getElementById("jivo-text-container");t=t.getElementsByTagName("div")[0]}else{t=document.getElementById("jivo-label-text")}t.innerHTML=e;this.setLabelPosition();this.position=getElementPosition(this._label)},setColor:function(){this._containerDiv=document.getElementById("jivo-label-wrapper");this._textContainer=document.getElementById("jivo-label-text");var t=e("jivo-label-triangle");for(var i=0;i<t.length;i++){switch(config.widget_orientation){case"top":t[i].style.borderTopColor=config.widget_color;break;case"bottom":t[i].style.borderLeftColor=config.widget_color;break;case"right":t[i].style.borderBottomColor=config.widget_color;break;case"left":t[i].style.borderLeftColor=config.widget_color;break}}t=e("jivo-triangle-inner");for(i=0;i<t.length;i++){t[i].style.backgroundColor=config.widget_color}if(underscore.indexOf([config.chat_mode.toUpperCase(),d.state],"OFFLINE")!==-1){t=e("jivo-bottom-left-square");for(i=0;i<t.length;i++){t[i].style.backgroundColor=config.widget_color}}if(this._containerDiv){this._textContainer.style.fontSize=config.font_size+"px";this._textContainer.style.fontFamily=config.font_family;this._isDarkText=config.widget_font_color=="dark";var n="#222222";if(this._isDarkText){n="#222222"}else{n="#F0F1F1"}this._textContainer.style.color=n}},setOffline:function(){log("widget.setOffline");addClass(this._label,"jivo-offline");removeClass(this._label,"jivo-online");document.getElementById("jivo_chat_widget_online").setAttribute("id","jivo_chat_widget_offline");this.setText(config.offline_widget_label);var t=e("jivo-bottom-left-square");for(var i=0;i<t.length;i+=1){t[i].style.backgroundColor=config.widget_color}},setOnline:function(){addClass(this._label,"jivo-online");removeClass(this._label,"jivo-offline");this.setText(config.online_widget_label);var t=e("jivo-bottom-left-square");for(var i=0;i<t.length;i+=1){t[i].style.backgroundColor="#44bb6e"}t=e("jivo-css-leaf");for(i=0;i<t.length;i+=1){removeClass(t[i],"jivo-offline");addClass(t[i],"jivo-online")}},setPosition:function(){var e=getElementPosition(this._label),t=document.getElementById("jivo-label-text").offsetWidth,i=0,n=0,o,s=this._widgetContainer.style;switch(config.widget_orientation){case"left":case"right":o=config.iconLocale==="en"?38:48;break;case"top":case"bottom":o=10;break}if(utils.showAd()){i=document.getElementById("jivo-label-copyright").offsetWidth;n=document.getElementById("jivo-label-copyright").offsetHeight}var a=document.getElementById("jivo-label-status").offsetWidth,r=document.getElementById("jivo-label-status").offsetHeight;switch(config.widget_orientation){case"left":case"right":var l=document.getElementById("jivo-text-container"),c=l.getElementsByTagName("div")[0];if(c.offsetWidth<c.offsetHeight){l.style.width=c.offsetWidth+"px";l.style.height=c.offsetHeight+"px"}else{l.style.width=c.offsetHeight+"px";l.style.height=c.offsetWidth+"px"}var u=l.offsetHeight;this._label.style.width=config.widget_height+"px";s.width=config.widget_height+"px";s.height=u+n+r+o+"px";e=getElementPosition(this._label);switch(config.widget_padding){case"0":s.top="";s.bottom="100%";if(!utils.showAd()){s.marginBottom=e.height*-1+30+"px"}else{s.marginBottom=e.height*-1-30+"px"}break;case"50":s.marginBottom=e.height/2*-1+"px";s.bottom=config.widget_padding+"%";break}this.widgetHeight=s.height;break;case"top":s.width=t+i+a+o+"px";s.height=config.widget_height+"px";this._label.style.height=config.widget_height+"px";switch(config.widget_padding){case"0":s.left="30px";s.right="";s.top="0";s.bottom="100%";break;case"50":s.marginRight=e.width/2*-1+"px";s.bottom="100%";s.right=config.widget_padding+"%";s.left="";break;case"100":s.top="0";s.bottom="100%";break}this.widgetWidth=s.width;break;case"bottom":s.width=t+i+a+o+"px";s.height=config.widget_height+"px";this._label.style.height=config.widget_height+"px";switch(config.widget_padding){case"0":s.left=30+"px";s.right="";break;case"50":s.marginRight=e.width/2*-1+"px";s.right=config.widget_padding+"%";s.left="";break}this.widgetWidth=s.width;break}},setLabelPosition:function(){var e=document.getElementById("jivo-label-text").offsetWidth,t=0,i=0,n;switch(config.widget_orientation){case"left":case"right":n=config.iconLocale==="en"?38:48;break;case"top":case"bottom":n=10;break}if(utils.showAd()){t=document.getElementById("jivo-label-copyright").offsetWidth;i=document.getElementById("jivo-label-copyright").offsetHeight}var o=document.getElementById("jivo-label-status").offsetWidth,s=document.getElementById("jivo-label-status").offsetHeight;switch(config.widget_orientation){case"left":case"right":var a=document.getElementById("jivo-text-container"),r=a.getElementsByTagName("div")[0];if(r.offsetWidth<r.offsetHeight){a.style.width=r.offsetWidth+"px";a.style.height=r.offsetHeight+"px"}else{a.style.width=r.offsetHeight+"px";a.style.height=r.offsetWidth+"px"}var l=a.offsetHeight;this._label.style.width=config.widget_height+"px";this._label.style.height=this.widgetHeight=l+i+s+n+"px";break;case"top":case"bottom":this._label.style.height=config.widget_height+"px";this._label.style.width=this.widgetWidth=e+t+o+n+"px";break}},setFontStyle:function(){var e=document.getElementById("jivo-label-text");switch(config.font_type){case"normal":e.style.fontWeight="normal";e.style.fontStyle="normal";break;case"italic":e.style.fontWeight="normal";e.style.fontStyle="italic";break;case"bold":e.style.fontWeight="bold";e.style.fontStyle="normal";break;case"bold italic":e.style.fontWeight="bold";e.style.fontStyle="italic";break}e.style.fontSize=config.font_size},getPosition:function(){return getElementPosition(document.getElementById("jivo-label"))}});var l=i.extend({namespace:"GUI",mode:"online",animate:false,unreadMessages:0,skipStoreState:false,_event_queue:[],setOnline:function(){this.widget.setOnline();this.mode="online";return this},setOffline:function(){if(this.mode!="offline"){this._setButtonsOffline();this.widget.setOffline();this.mode="offline"}return this},showWidget:function(e,t){this.enableAnimation(!!e);this.skipStoreState=!!t;this.handle("minimize");return this},showChat:function(e,t){log("showChat",t);if(d.isMobileOrTablet()){d._callUserFunction("onOpen");this.resetCounter();this.openNewWindow()}else{this.enableAnimation(!!e);this.handle("maximize",t)}return this},showCallWidget:function(){log("showCallWidget");this.widget._hideLabelForCallWidget=true;log(this._chatDiv);this._chatDiv.style.visibility="hidden";if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}if(this.jivoframecontainer.closeButton){this.jivoframecontainer.closeButton.style.display="none"}this.handle("callwidget")},showInvitation:function(e,t){this.handle("invitation",e,t);return this},showLabelForCallWidget:function(){this.widget._hideLabelForCallWidget=false;if(this.widget.state==="VISIBLE"){this._chatDiv.style.visibility="visible"}if(config.widget_orientation==="top"||config.widget_orientation==="bottom"){this._chatDiv.style.height=config.widget_height+"px"}else{log("showLABEL",config.widget_height)}},openNewWindow:function(){log("jivo.gui.openNewWindow",window.location.protocol);var e=window.location.protocol,t=e+jivo_config.base_url+"/script/window/"+jivo_config.widget_id,i=[],n=["client_id"],o;if(jivo_config.chat_mode==="online"){n.push("sess_id")}for(var s=0;s<n.length;s++){if(cookie(n[s])){i.push(n[s]+"="+cookie(n[s]));log("cookie for new window",cookie(n[s]))}}o=d.getCurrentPage();i.push("url="+encodeURIComponent(o.url));i.push("title="+encodeURIComponent(o.title));if(i.length){t+="?"+i.join("&")}var a;d.isTablet()&&d.checkVisibilityAPI?a=window.open(t,"jivo_"+config.widget_id):window.parent.window.location=t;if(a){a.focus()}},chatInitialized:function(){return!!this._chatDiv},incrementCounter:function(){var e=document.getElementById("jivo-label-indicator");e.innerHTML=++this.unreadMessages;e.style.visibility="visible";if(config.widget_orientation==="top"||config.widget_orientation==="bottom"){d.gui.jivoframecontainer.setHeight("50px")}else{d.gui.jivoframecontainer.setWidth("50px")}},resetCounter:function(){var e=document.getElementById("jivo-label-indicator");this.unreadMessages=0;e.style.visibility="hidden"},_setButtonsOffline:function(){var t=false;var i=e("jivo-online-btn",window.parent.document);for(var n=0;n<i.length;n++){if(!t){t=i[n].style.display}i[n].style.display="none"}i=e("jivo-offline-btn",window.parent.document);for(n=0;n<i.length;n++){i[n].style.display=t}},highlight:function(e){var t=config.base_url+"/script/cobrowsing?cb=?&hash="+e;getJSONP(t,function(e){if(underscore.isObject(e)){if(e.comment.length==0)e.comment=translate("lblDefaultCobrowseComment");e.comment=stripBrackets(e.comment);coBrowserIframeCreater.process("highlight",e);coBrowserIframeCreater.process("renderTooltip",e)}})},setColor:function(){this._isDarkText=config.widget_font_color=="dark";this._backgroundColor=config.widget_color;this._borderColor=adjustLightness(this._backgroundColor,.6,1);this._bodyColor=adjustLightness(this._backgroundColor,1.15,.5);if(this._chatDiv){var e,t;if(this._isDarkText){e=adjustLightness(this._backgroundColor,1.15,.7)+" 0 1px";t=adjustLightness(this._backgroundColor,.1,.5)}else{e=adjustLightness(this._backgroundColor,.6,1)+" 0 -1px";t="#ffffff"}}},setChatHeight:function(e){log("Setting chat height: "+e);this.jivoframecontainer.setHeight(e+"px")},initialize:function(){var i,n;this._wrapDiv=document.createElement("div");this._wrapDiv.setAttribute("id","jivo_top_wrap");document.body.appendChild(this._wrapDiv);this._chatDiv=document.createElement("div");this._chatDiv.setAttribute("id","jivo-chat");this._chatDiv.innerHTML=t.chat({chatMode:config.chat_mode,mobile:"desktop",lblLookingForFreeAgent:translate("lblLookingForFreeAgent"),lblPhoneHint:translate("lblPhoneHint")});this._wrapDiv.appendChild(this._chatDiv);addClass(this._chatDiv,"jivo-animated jivo-"+config.chat_mode);underscore.defaults(config,{online_widget_label:translate("defOnlineWidgetLabel"),offline_widget_label:translate("defOfflineWidgetLabel"),offline_form_text:translate("defOfflineFormText"),contacts_settings:{name:{show:false,required:false},phone:{show:false,required:false},email:{show:false,required:false}}});if(d.isMobile()){config.online_widget_label=translate("defOnlineWidgetLabelMobile")||config.online_widget_label;config.offline_widget_label=translate("defOfflineWidgetLabelMobile")||config.offline_widget_label;config.widget_orientation="bottom";config.widget_padding=100;if(config.ignore_viewport){d.ignore_viewport=config.ignore_viewport}}if(d.isWixIframe()){config.widget_orientation="bottom"}this.widget=new r({topWrap:this._wrapDiv});this.copyright=new c;this.jivoframecontainer=new f({widget:this.widget});log("jivoframeinit",$("#jivo_action",window.parent.document));if(this.animationIsSupported()){this.jivoframecontainer.on("expanded",underscore.bind(this.handle,this,"animate_finished"));this.jivoframecontainer.on("collapsed",underscore.bind(this.handle,this,"animate_finished"))}getConfigContactsAsk();this.setColor();n=e("jivo-chat-triangle");for(i=0;i<n.length;i++){n[i].style.borderLeftColor=config.widget_color;n[i].style.borderTopColor=config.widget_color}n=e("jivo-triangle-inner");for(i=0;i<n.length;i++){n[i].style.backgroundColor=config.widget_color}if(config.chat_mode=="offline"){n=e("jivo-bottom-left-square");for(i=0;i<n.length;i++){n[i].style.backgroundColor=config.widget_color}}},enableAnimation:function(e){if(!d.isWixIframe()&&e){log("GUI : enabling animation");this.animate=true}else{log("GUI : disabling animation");this.animate=false}},animationIsSupported:function(){return!!(!this.widget.isCustom()&&css3AnimationIsSupported())},setGuiState:function(){if(d.pageVisible()&&this.setCookie){cookie("gui_state",this.state)}},states:{uninitialized:{minimize:"WIDGET",maximize:function(){this._event_queue.push(["show",this.mode]);this.transition("CHAT")},blacklist:"INVISIBLE",resume_ok:function(e){log("resume ok");var t=e.client_info.msg_history;window.chat_contents.handle.apply(window.chat_contents,["resume_ok"].concat(underscore.toArray(arguments)));if(underscore.findWhere(t,{type:"agentMessage",ack:0})){this.transition("CHAT");return}var i=cookie("gui_state"),n=e.client_info.cw_call&&e.client_info.cw_call.status;if(!i||i==="CALLWIDGET"&&!n||i==="CALLWIDGET"&&n==="cw_call_end"){log("callback check to state",i);i="WIDGET"}if(n){if(n=="cw_connected"){}else{this.jivoframecontainer.setHeight("346px")}this.jivoframecontainer.setWidth("290px");i="CALLWIDGET"}log("resume_ok trasition to: ",i);this.transition(i)}},WIDGET:{_onEnter:function(){log("widget transition");if(!this.skipStoreState){cookie("gui_state",this.state)}this.skipStoreState=false;n.updateClient({chat_opened:false});if(this.chatInitialized()){this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";removeClass(this._chatDiv,"jivo-fade-in");if(this.jivoframecontainer.closeButton){this.jivoframecontainer.closeButton.style.display="none"}}if(this._priorAction=="CALLWIDGET.minimize"){this.showWidget(true,this.openParams)}else{$("#jivo-iframe-container",window.parent.document).removeClass("jivo-callwidget");this.widget.handle("show")}if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}},minimize:function(){log("minimized");addClass(this.jivoframecontainer.element,"jivo-no-transition");$(".jivo-call-form").hide()},maximize:function(e){if(this.chatInitialized()){this._chatDiv.style.height="";this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden"}this.resetCounter();this._event_queue.push(["show",this.mode,e]);this.copyright.transition("HIDDEN");if(this.animationIsSupported()&&this.animate){this.transition("ANIMATE_EXPAND")}else{this.jivoframecontainer.element.style.visibility="visible";this.transition("CHAT")}},callwidget:function(){this.transition("CALLWIDGET")},"*":function(e,t){log("widget payload",e,arguments);log("isMobile",d.isMobile(),"isTablet",d.isTablet(),!(d.isMobile()||d.isAndroid4old()&&d.isTablet()));if(!(d.isMobileOrTablet()||d.isAndroid4old())){log("desktop, expand to chat.",!(d.isMobile()||d.isAndroid4old()&&d.isTablet()));if(e!=="invitation"){this._event_queue.push(["show",this.mode])}this._event_queue.push(underscore.toArray(arguments));if(underscore.indexOf(["agent_message","invitation","agent_service_message"],e)>=0){if(config.departments&&e==="invitation"){chat_view_online.getDepartmentsView().close()}this.transition(this.animationIsSupported()?"ANIMATE_EXPAND":"CHAT")}else if(e==="resume_ok"){var i=cookie("gui_state"),n=t.client_info.cw_call&&t.client_info.cw_call.status;switch(i){case"CHAT":this.transition(i);break;case"CALLWIDGET":if(!n||n==="cw_call_end"){this.transition("WIDGET")}else{this.transition("CALLWIDGET")}break;default:break}}}else if(underscore.indexOf(["agent_message","system_message","invitation","agent_service_message"],e)>=0){if(underscore.indexOf(["agent_message","invitation","agent_service_message"],e)>=0){this.incrementCounter()}}},blacklist:function(){this.transition("INVISIBLE")}},CHAT:{_onEnter:function(){if(!this.animationIsSupported()){this.copyright.transition("HIDDEN")}if(this.widget.isCustomLabel()){removeClass(this.jivoframecontainer.element,"jivo-custom-label")}addClass(this.jivoframecontainer.element,"jivo-expanded");this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden";cookie("gui_state",this.state);n.updateClient({chat_opened:true});if(d.getCallWidget()){$("#jivo-iframe-container",window.parent.document).removeClass("jivo-callwidget");d.getCallWidget().hideCallWidget()}if(this._priorAction!="WIDGET.maximize"){addClass(this.jivoframecontainer.element,"jivo-no-transition");if(!d.isTablet()){this.showChat(true,this.openParams)}}this._chatDiv.style.height="100%";this._chatDiv.style.display="block";this._chatDiv.style.visibility="visible";if(!chat_view_online.getMessagesView().isIntroduceRequired()||config.contacts_ask!=1){if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="block"}}else{if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}}this.jivoframecontainer.closeButton.style.display="block";this.jivoframecontainer.jivoLeaf.style.display="block";var e;while(e=this._event_queue.shift()){log("event",e);window.chat_contents.handle.apply(window.chat_contents,e)}if(!this.widget.fade){this.widget.fade=true}this.widget.handle("hide");if(d.gui.animationIsSupported()){addClass(this.jivoframecontainer.innerChat,"jivo-fade-in");this.jivoframecontainer.innerChat.style.display="block";this.jivoframecontainer.innerChat.style.visibility="visible"}else{this.jivoframecontainer.innerChat.style.display="block";this.jivoframecontainer.innerChat.style.visibility="visible"}if(d.state==="OFFLINE"){chat_view_offline.disableDragging()}else{chat_view_online.getChatView().updateMessage();chat_view_online.getMessagesView().setScrollBottom(0);chat_view_online.getMessagesView().updateScrollBar()}if(underscore.isFunction(updateBlur)){updateBlur()}},minimize:function(){removeClass(this.jivoframecontainer.element,"jivo-no-transition");if(this.animationIsSupported()&&this.animate){this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden";removeClass(this.jivoframecontainer.innerChat,"jivo-fade-in");addClass(this.jivoframecontainer.chatDiv,"jivo-fade-out")}else{this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden"}this.jivoframecontainer.closeButton.style.display="none";if(this.jivoframecontainer.dragHandle){this.jivoframecontainer.dragHandle.style.display="none"}this.jivoframecontainer.jivoLeaf.style.display="none";if(this.animationIsSupported()&&this.animate){if(d.getCallWidget()&&d.getCallWidget().state==="CALL"){this.jivoframecontainer.closeButton.style.display="none";this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";removeClass(this.jivoframecontainer.chatDiv,"jivo-fade-in");this.handle("callwidget")}else{this.transition("ANIMATE_COLLAPSE")}}else{this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";this.transition("WIDGET")}},maximize:function(){var e=this.jivoframecontainer.getChatPosition(),t=this.jivoframecontainer.element.style;t.width="287px";switch(config.widget_orientation){case"left":t.marginLeft="30px";t.top="";t.bottom="0px";t.left=e.left;t.height=e.height;t.marginBottom="0";break;case"right":t.marginRight="30px";t.marginBottom="0";t.top="";t.bottom="0px";t.right=e.right;t.height=e.height;break;case"top":t.top="auto";t.bottom="0";t.marginBottom="0";t.height=e.height;if(config.widget_padding=="0"){t.left=e.left}else if(config.widget_padding=="50"){if(!e.left&&!e.right){t.right="30px"}else{t.right=e.right}t.margin=""}else if(config.widget_padding=="100"){t.right=e.right}break;case"bottom":t.height=e.height;if(config.widget_padding=="0"){t.left=e.left}if(config.widget_padding=="50"){if(!e.left&&!e.right){t.right="30px";t.marginRight=""}else{t.right=e.right;t.margin=""}}if(config.widget_padding=="100"){if(!e.left&&!e.right){t.right="30px"}else{t.right=e.right}}break}d.transferProportion({width:parseFloat(t.width),height:parseFloat(t.height)})},callwidget:function(){this.transition("CALLWIDGET")},"*":function(e){log("payload",e);window.chat_contents.handle.apply(window.chat_contents,underscore.toArray(arguments));if(e==="resume_ok"){if(cookie("gui_state")&&cookie("gui_state")==="WIDGET"){this.transition("WIDGET")}}},blacklist:function(){this.transition("INVISIBLE")}},CALLWIDGET:{_onEnter:function(){this.copyright.transition("HIDDEN");this.jivoframecontainer.handle("expand");addClass(this.jivoframecontainer.element,"jivo-expanded");if(d.state==="OFFLINE"){this._chatDiv.style.display="none"}$("#jivo-iframe-container",window.parent.document).addClass("jivo-opening");setTimeout(function(){$("#jivo-iframe-container",window.parent.document).addClass("jivo-callwidget");$("#jivo-iframe-container",window.parent.document).removeClass("jivo-opening")},250);this.jivoframecontainer.setWidth("290px");this.jivoframecontainer.setHeight($(d.getCallWidget().form).find(".jivo-call-form").height()+"px");d.getCallWidget().showCallWidget();cookie("gui_state",this.state);n.updateClient({chat_opened:false});if(this.chatInitialized()){this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";removeClass(this._chatDiv,"jivo-fade-in")}this.widget.handle("hide");if(!this.widget.fade){this.widget.fade=true}},minimize:function(){d.getCallWidget().hideCallWidget();this.jivoframecontainer.setTransition(true);this.jivoframecontainer.handle("collapse");this.transition("WIDGET")},maximize:function(e){this._event_queue.unshift(["show",e?e:this.mode]);if(this.animationIsSupported()&&this.animate){this.transition("ANIMATE_EXPAND")}else{this.transition("CHAT")}},"*":function(e){this._event_queue.push(underscore.toArray(arguments));if(e==="agent_message"){this.handle("maximize")}else if(e==="resume_ok"){if(d.getCallWidget().state==="CLOSED"){this.transition("WIDGET")}}},blacklist:function(){this.transition("INVISIBLE")},cw_show_form:function(){this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden"}},ANIMATE_EXPAND:{_onEnter:function(){this.copyright.transition("HIDDEN");addClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-opening");addClass(this.jivoframecontainer.element,"jivo-opening");if(d.gui.state=="CALLWIDGET"){this.jivoframecontainer.chatDiv.style.display="none";this.jivoframecontainer.chatDiv.style.visibility="hidden"}else{this.jivoframecontainer.innerChat.style.display="none";this.jivoframecontainer.innerChat.style.visibility="hidden";this.jivoframecontainer.chatDiv.style.display="block";this.jivoframecontainer.chatDiv.style.visibility="visible"}this.jivoframecontainer.jivoLeaf.style.display="none";if(this.widget.isCustomLabel()){this.jivoframecontainer.element.style.visibility="visible"}this.jivoframecontainer.handle("expand");this.widget.handle("hide")},animate_finished:function(){removeClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-opening");removeClass(this.jivoframecontainer.element,"jivo-opening");this.jivoframecontainer.innerChat.style.display="block";if(d.state=="OFFLINE"){addClass(this.jivoframecontainer.element,"jivo-no-transition")}this.transition("CHAT")},resume_ok:function(){window.chat_contents.handle.apply(window.chat_contents,["resume_ok"].concat(underscore.toArray(arguments)))},"*":function(e,t){this._event_queue.push(underscore.toArray(arguments))},blacklist:"INVISIBLE"},ANIMATE_COLLAPSE:{_onEnter:function(){addClass(this.jivoframecontainer.element,"jivo-closing");addClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-closing");this.jivoframecontainer.jivoLeaf.style.display="none";this.jivoframecontainer.handle("collapse")},"*":function(e,t){this._event_queue.push(underscore.toArray(arguments))},animate_finished:function(){removeClass(this.jivoframecontainer.chatDiv,"jivo-animating jivo-closing");removeClass(this.jivoframecontainer.element,"jivo-closing");this.transition("WIDGET")},blacklist:"INVISIBLE"},INVISIBLE:{_onEnter:function(){this.widget.handle("hide");this.jivoframecontainer.element.style.display="none";this._chatDiv.style.display="none";this._chatDiv.style.visibility="hidden";removeClass(this._chatDiv,"jivo-fade-in")}}}},{_backgroundColor:0,_borderColor:0,_bodyColor:0,_shadow:0});var c=i.extend({namespace:"AD",initialState:"HIDDEN",disabled:false,initialize:function(){var e=document.getElementById("jivo-label-copyright"),t=this.widgetContainer=window.parent.document.getElementById("jivo-iframe-container"),i=this.widgetHeight=parseFloat(config.widget_height),n=this.widgetWidth=this.widgetContainer.offsetWidth;if(!utils.showAd()){addClass(e,"jivo-no-copyright");this.disabled=true;return}this.jivo_copyright=document.getElementById("jivo_copyright");if(!this.jivo_copyright){this.jivo_copyright=document.createElement("div");this.jivo_copyright.innerHTML=translate("seo_copyrightTextNew").replace("_COLOR_",config.widget_font_color);this.jivo_copyright.id="jivo_copyright";this.jivo_copyright.style.display="none";document.body.appendChild(this.jivo_copyright)}var o=document.createElement("div");o.setAttribute("id","jivo_copyright_corner");o.setAttribute("class","jivo-"+config.widget_orientation);switch(config.widget_orientation){case"top":o.style.borderBottomColor=config.widget_color;break;case"left":o.style.borderRightColor=config.widget_color;break;case"right":o.style.borderLeftColor=config.widget_color;break;case"bottom":o.style.borderTopColor=config.widget_color;break}this.jivo_copyright.style.backgroundColor=config.widget_color;this._isDarkText=config.widget_font_color=="dark";var s="#222222";if(this._isDarkText){s="#222222"}else{s="#F0F1F1"}this.jivo_copyright.style.color=s;this.jivo_copyright.appendChild(o);var a=this.jivo_copyright.getElementsByTagName("a");for(var r=0;r<a.length;r++){a[r].href+="?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=widget_popup&utm_campaign=self_ad"}if(!d.isMobile()){e.onmouseover=underscore.bind(this.handle,this,"ad_mouseover");e.onmouseout=underscore.bind(this.handle,this,"ad_mouseout");this.jivo_copyright.onmouseover=underscore.bind(this.handle,this,"copyright_mouseover");this.jivo_copyright.onmouseout=underscore.bind(this.handle,this,"copyright_mouseout")}},getTooltipSize:function(){var e=getElementPosition(document.getElementById("jivo_copyright"));return{width:e.width,height:e.height}},getTooltipPosition:function(e){var t=getElementPosition(e),i=getElementPosition(document.getElementById("jivo_copyright")),n={top:0,left:0},o;switch(config.widget_orientation){case"left":o=10;n={top:t.top+20,left:t.left+this.widgetWidth+o};if(ie8){n={top:t.top,left:t.left+this.widgetWidth+10}}break;case"right":o=config.iconLocale==="en"?80:60;n={top:t.top+20,left:i.width-o};break;case"top":n={top:t.top+(t.height+15),left:t.left+40};break;case"bottom":n={bottom:t.height+10,left:t.left+(t.width-i.width)-40};break}return n},states:{HIDDEN:{_onEnter:function(){if(!this.disabled){this.jivo_copyright.style.display="none"}switch(config.widget_orientation){case"left":case"right":this.widgetContainer.style.width=this.widgetWidth+"px";break;case"top":case"bottom":this.widgetContainer.style.height=this.widgetHeight+"px";break}removeClass(this.widgetContainer,"jivo-no-transition")},ad_mouseover:"VISIBLE"},VISIBLE:{_onEnter:function(){this.jivo_copyright.style.display="block";this.widgetContainer.style.width=d.gui.jivoframecontainer.widgetWidth;var e=this.getTooltipPosition(document.getElementById("jivo-label")),t=this.getTooltipSize(),i=150;addClass(this.widgetContainer,"jivo-no-transition");switch(config.widget_orientation){case"left":case"right":this.widgetContainer.style.width=this.widgetWidth+t.width+i+"px";break;case"top":case"bottom":this.widgetContainer.style.height=this.widgetHeight+t.height+i+"px";break}this.jivo_copyright.style.left=e.left+"px";if(typeof e.bottom!="undefined"){this.jivo_copyright.style.bottom=e.bottom+"px"}else{this.jivo_copyright.style.top=e.top+"px"}},ad_mouseout:function(){this._scheduleEvent("hide",700)},hide:"HIDDEN",copyright_mouseover:function(){this._cancelEvent("hide")},copyright_mouseout:function(){this._scheduleEvent("hide",700)}}}});var u=new i({namespace:"TITLE",title:"",startBlink:function(){this.handle("start")},stopBlink:function(){this.handle("stop")},_messageShown:false,_showMessage:function(){window.parent.document.title=translate("lblNewMessage");this._messageShown=true},_showTitle:function(){window.parent.document.title=this.title;this._messageShown=false},states:{uninitialized:{start:"blinking"},blinking:{_onEnter:function(){this.title=window.parent.document.title;this._showMessage();this._scheduleEvent("blink",1e3)},blink:function(){if(this._messageShown){this._showTitle()}else{this._showMessage()}this._scheduleEvent("blink",1e3)},stop:function(){this._showTitle();this._cancelEvent("blink");this.transition("uninitialized")}}}});var d=window.jivo=new i({namespace:"JIVO",_chatWindow:false,_forcedCurrentPage:false,_forcedOffline:false,checkVisibilityAPI:true,invitationText:false,agentInfo:false,ruleName:false,isClicked:false,initialize:function(){config.widget_height="33";var e=underscore.bind(this.handle,this,"window.loaded");if(document.readyState==="complete"){setTimeout(e)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",e,false);window.addEventListener("load",e,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",e);window.attachEvent("onload",e)}this.device=devicejs},initializeMachines:function(){this.gui=new l;if(config.callback_widget&&!this.cw&&!this.isMobileOrTablet()){this.initCallWidget()}this.soundPlayer=soundPlayer;this.soundPlayer.initialize(document.getElementById("jivo_top_wrap"));if(config["form_observer"]&&!this.isSeparateWindow()){new g}},_changeBrowserLocation:function(e,t,i){var n=i||window;if(typeof n.parent.history.pushState==="function"){n.parent.history.pushState({},t,e)}},_newSession:function(){cookie("sess_id",null);if(!this.isSeparateWindow()){if(config.chat_mode==="offline"){if(utils.hideOffline()){this.transition("HIDDEN");return}}if(config.options&16){this.transition("INIT_RULE_MANAGER");return}if(config.chat_mode==="online"){if(this.isVisitorsInsight()){n.handle("startup")}this.transition("ONLINE")}else{this.transition("OFFLINE")}}this.gui.showWidget()},_listenMessages:function(e){log("JIVO: listening for window messages");if("addEventListener"in window){window.addEventListener("message",underscore.bind(this._windowMessage,this,e),false)}else if("attachEvent"in window){window.attachEvent("message",underscore.bind(this._windowMessage,this,e))}},_windowMessage:function(e,t){this.handle([e,t.data.action].join("_"),t)},isVisitorsInsight:function(){return config.visitors_insight===1},isMobile:function(){return devicejs.mobile()},isTablet:function(){return devicejs.tablet()},isMobileOrTablet:function(){return this.isMobile()||this.isTablet()},isAndroid4old:function(){var e=navigator.userAgent,t,i=false;if(e.indexOf("Android")>=0){t=parseFloat(e.slice(e.indexOf("Android")+8));if(t===4||t===4.1||t===4.2){i=true}}return i},isWixIframe:function(){return typeof this.getPageWindow().jivo_in_wix_iframe!=="undefined"},isSeparateWindow:function(){return typeof jivo_newWindow!=="undefined"},isBitrix:function(){var e=document.cookie.split(";"),t=false;underscore.each(e,function(e){if(e.indexOf("BITRIX_")>=0){t=true}},this);if(t){telemetry("Bitrix Skip Iframe")}return t},getCallWidget:function(){return this.cw&&this.cw.callwidget},initCallWidget:function(){var e={currentState:"",position:{top:0,left:0},seconds:config.callback_widget,initTimer:config.callback_widget,agent_info:""};if(this.resumed_context&&this.resumed_context.client_info.cw_call){e.currentState=d.resumed_context.client_info.cw_call.status;if(e.currentState==="cw_call_end"||e.currentState==="cw_error")e.currentState="CLOSED";e.agent_info=this.resumed_context.agent_info}else{e.agent_info=null}if(e.currentState){if(underscore.indexOf(["cw_connected","cw_connecting","cw_error","cw_call_end"],e.currentState)!==-1){e.initialState="CALL";e.priorAction=e.currentState}else{e.initialState="WAIT";e.priorAction=e.currentState}}if(e.currentState==="CLOSED"){e.initialState="CLOSED"}if(!this.cw)this.cw={};this.cw.callwidget=new _(e);log("jivo.js init cw")},createMagicIFrame:function(){if(!this.isMobile()&&!this.isTablet()&&!this.isSeparateWindow()&&!this.isWixIframe()&&!this.isBitrix()){m.create()}},_callUserFunction:function(e,t){e="jivo_"+e;if(typeof window.parent.window[e]==="function"){try{log("JIVO: calling user function "+e);window.parent.window[e](t);log("JIVO: user function "+e+" returned")}catch(i){}}},_sendIntroduce:function(e){n.sendIfConnected({name:"introduction",client_name:e.name,phone:e.phone,email:e.email});this._saveClientInfo(e)},_saveClientInfo:function(e){underscore.each(["name","phone","email"],function(t){if(t in e&&e[t]!==""){if(t==="name"){cookie("client_name",e[t],{expires:365,path:"/"})}else{cookie(t,e[t],{expires:365,path:"/"})}}})},_chatAccepted:function(){h.trackChatConnected();this._callUserFunction("onAccepted")},transferProportion:function(e){this._callUserFunction("onResizeCallback",e)},getCurrentPage:function(){log("jivo.getCurrentPage",this._forcedCurrentPage,window.location.href,document.title);if(this._forcedCurrentPage){return this._forcedCurrentPage}var e=this.getPageWindow();return{url:e.location.href,title:setSubstrTitle(e.document.title)}},getPageWindow:function(){return window.parent||window},getChatHeight:function(){log("getChatHeight");if(this.isMobileOrTablet()){return document.getElementById("jivo-chat").offsetHeight}else{return parseInt(d.gui.jivoframecontainer.getOnlineFormHeight())}},_stripHashFromLocation:function(e,t){var i=t||window;if(i.location.href.indexOf("#jvhs_"+e)>0){this._changeBrowserLocation(i.location.href.replace("#jvhs_"+e,""),document.title,i)}},pageVisible:function(){log("pageVisible");if("visibilityState"in document){return document.visibilityState==="visible"}else if("webkitVisibilityState"in document){return document.webkitVisibilityState==="visible"}return false},_listenVisibility:function(){log("Installing visibility event handler");var e,t,i;if(typeof document.hidden!=="undefined"){e="hidden";i="visibilitychange";t="visibilityState"}else if(typeof document.mozHidden!=="undefined"){e="mozHidden";i="mozvisibilitychange";t="mozVisibilityState"}else if(typeof document.msHidden!=="undefined"){e="msHidden";i="msvisibilitychange";t="msVisibilityState"}else if(typeof document.webkitHidden!=="undefined"){e="webkitHidden";i="webkitvisibilitychange";t="webkitVisibilityState"}if("addEventListener"in document&&typeof i!=="undefined"){document.addEventListener(i,underscore.bind(this._visibleHandler,this,t),false)}else{this.checkVisibilityAPI=false}},_visibleHandler:function(e){this.handle("window_"+document[e]);n.updateClient({page_visible:this.pageVisible()})},_isBlacklisted:function(){var e=cookie("client_id");return e&&e.indexOf("z")===0},_sendRate:function(e,t){var i={jv_sess_id:t,r:e};getJSONPWithData(config.base_url+"/script/rate/"+config.widget_id,i,function(e){log("Rate result",e)})},handleGuiTransition:function(e){log("handleGuiTransition",e);if(e.toState==="WIDGET"){this._callUserFunction("onClose")}else if(e.toState==="CHAT"){this._callUserFunction("onOpen")}},callWidgetEvents:function(e,t){if(e.lastIndexOf("cw_",0)===0){log(e,this.state,underscore.toArray(arguments));if(!this.cw){log("JIVO: Call widget not initialized.")}else{if(e==="cw_cancel_call"){n.send({name:e});return}if(e==="cw_call"){n.send({name:e,tel:t.tel,invitation_text:t.invitation_text||false})}else if(e==="cw_ping"){n.send({name:e,title:underscore.toArray(arguments)[1]||false})}else{this.emit.apply(this,underscore.toArray(arguments))}}}},updateHeight:function(e){if("update_height"===e&&this.gui){this.gui.handle.apply(this.gui,underscore.toArray(arguments))}},"*":function(e,t){this.updateHeight(e,t);log(this.namespace+": unhandled "+e+" in state "+this.state)},states:{uninitialized:{"window.loaded":function(){if(!cookie("enter_ts")){cookie("enter_ts",(new Date).getTime());var e=this.getPageWindow();if(e.document.referrer){cookie("refer",e.document.referrer);setUTMParams(e.location.href)}var t=cookie("visits_count")-0;cookie("visits_count",!t?1:t+1,{expires:365,path:"/"})}if(this.isSeparateWindow()){this._listenVisibility();var i=getURLParam("url");var n=getURLParam("title");if(i&&n){this._forcedCurrentPage={url:i,title:setSubstrTitle(n)}}var o=getURLParam("client_id");if(o){cookie("client_id",o)}var s=getURLParam("sess_id");config.chat_mode=s?"online":"offline";this.initializeMachines();if(s){cookie("sess_id",s,{expires:1,path:"/"});this.transition("CHECKING_SESSION")}else{this.transition("OFFLINE")}}else if(this._isBlacklisted()||this.isMobileOrTablet()&&config.disable_mobile){this.transition("HIDDEN")}else{this.transition("LOADING_CSS")}}},LOADING_CSS:{_onEnter:function(){if(document.createStyleSheet){document.createStyleSheet(staticUrl("/css/main.css"));if(ie8){document.createStyleSheet(staticUrl("/css/label-ie8.css"));document.createStyleSheet(staticUrl("/css/chat-ie8.css"))}if(devicejs.windowsPhone()){document.createStyleSheet(staticUrl("/css/label-wp.css"))}if(config.callback_widget&&!this.isMobileOrTablet()){document.createStyleSheet(staticUrl("/css/call-widget.css"))}}else{var e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("href",staticUrl("/css/main.css"));var t=utils.browser;if(t.name==="Opera"||t.name==="Safari"&&t.mV<6&&!d.isMobile()||t.name==="Firefox"&&t.mV<12&&!d.isMobile()){var i=document.createElement("link"),n=document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("href",staticUrl("/css/label-ie8.css"));document.body.appendChild(i);n.setAttribute("rel","stylesheet");n.setAttribute("href",staticUrl("/css/chat-ie8.css"));document.body.appendChild(n)}document.body.appendChild(e);if(devicejs.windowsPhone()){var o=document.createElement("link");o.setAttribute("rel","stylesheet");o.setAttribute("href",staticUrl("/css/label-wp.css"));document.body.appendChild(o)}if(config.callback_widget&&!this.isMobileOrTablet()){var s=document.createElement("link");s.setAttribute("rel","stylesheet");s.setAttribute("href",staticUrl("/css/call-widget.css"));document.body.appendChild(s)}}var a=this.cssDetector=document.createElement("div");a.id="jivo_css_detector";a.style.visibility="hidden";a.style.position="absolute";document.body.appendChild(a);this._scheduleEvent("timer_css",100)},timer_css:function(){if(!(this.cssDetector.offsetWidth>0)){this._scheduleEvent("timer_css",100);return}this.initializeMachines();this.gui.on("transition",underscore.bind(this.handleGuiTransition,this));var e=window.location.hash.split("jvhs_");if(!underscore.isUndefined(e[1])){this.gui.highlight(e[1])}try{log("timer_css IN_IFRAME",window.parent.window.jivo_magic_var,window.top.jivo_magic_var);if(window.parent.window!=window.top){log("window.parent.window != window.top",window.parent.window!=window.top);try{if(window.top.jivo_magic_var===window.parent.window.jivo_magic_var&&!this.isWixIframe()){this.transition("IN_IFRAME");this._callUserFunction("onLoadCallback");return}}catch(t){log(t)}if(!this.isWixIframe()){log("!this.isWixIframe");this.transition("HIDDEN");return}}}catch(t){log(t)}if(!this.isSeparateWindow()){this._listenVisibility();this._callUserFunction("onLoadCallback")}if(cookie("sess_id")){this.transition("CHECKING_SESSION")}else{this._newSession()}},gui_introduced:function(e){this._saveClientInfo(e)}},CHECKING_SESSION:{_onEnter:function(){var e=cookie("sess_id");var t=this.getCurrentPage();getJSONPWithData(chatServerUrl(e,config.site_id,config.widget_id),{name:"url_change",jv_widget_id:config.widget_id,title:setSubstrTitle(t.title),url:t.url},underscore.bind(this.handle,this,"check_session_response"));this._scheduleEvent("timer_check_session",4e3)},check_session_response:function(e){log("JIVO: Check session response",e);this._cancelEvent("timer_check_session");if(typeof e==="object"){if(e.result==="ok"){if(e.has_connection){if(this.pageVisible()){this.transition("RESUMING")}else{this.transition(config.chat_mode.toUpperCase());this.gui.showWidget(false,true)}}else{this.transition("RESUMING")}return}}this._newSession()},timer_check_session:function(){reportException({message:"Check session Timeout"});this._newSession()}},RESUMING:{_onEnter:function(){n.resume(cookie("sess_id"))},resume_ok:function(e){log("resuming chat");this.resumed_context=e;var t=this.getCallWidget(),i;if(t){if(this.resumed_context.client_info.cw_call){i=this.resumed_context.client_info.cw_call.status;if(i==="cw_wait"){log("resume on cw_wait, handle_start_timer");t.handle("start_timer")}else{t.handle(i)}}else{t.handle("CLOSED")}}var n=e.client_info.msg_history;if(n&&n.length){n=e.client_info.msg_history=underscore.reject(n,function(e){return e.implicit})}if(n&&underscore.findWhere(n,{type:"clientMessage"})){this.createMagicIFrame()}var o=config.chat_mode.toUpperCase();if(n&&n.length>0){o="ONLINE";config.chat_mode="online"}this.transition(o);if(!this.isMobileOrTablet()||this.isSeparateWindow()){if(this.isSeparateWindow()||!(this.isVisitorsInsight()&&n&&n.length===0)||e.agent_info||i){this.gui.handle("resume_ok",e)}else{this.transition("INIT_RULE_MANAGER")}}else{this.gui.showWidget();underscore.each(n,function(e){if(e.type==="agentMessage"&&!e.ack){this.gui.incrementCounter()}},this);if(!underscore.findWhere(n,{type:"agentMessage",ack:0})){this.gui.resetCounter()}}},resume_failed:function(){this._newSession()},gui_callwidget:function(){this.gui.showCallWidget()}},HIDDEN:{},IN_IFRAME:{_onEnter:function(){log("IN_IFRAME",window.location.href,document.title);cookie("mframe",null);if(window.parent.window.parent.window.jivo){window.parent.window.parent.window.jivo.handle("iframe_url_change",window.location.href,document.title)}},highlight_cobrowse:function(e){this.gui.highlight(e)},gui_introduced:function(e,t){this._sendIntroduce(e);if(!t){h.trackGaveContacts();this._callUserFunction("onIntroduction")}},gui_close_cobrowse:function(e){this._stripHashFromLocation(e,window.parent)},"*":function(e){if(underscore.indexOf(["api_open","gui_message"],e)>=0){if(!window.parent.window.jivo){window.top.window.jivo.handle.apply(window.parent.jivo,underscore.toArray(arguments))}else{window.parent.window.jivo.handle.apply(window.parent.jivo,underscore.toArray(arguments))}}else{log("JIVO: unhandled "+e+" in "+this.state)}}},INIT_RULE_MANAGER:{_onEnter:function(){log("INIT_RULE_MANAGER on enter.",a.isInited);if(a.isInited){this.handle("rule_manager_ready")}else{log("INIT_RULE_MANAGER init.");a.on("ready",underscore.bind(this.handle,this,"rule_manager_ready"));this.ruleManager=a;a.init()}},rule_manager_ready:function(){if(config.chat_mode==="online"){if(this.isVisitorsInsight()){n.handle("startup")}this.transition("ONLINE")}else{this.transition("OFFLINE")}this.gui.showWidget()},hide:"HIDDEN"},ONLINE:{_onEnter:function(){this.gui.setOnline();chat_contents.init(config.chat_mode,this.open_params)},api_open:function(e){this.handle("gui_maximize",e)},invitation:function(e,t){n.updateClient({chat_opened:true,page_visible:this.pageVisible(),proactive_rule:{invitation_text:e.invitationText,agent_id:t.agent_id}});h.trackProactiveInvitationShown(e.name);this.ruleName=e.name;this.invitationText=e.invitationText;this.agentInfo=t;this.gui.showInvitation(this.agentInfo,this.invitationText);this.transition("PROACTIVE")},callback_invitation:function(e){var t=this.getCallWidget();if(t){t.handle("cw_show_form",{show_form:1,title:e.title})}h.trackCallWidgetInvitationShown(e.title)},highlight_cobrowse:function(e){this.gui.highlight(e)},gui_close_cobrowse:function(e){this._stripHashFromLocation(e)},gui_maximize:function(e){log("gui_maximize",e);this.openParams=e;if(this.isMobileOrTablet()&&!cookie("sess_id")){this.transition("STARTING_SESSION")}else{h.trackChatOpenedByClick();this.gui.showChat(true,this.openParams)}},gui_callwidget:function(){this.gui.showCallWidget()},gui_answer_proactive:function(){if(cookie("sess_id")){if(d.isTablet()){this.gui.openNewWindow()}else{this.gui.showChat(true,this.openParams)}}},gui_typing:function(e){n.sendIfConnected({name:"client_typing",typing:e})},gui_introduced:function(e,t){this._sendIntroduce(e);if(!t){h.trackGaveContacts();this._callUserFunction("onIntroduction")}},gui_message:function(e,t){this.createMagicIFrame();var i={name:"client_message",message:e};if(t){i=underscore.extend(i,t)}if(this.department_id){i.widget_department_id=this.department_id;this.department_id=null}n.send(i);if(!i.implicit){this.gui.handle("gui_message",e)}},gui_department:function(e){this.department_id=e},gui_typing_insight:function(e){n.sendIfConnected({name:"client_service_message",service:"typing_insight",event:"input_changed",new_val:e})},gui_minimize:function(){log("gui_minimize");u.stopBlink();this.gui.showWidget(true)},gui_decline_file:function(e,t){u.stopBlink();n.send({name:"client_service_message",service:"file_transfer",file_id:e,file_name:t,event:"file_declined"})},gui_receive_file:function(e,t){u.stopBlink();n.send({name:"client_service_message",service:"file_transfer",file_id:e,file_name:t,event:"file_received"})},gui_accept_cobrowse:function(e,t){log("gui_accept_cobrowse",e,t);u.stopBlink();var i=window.parent.document.location.href.split("#")[0];var n=e+"#jvhs_"+t;var o=window.parent.document.getElementById("jivo_magic_iframe");if(i===e||i===encodeURI(e)){try{var s=window;if(o){s=o.contentWindow}s.jivo_api.highlightCobrowse(t)}catch(a){log(a.toString());return}this._changeBrowserLocation(n,document.title)}else{if(this.isMobileOrTablet()){window.open(n,document.title)}else{if(o){log("magicIFrame navigate",n);m.navigate(n)}else{window.parent.document.location.href=n}}}},gui_evaluation:function(e,t){this._sendRate(e,t)},agent_chat_close:function(e){this.invitationText=this.agentInfo=false;this.gui.handle("agent_chat_close",e)},gui_msg_input_focus:function(){u.stopBlink()},"*":function(e,t){this.callWidgetEvents(e,t);if(underscore.indexOf(["agent_message","agent_service_message","system_message","agent_typing","accept","gui_resume","update_height","transferred","update_agent_info","blacklist","cw_show_form","cw_connected","cw_connecting","cw_call_end"],e)>=0){this.gui.handle.apply(this.gui,underscore.toArray(arguments));if(underscore.indexOf(["agent_message","agent_service_message"],e)>=0){u.startBlink();if(this.isVisitorsInsight()&&t.msg_id&&t.msg_id===1&&!this.invitationText&&config.contacts_ask===1){this.invitationText=t.message}}if(e==="accept"){this._chatAccepted()}}else{log("JIVO: unhandled "+e+" in "+this.state)}},iframe_url_change:function(e,t){log("iframe_url_change",e,t);this._changeBrowserLocation(e,t);n.sendIfConnected({name:"url_change",url:e,title:setSubstrTitle(t)})},reopened_elsewhere:function(){log("reopened_elsewhere");u.stopBlink();this.gui.showWidget(false,true)},connect_failed:function(){this._forcedOffline="connect_failed";this.transition("OFFLINE");this.gui.handle("connect_failed")},force_offline:function(e){this._forcedOffline=e.err_code?e.err_code:e.name;this.transition("OFFLINE");this.gui.handle("connect_failed")},window_visible:function(){if(!n.isConnected()&&cookie("sess_id")){this.transition("CHECKING_SESSION")}},gui_start_call:function(){n.send({name:"request_call",want_call:1})},gui_agent_message_ack:function(e){log("jivo online gui_agent_message_ack");n.sendIfConnected({name:"agent_message_ack",ack_msg_ids:e})},gui_leave_msg:function(){this.gui.handle("gui_leave_msg")}},OFFLINE:{_onEnter:function(){u.stopBlink();this.gui.setOffline();chat_contents.init(config.chat_mode,this.open_params)},callback_invitation:function(e){var t=this.getCallWidget();if(t){t.handle("cw_show_form",{show_form:1,title:e.title})}h.trackCallWidgetInvitationShown(e.title)},gui_maximize:function(){h.trackOfflineFormOpenedByClick();this.gui.showChat(true)},gui_minimize:function(){this.gui.showWidget(true)},gui_callwidget:function(){this.gui.showCallWidget()},gui_offline_message:function(e){this._saveClientInfo(e);n.send({name:"offline_message",message:e.message,email:e.email,phone:e.phone,client_name:e.name,cap_symbols:e.cap_symbols,from_online:this._forcedOffline});this.transition("OFFLINE_WAIT")},gui_leave_msg:function(){this.gui.handle("gui_leave_msg")},api_open:function(){this.handle("gui_maximize")},window_visible:function(){var e=this.getCallWidget();if(!n.isConnected()&&cookie("sess_id")){this.transition("CHECKING_SESSION")}else if(!cookie("sess_id")&&this.gui.state==="CALLWIDGET"&&underscore.indexOf(["CALL","WAIT"],e.state)!==-1){e.handle("cw_call_end")}},"*":function(e,t){this.callWidgetEvents(e,t);this.updateHeight(e,t)}},OFFLINE_WAIT:{_onEnter:function(){this._scheduleEvent("message_timer",parseInt("5000")*1e3||5e3)},offline_ack:function(e){this._cancelEvent("message_timer");if(e.result==="ok"){h.trackOfflineMessageSent();this.gui.handle("offline_success");this.transition("OFFLINE");return}else if(e.result==="error"){if("cap_id"in e){this.gui.handle("offline_captcha",e);this.transition("OFFLINE");return}}this.gui.handle("offline_failed");this.transition("OFFLINE")},message_timer:function(){this.gui.handle("offline_failed");this.transition("OFFLINE")}},PROACTIVE:{gui_minimize:function(){h.trackProactiveInvitationRejected(this.ruleName);this.gui.showWidget(true);this.transition("ONLINE")},gui_message:function(e,t){this.createMagicIFrame();h.trackProactiveInvitationAccepted(this.ruleName);cookie("agent_info",[this.agentInfo.agent_id].join("$$"));if(this.isMobileOrTablet()){return}var i={name:"client_message",message:e};if(t){i=underscore.extend(i,t)}n.send(i);if(!i.implicit){this.gui.handle("gui_message",e);this.transition("ONLINE")}},gui_answer_proactive:function(){this.transition("STARTING_SESSION")},gui_maximize:function(){if(this.isMobileOrTablet()){h.trackProactiveInvitationAccepted(this.ruleName);this.transition("STARTING_SESSION")}},gui_introduced:function(e,t){this._sendIntroduce(e);if(!t){h.trackGaveContacts();this._callUserFunction("onIntroduction")}},window_visible:function(){if(!n.isConnected()&&cookie("sess_id")){this.transition("CHECKING_SESSION")}},api_open:function(e){this.transition("ONLINE");this.handle("api_open",e)},accept:function(){this.transition("ONLINE");this._chatAccepted()},cw_ping:function(e,t){this.transition("ONLINE");n.sendIfConnected({name:"cw_ping",title:underscore.toArray(arguments)[1]||false})},gui_agent_message_ack:function(e){n.sendIfConnected({name:"agent_message_ack",ack_msg_ids:e})}},STARTING_SESSION:{_onEnter:function(){log("STARTING_SESSION _onEnter");n.handle("startup")},startup_ok:function(){this.transition("ONLINE");this.gui.showChat(true,this.openParams)},gui_maximize:function(e){this.gui.showChat(true,e)}}}});var f=i.extend({namespace:"JIVOFRAMECONTAINER",JIVOFRAMECONTAINER_ID:"jivo-iframe-container",expandTo:false,TIMEOUT_TRANSITION:300,TIMEOUT_TRANSITION_DEBOUNCE:1,INPUT_MARGIN:10,INPUT_HEIGTH:30,MESSAGE_OFFLINE_HEIGHT:109,BUTTONS_HEIGHT:28,HEADER_OFFLINE_HEIGHT:60,INNER_PADDING:10,ADWORD_HEIGHT:30,MESSAGE_ONLINE_HEIGHT:84,HEADER_ONLINE_HEIGHT:75,AVATAR_MARGIN:20,MIN_HEIGHT:372,DESCRIPTION_MARGIN:20,CAPTCHA_OFFLINE_HEIGHT:284,initialize:function(){var e=this.element=window.parent.document.getElementById(this.JIVOFRAMECONTAINER_ID),t=this.innerChat=document.getElementById("inner-chat"),i=this.chatDiv=document.getElementById("jivo-chat"),n=this.jivoLeaf=document.getElementById("jivo-css-leaf"),o=this.widgetHeight=e.offsetHeight,s=this.widgetWidth=e.offsetWidth,a=this.widgetMarginBottom=e.style.marginBottom;addClass(i,"jivo-orientation-"+config.widget_orientation);prefixedEvent(e,"TransitionEnd",underscore.bind(this.handle,this,"animate_finished"))},initialState:"INITIALIZED",setHeight:function(e){this.element.style.height=e},setWidth:function(e){this.element.style.width=e},getOfflineFormHeight:function(){if(chat_view_offline&&chat_view_offline.cap_id){return this.CAPTCHA_OFFLINE_HEIGHT+"px"}var e=this.getOfflineDescriptionHeight();e+=this.MESSAGE_OFFLINE_HEIGHT+this.INNER_PADDING;if(config.contacts_settings.email.show||!config.contacts_settings.phone.show||!config.contacts_settings.phone.required){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.name.show){e+=this.INPUT_HEIGTH}if(config.contacts_settings.phone.show){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(!(config.options&8&&config.hide_ad)){e+=this.ADWORD_HEIGHT}if(config.contacts_settings.email.show&&config.contacts_settings.phone.show&&!config.contacts_settings.name.show){e-=this.INPUT_MARGIN}e+=this.INNER_PADDING;e+=this.HEADER_OFFLINE_HEIGHT;e+=this.BUTTONS_HEIGHT;return e+"px"},getOfflineDescriptionHeight:function(){var e=document.createElement("div"),t;e.style.position="absolute";e.style.fontSize="16px";e.style.fontFamily="Arial, sans-serif";e.style.lineHeight="19px";e.style.visibility="hidden";e.style.width="247px";if(chat_view_offline&&chat_view_offline.getFormView()){var i=chat_view_offline.getFormView().model;e.innerHTML=i.get("templateData.text")||i.get("templateData").text}window.parent.document.body.appendChild(e);t=e.offsetHeight+this.DESCRIPTION_MARGIN;window.parent.document.body.removeChild(e);return t},getOnlineFormHeight:function(){var e=this.MESSAGE_ONLINE_HEIGHT+this.INPUT_MARGIN;if(config.contacts_settings.email.show){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.name.show){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.contacts_settings.phone.show){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(config.departments){e+=this.INPUT_HEIGTH+this.INPUT_MARGIN}if(!(config.options&8&&config.hide_ad)){e+=this.ADWORD_HEIGHT}e+=this.INNER_PADDING;e+=this.HEADER_ONLINE_HEIGHT;e+=this.BUTTONS_HEIGHT;e+=this.AVATAR_MARGIN;return Math.max(this.MIN_HEIGHT,e)+"px"},setTransition:function(e){toggleClass(this.element,"jivo-no-transition",!e);return this},animate:function(e){this.setTransition(false).setTransition(true);var t=this.getChatPosition(),i=this.element.style;if(this.expandTo){t.height=this.expandTo+"px"}switch(config.widget_orientation){case"left":if(e==="expand"){i.marginLeft="30px";i.top="";i.bottom="0px";i.left=t.left;i.height=t.height;i.width="287px";i.marginBottom="0"}else if(e==="collapse"){i.marginLeft="0";i.left="0";i.marginBottom=this.widgetMarginBottom;if(config.widget_padding=="0"){i.bottom="100%"}else if(config.widget_padding=="50"){i.bottom="50%"}else if(config.widget_padding=="100"){i.bottom="10px"}i.height=this.widgetHeight+"px";i.width=this.widgetWidth+"px"}break;case"right":if(e==="expand"){i.marginRight="30px";i.marginBottom="0";i.top="";i.bottom="0px";i.right=t.right;i.height=t.height;i.width="287px"}else if(e==="collapse"){i.marginRight="0";i.left="auto";i.right="0";i.marginBottom=this.widgetMarginBottom;if(config.widget_padding=="0"){i.bottom="100%"}else if(config.widget_padding=="50"){i.bottom="50%"}else if(config.widget_padding=="100"){i.bottom="10px"}i.height=this.widgetHeight+"px";i.width=this.widgetWidth+"px"}break;case"top":if(e==="expand"){i.top="auto";i.bottom="0";i.height=t.height;i.width="287px";i.marginBottom="0";if(config.widget_padding=="0"){i.left=t.left}else if(config.widget_padding=="50"){i.margin="";if(!t.left&&!t.right){i.right="30px"}else{i.right=t.right}}else if(config.widget_padding=="100"){i.right=t.right}}else if(e==="collapse"){i.bottom="100%";i.marginBottom="-34px";if(config.widget_padding=="0"){i.right="";i.left="30px"}else if(config.widget_padding=="50"){i.left="";i.marginRight=this.widgetWidth/2*-1+"px";i.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){i.left="";i.right="30px"}i.height=this.widgetHeight+"px";i.width=this.widgetWidth+"px"}break;case"bottom":if(e==="expand"){i.height=parseInt(t.height)+"px";i.width="287px";if(config.widget_padding=="0"){i.left=t.left}else if(config.widget_padding=="50"){if(!t.left&&!t.right){i.right="30px";i.marginRight=""}else{i.right=t.right;i.margin=""}}else if(config.widget_padding=="100"){i.right=t.right}}else if(e==="collapse"){if(config.widget_padding=="0"){i.right="";i.left="30px"}else if(config.widget_padding=="50"){i.left="";i.marginRight=this.widgetWidth/2*-1+"px";i.right=config.widget_padding+"%"}else if(config.widget_padding=="100"){i.left="";i.right="30px"}i.height=this.widgetHeight+"px";i.width=this.widgetWidth+"px"}break}d.transferProportion({width:parseFloat(i.width),height:parseFloat(i.height)});this._scheduleEvent("animate_finished",this.TIMEOUT_TRANSITION)},getChatPosition:function(){var e={};if(config.chat_mode==="online"&&d.gui.mode!="offline"&&!chat_view_offline.getFormView()){if(cookie("left")){e.left=cookie("left")}if(cookie("right")){e.right=cookie("right")}if(cookie("height")&&config.contacts_ask!=1){e.height=parseInt(cookie("height"))+"px";if(parseInt(cookie("height"))<215)e.height=215+"px"}else if(1==config.contacts_ask){e.height=this.getOnlineFormHeight()}else{e.height="372px"}}else if(config.chat_mode==="offline"||d.gui.mode==="offline"||chat_view_offline.getFormView()){e.height=this.getOfflineFormHeight()}if(d.isTablet()&&!d.isSeparateWindow()){e.height="350px"}return e},states:{EXPANDED:{_onEnter:function(){this._scheduleEvent("reset",this.TIMEOUT_TRANSITION);this._cancelEvent("animate_finished");this.emit("expanded")},reset:"INITIALIZED"},COLLAPSED:{_onEnter:function(){switch(config.widget_orientation){case"top":{this.element.style.top="0";this.element.style.marginBottom="";break}}this.handle("reset");this._cancelEvent("animate_finished");this.emit("collapsed")},reset:"INITIALIZED"},INITIALIZED:{_onEnter:function(){log("JIVO_CONTAINER INITIALIZED")},expand:function(){this.animate("expand");this.transition("EXPANDING")},collapse:function(){this.animate("collapse");this.transition("COLLAPSING")}},EXPANDING:{animate_finished:"EXPANDED"},COLLAPSING:{animate_finished:"COLLAPSED"}}});var h={_yaCounter:false,_trackedEvents:[],_trackEvent:function(e,t){if(underscore.indexOf(this._trackedEvents,e)>=0){return}this._trackedEvents.push(e);log("ANALYTICS _trackEvent: "+e+"/"+t);var i=d.getPageWindow();if(typeof i._gaq!=="undefined"){i._gaq.push(["_trackEvent","JivoSite",e,t,undefined,true])}if(typeof i.ga==="function"){i.ga("send","event","JivoSite",e,t,{nonInteraction:1})}if(this._yaCounter){e=["Jivo"].concat(e.split(" ")).join("_");d.getPageWindow()[this._yaCounter].reachGoal(e)}},_setCustomVar:function(e,t){log("ANALYTICS _setCustomVar: "+e+"/"+t);var i=d.getPageWindow();if(typeof i._gaq!=="undefined"){i._gaq.push(["_setCustomVar",1,e,t,1])}if(typeof i.ga==="function"){i.ga("set",e,t)}if(this._yaCounter){var n={};n[e]=t;i[this._yaCounter].params(n)}},findYaCounter:function(){try{var e=d.getPageWindow();for(var t in e){if(t.indexOf("yaCounter")==0&&typeof e[t].reachGoal=="function"){this._yaCounter=t}}}catch(i){log("ANALYTICS: "+i.toString())}},trackChatOpenedByClick:function(){this._trackEvent("Chat requested","User clicked chat widget")},trackOfflineFormOpenedByClick:function(){this._trackEvent("Offline form shown","User offline form")},trackOfflineMessageSent:function(){this._trackEvent("Offline message sent","User sent message via offline form")},trackProactiveInvitationShown:function(e){this._trackEvent("Proactive invitation shown",e)},trackProactiveInvitationAccepted:function(e){this._trackEvent("Proactive invitation accepted",e)},trackProactiveInvitationRejected:function(e){this._trackEvent("Proactive invitation rejected",e)},trackChatConnected:function(){this._trackEvent("Chat established","User connected to agent")},trackGaveContacts:function(){this._trackEvent("User gave contacts during chat","User gave contacts during chat")},trackCallWidgetInvitationShown:function(e){this._trackEvent("Callback invitation shown",e)},trackCallWidgetRequested:function(e){this._trackEvent("Callback requested",e)},setABTestGroupContacts:function(e,t){this._setCustomVar(e,t)}};h.findYaCounter();var p=window.jivo_api=window.parent.jivo_api={open:function(e){var t=d.getCallWidget();if(typeof e==="object"&&e.start==="call"&&t){callWidgetPing(underscore.bind(function(i){if(i.show_form&&d.gui.state==="WIDGET"){d.handle("cw_show_form",{show_form:1})}else{d.handle("api_open",e)}t.analyticsTitle="apiCall"},this),{title:false,invitation:"jivo_api.open"})}else{d.handle("api_open",e)}},getContactInfo:function(){var e={};underscore.each(utils.fields,function(t){if(cookie(t)){e[t==="client_name"?"name":t]=cookie(t)}});return e},getVisitorNumber:function(e){var t=cookie("client_id");if(t&&t.indexOf(".")>0&&typeof e==="function"){setTimeout(function(){e(null,t.split(".").shift())},0);return}getJSONPWithData(chatServerUrl(config.widget_id,config.site_id),{name:"visitor_number"},function(t){if(typeof t==="object"&&t.result&&"client_id"in t){cookie("client_id",t.client_id,{expires:365,path:"/"});if(typeof e==="function"){e(null,t.client_id.split(".").shift());return}e(new Error("Error fetching visitor number"))}})},setUserToken:function(e){if(typeof e==="string"||e instanceof String){n.setUserToken(e)}},setCustomData:function(e){if(Object.prototype.toString.call(e)==="[object Array]"){n.setCustomData(e)}},sendMessage:function(e,t){if(Object.prototype.toString.call(e)==="[object Object]"){setImplicitGuiMessage(e,t+" \n")}},setContactInfo:function(e){if(e&&typeof e==="object"){for(var t in e){var i=e[t],n={},o=false;if(underscore.find(utils.fields,function(e){return e==="client_name"?t==="name":e===t})&&!cookie(t==="name"?"client_name":t)&&utils["isValidValue_"+t](i)){n[t]=i;o=true}if(o){d.handle("gui_introduced",n,true)}}}},showProactiveInvitation:function(e,t){a.showProactive(e,t,"jivo_api.showProactiveInvitation")},highlightCobrowse:function(e){d.handle("highlight_cobrowse",e)},setRules:function(e){if(e&&typeof e==="object"){config.rules=e}},chatMode:function(){return config.chat_mode}};var g=function(){var e=d.getPageWindow().document||document,t=underscore.bind(e.querySelectorAll,e),i=t("form");log("JIVO OBSERVER, FORMS:",i);function n(e){log("JIVO SUBMIT EVENT",e);var t=e.target;var i="Form"+(t.id?' id="'+t.id+'"':"")+(t.action?' action="'+t.action+'"':"")+" submitted: \n";var n={};underscore.each(t.elements,function(e){if(e.name){n[e.name]=e.value}},this);setImplicitGuiMessage(n,i)}underscore.each(i,function(e){if(e.elements.length>0&&!underscore.findWhere(e.elements,{type:"password"})){log("FORM Observer: ",e);addListener(e,"submit",n);var t=e.submit;e.submit=function(){try{n({target:this})}catch(e){reportException(e)}t.call(this)}}})};var m={frm:0,create:function(){if(config.disable_iframe){log("Magic iframe is disabled");return}if(this.frm){log("Magic iframe already created");return}if(cookie("mframe")){log("Magic iframe create cancelled, page may be protected from iframe");return}cookie("mframe",1);log("Creating iframe");window.parent.jivo=d;var e=window.parent.document.createElement("iframe");e.setAttribute("id","jivo_magic_iframe");e.setAttribute("class","jivo-frame-hidden");e.setAttribute("frameborder","0px");e.setAttribute("name","col_old_page");window.parent.document.body.appendChild(e);e.contentWindow.location=window.parent.window.location;this.frm=e;setIframeLoadCallback(e,underscore.bind(this.onFrameLoaded,this))},onFrameLoaded:function(){log("Magic frame content loaded. Time to show the frame...");var e=document.getElementById("jivo_top_wrap");window.parent.document.body.setAttribute("id","jivo_outer_body");window.parent.document.body.style.overflow="hidden";window.parent.document.body.scroll="no";var t=window.parent.document.getElementsByTagName("iframe");for(var i=0;i<t.length;i++){var n=t[i];if(n.id!="jivo_magic_iframe"&&n.id!="jivo_container"){n.style.display="none"}}this.frm.setAttribute("class","jivo-frame-visible");this.frm.style.display="block";if(this.hasScroll().vScrollbar){var o=this.getScrollBarWidth()+"px";log("Adjusting right margin. Scroll width="+o);document.getElementById("jivo-chat").style.marginRight=o;document.getElementById("jivo-label").style.marginRight=o}this.syncPageScroll()},navigate:function(e){log("navigating iframe to ",e);this.frm.contentDocument.location.href=e},getDoc:function(){var e=this.frm.contentWindow.document;if(!e)e=this.frm.contentDocument;if(!e){log("Cannot find document!! :(");return 0}return e},syncPageScroll:function(){var e=0,t=0;var i=window.parent.window;if(typeof i.pageYOffset=="number"){t=i.pageYOffset;e=i.pageXOffset}else if(i.document.body&&(i.document.body.scrollLeft||i.document.body.scrollTop)){t=i.document.body.scrollTop;e=i.document.body.scrollLeft}else if(i.document.documentElement&&(i.document.documentElement.scrollLeft||i.document.documentElement.scrollTop)){t=i.document.documentElement.scrollTop;e=i.document.documentElement.scrollLeft}log("scroll pos x="+e+" y="+t);this.frm.contentWindow.scrollTo(e,t)},getScrollBarWidth:function(){var e=document.createElement("div");e.style.visibility="hidden";e.style.width="100px";document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var i=document.createElement("div");i.style.width="100%";e.appendChild(i);var n=i.offsetWidth;e.parentNode.removeChild(e);return t-n},hasScroll:function(){var e={vScrollbar:true,hScrollbar:true};try{var t=document.compatMode=="BackCompat"?document.body:document.documentElement;e.vScrollbar=t.scrollHeight>t.clientHeight;e.hScrollbar=t.scrollWidth>t.clientWidth}catch(i){}return e}};(function(e,t){e.VMasker=t()})(this,function(){var e="9",t="A",i="S",n=[8,9,16,17,18,36,37,38,39,40,91,92,93],o=function(e){for(var t=0,i=n.length;t<i;t++){if(e==n[t]){return false}}return true},s=function(e){e=e||{};e={precision:e.hasOwnProperty("precision")?e.precision:2,separator:e.separator||",",delimiter:e.delimiter||".",unit:e.unit&&e.unit.replace(/[\s]/g,"")+" "||"",suffixUnit:e.suffixUnit&&" "+e.suffixUnit.replace(/[\s]/g,"")||"",zeroCents:e.zeroCents,lastOutput:e.lastOutput};e.moneyPrecision=e.zeroCents?0:e.precision;return e},a=function(n,o,s){for(;o<n.length;o++){if(n[o]===e||n[o]===t||n[o]===i){n[o]=s}}return n};var r=function(e){this.elements=e};r.prototype.unbindElementToMask=function(){for(var e=0,t=this.elements.length;e<t;e++){this.elements[e].lastOutput="";this.elements[e].onkeyup=false;this.elements[e].onkeydown=false;if(this.elements[e].value.length){this.elements[e].value=this.elements[e].value.replace(/\D/g,"")}}};r.prototype.bindElementToMask=function(e){var t=this,i=function(i){i=i||window.event;var n=i.target||i.srcElement;if(o(i.keyCode)){setTimeout(function(){t.opts.lastOutput=n.lastOutput;n.value=l[e](n.value,t.opts);n.lastOutput=n.value;if(n.setSelectionRange&&t.opts.suffixUnit){n.setSelectionRange(n.value.length,n.value.length-t.opts.suffixUnit.length)}},0)}d.cw.callwidget.checkTel(i)};for(var n=0,s=this.elements.length;n<s;n++){this.elements[n].lastOutput="";this.elements[n].onkeyup=i;if(this.elements[n].value.length){this.elements[n].value=l[e](this.elements[n].value,this.opts)}}};r.prototype.maskMoney=function(e){this.opts=s(e);this.bindElementToMask("toMoney")};r.prototype.maskNumber=function(){this.opts={};this.bindElementToMask("toNumber")};r.prototype.maskAlphaNum=function(){this.opts={};this.bindElementToMask("toAlphaNumeric")};r.prototype.maskPattern=function(e){this.opts={pattern:e};this.bindElementToMask("toPattern")};r.prototype.unMask=function(){this.unbindElementToMask()};var l=function(e){if(!e){throw new Error("VanillaMasker: There is no element to bind.")}var t="length"in e?e.length?e:[]:[e];return new r(t)};l.toMoney=function(e,t){t=s(t);if(t.zeroCents){t.lastOutput=t.lastOutput||"";var i="("+t.separator+"[0]{0,"+t.precision+"})",n=new RegExp(i,"g"),o=e.toString().replace(/[\D]/g,"").length||0,a=t.lastOutput.toString().replace(/[\D]/g,"").length||0;e=e.toString().replace(n,"");if(o<a){e=e.slice(0,e.length-1)}}var r=e.toString().replace(/[\D]/g,""),l=new RegExp("^(0|\\"+t.delimiter+")"),c=new RegExp("(\\"+t.separator+")$"),u=r.substr(0,r.length-t.moneyPrecision),d=u.substr(0,u.length%3),f=new Array(t.precision+1).join("0");u=u.substr(u.length%3,u.length);for(var h=0,p=u.length;h<p;h++){if(h%3===0){d+=t.delimiter}d+=u[h]}d=d.replace(l,"");d=d.length?d:"0";if(!t.zeroCents){var g=r.length-t.precision,m=r.substr(g,t.precision),v=m.length,_=t.precision>v?t.precision:v;f=(f+m).slice(-_)}var w=t.unit+d+t.separator+f+t.suffixUnit;return w.replace(c,"")};l.toPattern=function(n,o){var s=typeof o==="object"?o.pattern:o,r=s.replace(/\W/g,""),l=s.split(""),c=n.toString().replace(/\W/g,""),u=c.replace(/\W/g,""),d=0,f,h=l.length,p=typeof o==="object"?o.placeholder:undefined;for(f=0;f<h;f++){if(d>=c.length){if(r.length==u.length){return l.join("")}else if(p!==undefined&&r.length>u.length){return a(l,f,p).join("")}else{break}}else{if(l[f]===e&&c[d].match(/[0-9]/)||l[f]===t&&c[d].match(/[a-zA-Z]/)||l[f]===i&&c[d].match(/[0-9a-zA-Z]/)){l[f]=c[d++]}else if(l[f]===e||l[f]===t||l[f]===i){if(p!==undefined){return a(l,f,p).join("")}else{return l.slice(0,f).join("")}}}}return l.join("").substr(0,f)};l.toNumber=function(e){return e.toString().replace(/(?!^-)[^0-9]/g,"")};l.toAlphaNumeric=function(e){return e.toString().replace(/[^a-z0-9 ]+/i,"")};return l});var v={callWidgetForm:underscore.template(["<div class='jivo-call-form jivo-call-form-low' style='display:none;'>","<div class='jivo-form-box'>","<div class='jivo-form-inner' style='display: none;'>","<a href='#' title='"+translate("cw_close")+"' class='jivo-close-form'></a>","<div class='jivo-form-header'>","<div class='jivo-form-low-phone'></div>","<div class='jivo-call-text'>","<span class='jivo-text-center'>"+translate("cw_weRecallAfter")+" <span class='jivo-text-time'>28</span> <span class='jivo-text-sec'>"+translate("cw_seconds")+"</span>!</span>","</div>","</div>","<div class='jivo-error-header'>","<div class='jivo-title-ce'>"+translate("cw_unableToConnect")+"</div>","<div class='jivo-call-repeat'>","<div class='jivo-err-info'>"+translate("cw_errInfoText")+"</div>","</div>","</div>","<div id='jivo-call-form'>","<div class='jivo-call-form-shadow'>","<div class='jivo-tel-box'>","<div class='jivo-tel-placeholder'>"+translate("cw_enterPhonePlaceholder")+"</div>","<span class='jivo-tel-pre-code'>+7</span><!--input id='jivo-call-code' type='tel' name='jivo-code' maxlength='3' placeholder='___'/><span class='jivo-tel-after-code'>)</span-->","<input id='jivo-call-tel' type='tel' value='' name='jivo-tel' maxlength='12' placeholder='926 123 4567'/>","</div>","</div>","<a id='jivo-save-tel' title='"+translate("cw_callButtonText")+"'><i class='jivo-call-icon'></i>"+translate("cw_callButtonText")+"</a>","</div>","<div class='jivo-call-copy'>","<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>","</div>","<a href='http://jivosite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>","</div>","<div id='jivo-call-container'></div>","</div>","</div>"].join("\n")),callWidgetActions:underscore.template(["<div class='jivo-call-action jivo-hidden' style='display: none;'>","<div class='jivo-call-step jivo-call-wait'>","<div class='jivo-text-ca'>"+translate("cw_callAfter")+"</div>","<div id='jivo-timer-block' class='jivo-timer-block'>","<div class='jivo-call-loader' data-anim='base wrapper'>","<div class='jivo-call-circle' data-anim='base left'></div>","<div class='jivo-call-circle' data-anim='base right'></div>","</div>","<div class='jivo-action-timer'>","<span id='jivo-time' class='jivo-time'>28</span>","</div>","</div>"+translate("cw_seconds")+"</div>","<div class='jivo-call-step jivo-call-connecting'>","<div class='jivo-call-box-wrap'>","<div class='jivo-circle jivo-anim-circle'></div><div class='jivo-circle jivo-anim-circle2'></div>","<div class='jivo-call-box'>","<i class='jivo-connecting-icon'><i class='jivo-anim-wait'></i></i>","</div>","</div>","<div class='jivo-text-conn'>"+translate("cw_connecting")+"</div>","</div>","<div class='jivo-call-step jivo-call-connected'>","<div class='jivo-call-box'>","<div class='jivo-call-up'>","<i class='jivo-calling-icon'></i>translate('cw_weCalling')<br>","<span class='jivo-calling-up-phone'>"+translate("cw_pickUpPhone")+"</span>","</div>","<div class='jivo-call-online'>","<div class='jivo-operator-icon'>","<img id='jivo-operator-icon' src='"+config.base_url+"/images/jivo-ico-operator.png' alt=''/>","<i class='jivo-operator-icon-mobile'></i>","</div>","<div class='jivo-operator-name'>","Константин<br>","Манженко","<small>Менеджер-консультант</small>","</div>","<div class='jivo-connected-show-chat'>"+translate("cw_chat")+"</div>","</div>","<div class='jivo-call-end'>","<a href='#' class='jivo-close-form'></a>","<div class='jivo-end-box'>","<div class='jivo-thx-text'>"+translate("cw_thxForCall")+"</div>","<a href='#' class='jivo-btn-recall'>"+translate("cw_repeatCallAgain")+"</a>","<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>","</div>","</div>","</div>","</div>","<a href='http://jivosite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>","</div>","<div class='jivo-call-error jivo-call-step' style='display: none;'>","<div class='jivo-end-close'></div>","<div class='jivo-title-ce'>"+translate("cw_unableToConnect")+"</div>","<div class='jivo-call-repeat'>","<div class='jivo-err-info'>"+translate("cw_errInfoText")+"</div>","</div>","<div id='jivo-call-form'>","<div class='jivo-call-form-shadow'>","<div class='jivo-tel-box'>","<div class='jivo-tel-placeholder'>"+translate("cw_enterPhonePlaceholder")+"</div>","<span class='jivo-tel-pre-code'>+7</span><!--input id='jivo-call-code' type='tel' name='jivo-code' maxlength='3' placeholder='___'/><span class='jivo-tel-after-code'>)</span-->","<input id='jivo-call-tel' type='tel' name='jivo-tel' maxlength='12' placeholder='926 123 4567'/>","</div>","</div>","<a id='jivo-save-tel' title='"+translate("cw_callButtonText")+"'><i class='jivo-call-icon'></i>"+translate("cw_callButtonText")+"</a>","</div>","<div class='jivo-call-copy'>","<a href='#' class='jivo-start-chat'><i class='jivo-ico-start-chat'></i>{{ sendMessage }}</a>","</div>","<a href='http://jivosite.ru/?utm_source=megashop.ru&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad' target='_blank' title='Jivosite' class='jivo-logo'><span class='j1'>jivo</span><span class='j2'>site</span></a>","<div class='jivo-report-form'>","<p>"+translate("cw_reportPlaceholder")+"</p>","<!--div class='jivo-text-right'>","<a href='#' class='jivo-btn jivo-btn-report'>"+translate("cw_textSend")+"</a>","</div-->","</div>","</div>"].join("\n"))};var _=i.extend({initialState:"CLOSED",namespace:"CALLWIDGET",formType:2,templateForm:v.callWidgetForm,templateCall:v.callWidgetActions,containerForm:"jivo-form-container",containerCall:"jivo-call-container",form:null,call:null,phone:0,timer:0,clickClosedForm:true,initTel:function(){var e=this.phone=document.getElementById("jivo-call-tel");var t=cookie("phone"),i;if(t){t=t.substring(2,12);i=document.getElementById("jivo-call-tel");i.value=t;removeClass(i,"jivo-disabled")}this.actionForElements(".jivo-start-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideCallWidget();this.guiMaximize()},this)});this.initMask()},checkTel:function(e){var t=this.phone=document.getElementById("jivo-call-tel");var i=e.keyCode||e.whitch;if(t.value.toString().length===12){removeClass(t,"jivo-disabled")}if(i===13){document.getElementById("jivo-save-tel").click()}},initMask:function(){VMasker(this.phone).maskPattern("999 999 9999")},guiMaximize:function(){d.isClicked=true;d.handle("gui_maximize")},actionForElements:function(t,i){if(t.charAt(0)==="."){underscore.each(e(t.substr(1)),i,this)}else{underscore.each([document.getElementById(t.substr(1))],i,this)}},showElement:function(e){if(!underscore.isArray(e)){var t=[];t.push(e);e=t}underscore.each(e,function(e){this.actionForElements(e,function(e){e.style.display="block"})},this)},hideElement:function(e){if(!underscore.isArray(e)){var t=[];t.push(e);e=t}underscore.each(e,function(e){this.actionForElements(e,function(e){e.style.display="none"})},this)},addClass:function(e,t){this.actionForElements(e,function(e){addClass(e,t)})},removeClass:function(e,t){this.actionForElements(e,function(e){removeClass(e,t)})},showAction:function(){this.showElement(".jivo-call-action")},drawTimer:function(t){var i=360/100*t,n=".jivo-call-loader",o="jivo-call-circle";if(t>50){this.addClass(n,"gt50");underscore.each(e(o),function(e,t){if(t===1){addClass(e,"fill")}},this)}else{this.removeClass(n,"gt50");underscore.each(e(o),function(e,t){if(t===1){removeClass(e,"fill")}},this)}this.actionForElements("."+o,function(e){e.style.webkitTransform="rotate("+i+"deg)";e.style.MozTransform="rotate("+i+"deg)";e.style.msTransform="rotate("+i+"deg)";e.style.OTransform="rotate("+i+"deg)";e.style.transform="rotate("+i+"deg)"})},center:function(e){e.css({position:"fixed",top:"50%",left:"50%",margin:"-"+282/2+"px 0 0 -"+e.width()/2+"px"})},secOfNum:function(e){var t=[translate("cw_form_second"),translate("cw_form_seconds"),translate("cw_form_secondd")],i=[2,0,1,1,1,2];return t[e%100>4&&e%100<20?2:i[e%10<5?e%10:5]]},initialize:function(){if(document.getElementById(this.containerCall)){log("JivoCall already initialized.")}else{var e=config.chat_mode==="online"?translate("cw_typeInChat"):translate("lblLeaveMessage"),t={sendMessage:e};this.form=document.createElement("div");this.form.setAttribute("id",this.containerForm);this.form.innerHTML=this.templateForm(t);d.gui._wrapDiv.appendChild(this.form);this.call=document.getElementById(this.containerCall);this.call.innerHTML=this.templateCall(t);this.actionForElements(".jivo-call-form",function(e){e.onclick=underscore.bind(function(e){if(e){e.preventDefault();e.stopPropagation()}this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-form-box",function(e){e.onclick=underscore.bind(function(e){if(e){e.stopPropagation()}},this)})}underscore.each(["cw_wait","cw_connecting","cw_calling","cw_connected","cw_error","cw_call_end","cw_show_form"],underscore.bind(function(e){d.on(e,underscore.bind(function(t){this.handle(e,t)},this))},this));d.on("startup_ok",underscore.bind(function(e){if(this.resumed_context.client_info.cw_call){this.handle(this.resumed_context.client_info.cw_call.status,e)}},this));this.initTel();this.actionForElements(".jivo-close-form",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();$("#jivo-iframe-container",window.parent.document).removeClass("jivo-callwidget");$("#jivo-iframe-container",window.parent.document).addClass("jivo-closing");this.transition("FORMHIDDEN")},this)});this.actionForElements("#jivo-save-tel",function(e){e.onclick=underscore.bind(this.clickTel,this)});this.actionForElements(".jivo-call-close",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-btn-recall",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideElement(".jivo-call-error");this.transition("FORMVISIBLE")},this)});this.actionForElements(".jivo-btn-start-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideElement(".jivo-call-end");this.transition("FORMHIDDEN");this.guiMaximize()},this)});this.actionForElements(".jivo-end-close",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.clickClosedForm=true;this.hideElement(".jivo-call-end");this.removeClass(".jivo-call-error","jivo-error-visible");setTimeout(underscore.bind(function(){this.hideElement(".jivo-call-error")},this),200);this.transition("FORMHIDDEN")},this)});this.actionForElements(".jivo-btn-report",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideElement(".jivo-call-error");this.showLabel();d.handle("gui_maximize")},this)});this.actionForElements(".jivo-connected-show-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();this.hideCallWidget();d.gui.enableAnimation(false);this.guiMaximize()},this)});this.actionForElements(".jivo-show-chat",function(e){e.onclick=underscore.bind(function(e){e.preventDefault();d.gui.enableAnimation(false);this.guiMaximize()},this)});this.trackLogo();if(!utils.showAd()){this.addClass(".jivo-logo","jivo-hide")}},trackLogo:function(){var e="https://www.jivochat.com/",t=jivo_config.locale;if(t==="ru_RU"){e="http://www.jivosite.ru/"}else if(t==="pt_PT"||t==="pt_BR"){e="http://www.jivochat.com.br"}this.actionForElements(".jivo-logo",function(t){t.setAttribute("href",e+"calls?utm_source="+window.location.host+"&utm_medium=link&utm_content=callback_popup&utm_campaign=self_ad")})},clickTel:function(e){e.preventDefault();var t=document.getElementById("jivo-call-tel").value.replace(/\D/g,"");if(t.toString().length===10){removeClass(this.phone,"jivo-disabled");this.phone_number="+7"+t.toString();this.setTimerNull();this.transition("FORMANIMATE")}else{addClass(this.phone,"jivo-disabled");this.phone.focus()}},setTimerNull:function(){clearInterval(this.timer);cookie("cw_timer",null);this.removeClass(".jivo-timer-block","jivo-timer-show")},hideCallWidget:function(){var e=".jivo-call-form";this.hideElement(e);this.actionForElements(e,function(e){e.style.bottom="-350px";e.style.top="auto"});this.showElement(e)},showCallWidget:function(){var e=".jivo-call-form";this.hideElement(e);this.actionForElements(e,function(e){e.style.bottom="0px";e.style.top="auto"});this.showElement(e)},handlePhantomTranstion:function(e){if(this.state==="CLOSED"||this.state==="FORMVISIBLE")return;if(e.action==="COLLAPSING.animate_finished"){this.showCallWidget();setTimeout(function(){d.gui.widget.handle("hide")},50)}if(e.action==="EXPANDING.animate_finished"){this.hideCallWidget()}},showLabel:function(){d.gui.showLabelForCallWidget();d.handle("gui_minimize")},hideLabel:function(){d.handle("gui_callwidget")},states:{CLOSED:{_onEnter:function(){this.hideElement(".jivo-call-action");this.hideCallWidget();log(d.state,d.gui.widget.state,d.gui.state);if(d.gui.state==="CALLWIDGET"){this.showLabel()}},cw_show_form:function(e){this.showform=e;if(this.currentState==="cw_wait"){this.handle("cw_wait",e);return}if(this.showform.show_form===1){this.transition("FORMVISIBLE")}else{}},start_timer:"WAIT",cw_connecting:function(){this.currentState="cw_connecting";this.transition("CALL")},cw_connected:function(){this.currentState="cw_connected";this.transition("CALL")},cw_wait:function(){cookie("cw_timer",null);this.transition("WAIT")},setPhoneNumber:function(e){this.phone.value=e.replace(/^8|^\+7|^7/,"");this.initMask();this.analyticsTitle="phoneEnter";document.getElementById("jivo-save-tel").click()}},FORMVISIBLE:{_onEnter:function(){this.hideLabel();clearInterval(this.timer);this.currentState="";this.clickClosedForm=false;this.hideElement([".jivo-call-action",".jivo-call-error"]);this.actionForElements(".jivo-text-time",function(e){e.innerHTML=this.seconds});this.actionForElements(".jivo-text-sec",function(e){e.innerHTML=this.secOfNum(this.seconds)});this.hideElement(".jivo-error-header");this.showElement([".jivo-form-inner",".jivo-form-header",".jivo-form-low-phone",".jivo-logo"]);if(this.formType===1)this.center(this.form.find(".jivo-form-box"));this.actionForElements(".jivo-call-form",function(e){e.style.height="350px";d.gui.jivoframecontainer.setHeight("350px")});if(this.showform){if(this.showform.title&&typeof this.showform.title==="string"){telemetry("show_call_widget_invitation");this.actionForElements(".jivo-text-center",function(e){e.innerHTML=this.showform.title;this.analyticsTitle=this.showform.title})}else{telemetry("show_call_widget")}this.hideCallWidget();setTimeout(underscore.bind(function(){this.showCallWidget()},this),50)}this.actionForElements(".jivo-call-form",function(e){e.style.display="block"});this.actionForElements(".jivo-form-box",function(e){e.style.opacity="1"});this.showElement(".jivo-form-box")},cw_show_form:function(e){if(e.show_form){this.hideLabel();this.showCallWidget()}},cw_wait:function(){this.transition("WAIT")},start_timer:"WAIT",CLOSED:"CLOSED"},FORMHIDDEN:{_onEnter:function(){this.actionForElements(".jivo-call-form",function(e){e.style.bottom="-350px"});setTimeout(underscore.bind(function(){this.transition("CLOSED");this.showLabel();$("#jivo-iframe-container",window.parent.document).removeClass("jivo-closing")},this),200)}},FORMANIMATE:{_onEnter:function(){this.showElement(".jivo-call-action");this.actionForElements(".jivo-call-action",function(e){e.style.opacity="1"});this.handle("animatefinished")},animatefinished:function(){cookie("phone",this.phone_number);this.transition("WAIT");if(this.showform&&this.showform.title&&typeof this.showform.title==="string"){d.handle("cw_call",{tel:this.phone_number,invitation_text:this.showform.title})}else{d.handle("cw_call",{tel:this.phone_number})}},cw_error:function(){this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")}},WAIT:{"*":function(e){this.emit.apply(this,underscore.toArray(arguments))},_onEnter:function(){this.hideLabel();this.showElement(".jivo-logo");clearInterval(this.timer);if(this.analyticsTitle){h.trackCallWidgetRequested(this.analyticsTitle)}this.handle("cw_wait")},cw_wait:function(){if(hasClass(document.getElementById("jivo-timer-block"),"jivo-timer-show")){return}this.removeClass(".jivo-timer-block","jivo-timer-show");this.hideElement([".jivo-form-inner",".jivo-call-action",".jivo-call-error"]);this.showElement(".jivo-call-form");this.actionForElements(".jivo-call-form",function(e){e.style.bottom="0px";e.style.top="auto"});this.hideElement(".jivo-form-header");this.showElement("#"+this.containerCall);this.actionForElements(".jivo-call-wait",function(e){e.style.opacity="0"});this.hideElement([".jivo-call-step",".jivo-call-loader"]);this.showElement([".jivo-call-action",".jivo-call-wait",".jivo-call-loader",".jivo-form-low-phone"]);this.addClass(".jivo-timer-block","jivo-timer-show");if(this.seconds){this.handle("start_timer",this.seconds)}},_onExit:function(){},start_timer:function(e){this.actionForElements("#"+this.containerForm,function(e){e.style.opacity="1"});e=this.seconds;this.showElement(".jivo-call-wait");var t=e*1e3;var i=document.getElementById("jivo-time");i.innerHTML=t/1e3;clearInterval(this.timer);this.timer=setInterval(underscore.bind(function(){if(!cookie("cw_timer")){cookie("cw_timer",(new Date).getTime())}else{var e=parseInt((new Date).getTime())-parseInt(cookie("cw_timer"));t=this.initTimer*1e3-e;t=(t/1e3).toFixed(1)*1e3;if(t<=0){clearInterval(this.timer);this.timer=false;this.handle("timer_finished");return}}this.actionForElements(".jivo-call-wait",function(e){e.style.opacity="1"});if(t/1e3%1===0&&Number(t)===t){i.innerHTML=t/1e3+".0"}else{i.innerHTML=t/1e3}var n=100-t/1e3/this.initTimer*100;this.drawTimer(n);t=t-100;if(t<=0){i.innerHTML=t;clearInterval(this.timer);this.timer=false;this.handle("timer_finished")}},this),100)},timer_finished:function(){this.handle("cw_connecting")},cw_connecting:function(e){this.agent_info=e;this.transition("CALL")},cw_connected:function(){this.currentState="cw_connected";this.transition("CALL")},cw_error:function(e){if(e&&e.reason){this.error_reason=e.reason}this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")}},CALL:{_onEnter:function(){this.showElement("#"+this.containerCall);this.hideElement(".jivo-form-inner");this.showElement(".jivo-call-form");this.actionForElements(".jivo-call-form",function(e){e.style.bottom="0px"});this.showElement(".jivo-logo");if(d.gui.state==="CHAT"){this.hideCallWidget()}else{this.hideLabel()}if(this.currentState){this.handle(this.currentState);this.currentState=false}else{this.handle("cw_connecting")}},cw_wait:function(e){this.handle("cw_connecting",e)},start_timer:function(){this.currentState="cw_wait";this.transition("WAIT")},timer_finished:function(){this.timer=false;this.handle("cw_connecting")},cw_connecting:function(e){if(!this.agent_info&&e){this.agent_info=e}d.gui.jivoframecontainer.setHeight("350px");this.removeClass(".jivo-call-error","jivo-error-visible");this.hideElement(".jivo-form-header");this.showAction();if(d.resumed_context&&d.resumed_context.agent_info){this.agent_info=d.resumed_context.agent_info}if(!this.timer){this.hideElement([".jivo-call-step",".jivo-call-end"]);this.actionForElements(".jivo-call-connected",function(e){e.setAttribute("style","")});this.removeClass(".jivo-call-box","jivo-operator-online");this.hideElement(".jivo-call-online");this.showElement([".jivo-form-low-phone",".jivo-call-connecting"])}},cw_connected:function(){clearInterval(this.timer);this.hideElement(".jivo-logo");if(d.resumed_context&&d.resumed_context.agent_info){this.agent_info=d.resumed_context.agent_info}d.gui.jivoframecontainer.setHeight("68px");if(this.agent_info){if(this.agent_info.avatar_url!=null){document.getElementById("jivo-operator-icon").setAttribute("src",jivo_config.avatar_url+"/avatars/"+this.agent_info.avatar_url)}else{document.getElementById("jivo-operator-icon").setAttribute("src",jivo_config.base_url+"/images/jivo-ico-operator.png")}if(this.agent_info.display_name)this.actionForElements(".jivo-operator-name",function(e){e.innerHTML=this.agent_info.display_name+" <small>"+this.agent_info.title+"</small>"})}this.hideElement([".jivo-form-header",".jivo-error-header",".jivo-form-low-phone",".jivo-call-step",".jivo-call-up",".jivo-call-end"]);this.showAction();this.showElement([".jivo-call-connected",".jivo-call-online"]);this.actionForElements(".jivo-call-form",function(e){e.style.height="68px"});this.handle("operator_online")},operator_online:function(){clearInterval(this.timer);this.showElement(".jivo-call-online");if(this.agent_info){if(this.agent_info.state===0){this.hideElement(".jivo-connected-show-chat")}else{this.showElement(".jivo-connected-show-chat")}}},cw_error:function(){this.transition("cw_error")},cw_call_end:function(){this.transition("cw_call_end")},CLOSED:function(){this.transition("CLOSED")},cw_show_form:"cw_connected"},cw_call_end:{_onEnter:function(){d.resumed_context=false;if(d.gui.state!=="CHAT"){this.hideLabel()}d.gui.jivoframecontainer.setHeight("350px");this.setTimerNull();this.showElement(".jivo-logo");this.hideElement([".jivo-form-header",".jivo-error-header",".jivo-form-low-phone",".jivo-call-step",".jivo-call-up"]);this.showElement(".jivo-call-connected");this.removeClass(".jivo-thx-text","jivo-thx-text-show");this.removeClass(".jivo-call-box","jivo-operator-online");this.addClass(".jivo-call-box","jivo-operator-call-end");this.hideElement([".jivo-call-online",".jivo-call-online"]);this.showElement(".jivo-call-end");this.actionForElements(".jivo-call-form",function(e){e.style.height="350px";this.addClass(".jivo-thx-text","jivo-thx-text-show")})},start_timer:function(){this.currentState="cw_wait";this.transition("WAIT")},cw_show_form:function(){this.transition("FORMVISIBLE")},cw_wait:function(){this.transition("wait")},CLOSED:"CLOSED",_onExit:function(){this.removeClass(".jivo-thx-text","jivo-thx-text-show")}},cw_error:{_onEnter:function(){this.hideLabel();d.resumed_context=false;this.setTimerNull();this.hideElement("#"+this.containerCall);this.hideElement(".jivo-form-header");this.showElement([".jivo-logo",".jivo-error-header",".jivo-form-inner"]);this.actionForElements("#jivo-call-tel",function(e){e.value=this.phone.value});this.hideElement([".jivo-call-step",".jivo-call-action"]);if(this.error_reason){this.actionForElements(".jivo-title-ce",function(e){e.innerHTML=translate(this.error_reason)});this.actionForElements(".jivo-err-info",function(e){e.innerHTML=""});delete this.error_reason}else{this.actionForElements(".jivo-title-ce",function(e){e.innerHTML=translate("cw_unableToConnect")});this.actionForElements(".jivo-err-info",function(e){e.innerHTML=translate("cw_errInfoText")})}setTimeout(underscore.bind(function(){this.addClass(".jivo-call-error","jivo-error-visible")},this),5)},cw_show_form:"FORMVISIBLE"}}})})();var coBrowserIframeCreater=window.parent.coBrowserIframeCreater=function(){var e,t,i=false,n=[],o=false,s,a={},r=function(e,t){s=setTimeout(function(){i=true;r()},5);if(!i){n.push({name:e,params:t});return}if(n.length){var l=n.shift();e=l.name;t=l.params}var c;if(o){log("controller of childSandboxBridge set as for NodeWebkit");c=jqueryFrameControllerForAir;c.setLangpack(a);c.init()}else{c=jqueryFrameController}if(c[e]&&e!="is_node_webkit"){clearInterval(s);c[e](t)}if(n.length){r()}};addListener(window.parent,"message",function(i){if(!i){log("Error receive postMessage, window message event is empty.");return}var n=i.data;n.langpack=JSON.parse(cookie("langpack"));if(underscore.indexOf(["startSelection","stopSelection","in_node_webkit"],n.name)!==-1&&i.source&&i.origin){e=i.source;t=i.origin;o=true;a=n.langpack;r(n.name,n)}},false);return{process:function(e,t){r(e,t)},postMessage:function(e){setTimeout(function(){window.parent.jivo_cobrowse.source.postMessage(e,window.parent.jivo_cobrowse.origin)},0)},isNodeWebkit:function(){return o}}}();var lblDefaultCobrowseComment=translate("lblDefaultCobrowseComment");(function(e){var t=function(e){if(typeof console==="object"&&console.log){console.log(e)}else{coBrowserIframeCreater.postMessage({name:"log",text:e})}};window.jqueryFrameController={is_inited:false,highlight:function(t){if(!this.is_inited){var i=window.document.createElement("link");i.setAttribute("rel","stylesheet");i.setAttribute("href",staticUrl("/css/for_air.css"));e.body.appendChild(i);this.is_inited=true}var n=typeof t.element=="string"?$(t.element,e):t.element;if($("#jivo_cobrowsing_element_id_"+t.hash,e).length>0){return this.animateScroll(t)}$(".jivo_cobrowsing_element",e).remove();$(".jivo_cobrowsing_tooltip",e).remove();var o=n.offset(),s=n.outerWidth(),a=n.outerHeight();if(n){var r=$("<div/>",{"class":"jivo_cobrowsing_element",id:"jivo_cobrowsing_element_id_"+t.hash}).appendTo(n.parents("body"));r.css({top:o.top-3,left:o.left-12,height:a+10,width:s+10});$("<div/>",{"class":"jivo_cobrowsing_element_inner"}).appendTo(r)}var l=function(){var e=n.offset(),t=n.outerWidth(),i=n.outerHeight();r.css({top:e.top-3,left:e.left-12,height:i+10,width:t+10})};setInterval(function(){l()},50);return r},renderTooltip:function(t){var i=$("#jivo_cobrowsing_tooltip_"+t.hash,e);if(i.length>0){this.animateScroll(t);return i}var n=typeof t.element=="string"?$("#jivo_cobrowsing_element_id_"+t.hash,e):t.element,o=$("<div/>",{"class":""}).css({width:"100%",height:"auto"}),i=$("<div/>",{"class":"jivo_cobrowsing_tooltip",id:"jivo_cobrowsing_tooltip_"+t.hash});i.append(o);if(t.show)i=this.addTooltipContent(i,t,n);return i},appendTooltip:function(t,i){var n=t.children().first();t.appendTo($("body",e));_onResize=function(){n.addClass("bottom");n.removeClass("top left right");var e=30,o=i.outerWidth(),s=i.outerHeight(),a=i.offset(),r=a.left+o/2-e/2,l=a.top-e+15,c=t.width()/2*-1;if(l<n.height()+10){l=a.top+s;n.addClass("top")}else{n.css({position:"absolute",bottom:"0px"})}if(r+c<10){r=a.left;c=0;n.addClass("left")}if(r+t.outerWidth()>$(window.parent.window).outerWidth()){c=t.width()*-1;r=a.left+o-e;n.addClass("right")}t.css({left:r,top:l,"margin-left":c})};_onResize();t.animate({opacity:1},150);this.animateScroll(null,i,n);setInterval(function(){_onResize()},50)},addTooltipContent:function(t,i,n){var o=t.find(":first-child");var s=jivo_config.options&32&&typeof i.agent.avatar_url=="string"&&i.agent.avatar_url.length>0;if(s){if(jivo_config.avatar_url)i.agent.avatar_url=jivo_config.avatar_url+"/avatars/"+i.agent.avatar_url}var a=$("<div/>",{id:"jivo_action"}).appendTo(o);$("<div/>",{id:"jivo_close_button"}).appendTo(a);$("<div/>",{text:i.agent.display_name,"class":"jivo_cobrowsing_tooltip_agent"}).appendTo(o);$("<div/>",{html:i.comment.split("\n").join("<br />"),"class":"jivo_cobrowsing_tooltip_text"}).appendTo(o);a.find("div").bind("click",function(){switch($(this).attr("id")){case"jivo_close_button":$("#jivo_cobrowsing_element_id_"+i.hash,e).remove();jivo.handle("gui_close_cobrowse",i.hash);t.remove();break}});this.appendTooltip(t,n);return t},animateScroll:function(t,i,n){if(t){var i=$("#jivo_cobrowsing_element_id_"+t.hash,e);var n=$("#jivo_cobrowsing_tooltip_"+t.hash,e).find("div:first-child")}if(n&&n.hasClass("top")){var o=i.offset().top}else{var o=n.offset().top}$("html, body",e).queue("fx",[]);$("html, body",e).animate({scrollTop:o-300},800);$(window,e).bind("scroll.jivo",function(e){e.preventDefault()});setTimeout(function(){$(window,e).unbind("scroll.jivo")},1e3)}};window.jqueryFrameControllerForAir={is_selecting:false,is_tooltip_open:false,is_inited:false,langpack:{},init:function(){if(!this.is_inited){var t=window.document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("href",staticUrl("/css/for_air.css"));e.body.appendChild(t);$(window,e).unbind("keydown").bind("keydown",function(e){if(e.keyCode==27){jqueryFrameControllerForAir.onEsc()}});this.is_inited=true}},setLangpack:function(e){this.langpack=e},i18n:function(e){return this.langpack[e]?this.langpack[e]:e},startSelection:function(){$("body",e).addClass("jivo_selecting");this.is_selecting=true;$("input, textarea, select, button",e).prop("disabled",true).each(function(){var t=$("<div/>"),i=$(this).offset(),n=$(this).outerWidth(),o=$(this).outerHeight();t.css({position:"absolute",top:i.top,left:i.left,width:n,height:o});t[0].realNode=this;$("body",e).append(t)});$("body *",e).on("mouseover.co_browser",function(e){if(this.tagName=="OPTION")return false;jqueryFrameControllerForAir.clearSelection();jqueryFrameController.highlight({element:$(e.target)});jqueryFrameControllerForAir.stopTagsA();$(e.target).unbind("click.co_browser").bind("click.co_browser",function(e){e.preventDefault();e.stopPropagation();var t=this.realNode?this.realNode:this;jqueryFrameControllerForAir.stopSelection();jqueryFrameControllerForAir.toolTip($(t))})});$("body *",e).on("mouseout.co_browser",function(e){jqueryFrameControllerForAir.clearSelection()})},stopTagsA:function(){$("body a",e).on("click.co_browser",function(e){e.preventDefault();e.stopPropagation();return false})},stopSelection:function(){$("body",e).removeClass("jivo_selecting");$("input, textarea, select, button",e).prop("disabled",false);$(".fake_cb_element",e).remove();$("body *",e).unbind("mouseover.co_browser").unbind("mouseout.co_browser").unbind("click.co_browser");jqueryFrameControllerForAir.clearSelection();this.is_selecting=false},clearSelection:function(){$("body .jivo_cobrowsing_element",e).remove();$(".jivo_cobrowsing_tooltip",e).remove()},toolTip:function(e){var t=jqueryFrameController.highlight({element:e});var i=jqueryFrameController.renderTooltip({element:e});var n=i.find(":first-child");i.addClass("air").css("width","auto");n.css({padding:"8px",width:"auto","background-color":""});var o=this.textInput=$("<textarea></textarea>",{id:"cobrowsing_textarea_comment",placeholder:this.i18n("cb_enterComment"),keypress:function(t){if(t.keyCode==13){t.preventDefault();t.stopPropagation();jqueryFrameControllerForAir.send(e)}}});o.autoResize({animate:false,minSize:19,maxSize:100,extraSpace:12});var s=$('<button class="btn btn-mimi blue on_dark large">'+this.i18n("cb_send")+"</button>").css({"float":"right",position:"relative","margin-right":"8px"}).on("click",function(){jqueryFrameControllerForAir.send(e)});var a=$('<button class="btn btn-mimi grey on_dark large">'+this.i18n("cb_cancel")+"</button>").css({"float":"right","margin-right":"5px",position:"relative"}).on("click",function(){jqueryFrameControllerForAir.closeTooltip()});n.append(o);n.append(a);n.append(s);n.append($("<div/>",{style:"clear:both"}));jqueryFrameController.appendTooltip(i,e);o.val(" ").data("AutoResizer").check();o.val(lblDefaultCobrowseComment);o[0].focus();o[0].select();this.is_tooltip_open=true},send:function(e){if($.trim(this.textInput.val())!=""){var t=i(e[0]);var n={name:"on_send",page_element:t,page_url:window.location.href,comment:this.textInput.val()};coBrowserIframeCreater.postMessage(n)}},closeTooltip:function(){jqueryFrameControllerForAir.stopSelection();jqueryFrameControllerForAir.is_tooltip_open=false;jqueryFrameControllerForAir.startSelection();coBrowserIframeCreater.postMessage({name:"on_cancel"})},onEsc:function(){if(jqueryFrameControllerForAir.is_tooltip_open){jqueryFrameControllerForAir.closeTooltip()}else if(jqueryFrameControllerForAir.is_selecting){jqueryFrameControllerForAir.stopSelection();coBrowserIframeCreater.postMessage({name:"reset"})}else{coBrowserIframeCreater.postMessage({name:"close"})}}};function i(e){var t=[];while(e.parentNode){if(e.id){t.unshift("#"+e.id);break}else{if(e==e.ownerDocument.documentElement)t.unshift(e.tagName);else{for(var i=1,n=e;n.previousElementSibling;n=n.previousElementSibling,i++);t.unshift(e.tagName+":nth-child("+i+")")}e=e.parentNode}}return t.join(" > ")}})(window.parent.document);var VOXIMPLANT_URL="//cdn.voximplant.com/voximplant.min.js";var WebPhone=machina.Fsm.extend({namespace:"WP",autoCall:false,agentId:"",states:{uninitialized:{call:function(){this.autocall=true;this.transition("initializing")},init:function(){this.transition("initializing")}},initializing:{_onEnter:function(){loadScript(VOXIMPLANT_URL,underscore.bind(this.handle,this,"script_loaded"),underscore.bind(this.handle,this,"script_load_error"))},script_loaded:function(){this.emit("WebPhoneInitializing",{name:"WebPhoneInitializing"});this.vox=VoxImplant.getInstance();this.vox.init({useFlashOnly:false,micRequired:true,swfContainer:"rtc_placeholder",progressTone:true});this.vox.addEventListener(VoxImplant.Events.SDKReady,underscore.bind(this.handle,this,"vox_init"))},script_load_error:function(e){reportException({message:"Error loading voximplant script",fileName:"web_phone.js"})},vox_init:function(){this.transition("connecting")},call:function(){this.autocall=true}},initialized:{_onEnter:function(){this.emit("WebPhoneInitialized",{name:"WebPhoneInitialized"})},call:function(){this.autocall=true;this.transition("connecting")},init:function(){this.transition("connecting")}},connecting:{_onEnter:function(){this.emit("WebPhoneConnecting",{name:"WebPhoneConnecting"});this.vox.connect();this.vox.addEventListener(VoxImplant.Events.MicAccessResult,underscore.bind(function(e){if(!e.result){this.handle("vox_mic_access_denied")}},this));this.vox.addEventListener(VoxImplant.Events.ConnectionEstablished,underscore.bind(function(e){this.handle("vox_connected")},this));this.vox.addEventListener(VoxImplant.Events.ConnectionFailed,underscore.bind(function(e){reportException({message:"Vox to connecting failed",fileName:"web_phone.js"});this.handle("vox_connection_failed")},this));this.vox.addEventListener(VoxImplant.Events.ConnectionClosed,underscore.bind(function(e){this.handle("vox_connection_closed")},this))},vox_connected:function(){this.transition("authenticating")},vox_connection_failed:function(){this.transition("initialized")},vox_connection_closed:function(){this.transition("initialized")},vox_mic_access_denied:function(){this.transition("mic_disabled")},call:function(){this.autocall=true},hangup:function(){this.transition("initialized")}},connected:{_onEnter:function(){this.emit("WebPhoneConnected",{name:"WebPhoneConnected"})},call:function(){this.autocall=true;this.transition("authenticating")},init:function(){this.transition("authenticating")}},authenticating:{_onEnter:function(){this.emit("WebPhoneAuthenticating",{name:"WebPhoneAuthenticating"});this.vox.addEventListener(VoxImplant.Events.AuthResult,underscore.bind(function(e){if(e.result){this.handle("vox_authenticated")}else{if(e.code==302){this.handle("vox_key_received",e.key)}else{this.handle("vox_authentication_failed")}}},this));this.vox.requestOneTimeLoginKey(config.vox_login)},vox_key_received:function(e){var t=config.base_url+"/script/sign?cb=?&key="+e;getJSONP(t,underscore.bind(function(e){if(e.result){this.handle("vox_hash_received",e.hash)}else{this.handle("vox_authentication_failed")}},this))},vox_hash_received:function(e){this.vox.loginWithOneTimeKey(config.vox_login,e)},vox_authenticated:function(){if(this.autocall){this.transition("progressing")}else{this.transition("idle")}},vox_authentication_failed:function(){reportException({message:"Vox to authentication failed",fileName:"web_phone.js"});this.transition("connected")},call:function(){this.autocall=true},hangup:function(){this.transition("connected")}},idle:{_onEnter:function(){var e="WebPhoneIdle";if(this.priorState==="authenticating"){e="WebPhoneAuthenticated"}this.emit(e,{name:e})},call:function(){this.transition("progressing")},disconnect:function(){this.vox.disconnect();this.transition("initialized")}},progressing:{_onEnter:function(){this.emit("WebPhoneProgressing",{name:"WebPhoneProgressing"});this.voxCall=this.vox.call(this.agentId,false,"",{"X-jv-sessid":cookie("sess_id")});this.voxCall.addEventListener(VoxImplant.CallEvents.Connected,underscore.bind(function(e){this.handle("vox_call_connected")},this));this.voxCall.addEventListener(VoxImplant.CallEvents.Failed,underscore.bind(function(e){this.handle("vox_call_failed")},this));this.voxCall.addEventListener(VoxImplant.CallEvents.Disconnected,underscore.bind(function(e){this.handle("vox_call_disconnected")},this))},vox_call_connected:function(){this.transition("joined")},vox_call_failed:function(){this.transition("idle")},hangup:function(){this.voxCall.hangup();this.transition("idle")}},joined:{_onEnter:function(){this.emit("WebPhoneJoined",{name:"WebPhoneJoined"})},vox_call_disconnected:function(){this.transition("idle")},hangup:function(){this.voxCall.hangup();this.transition("idle")}},mic_disabled:{_onEnter:function(){this.emit("WebPhoneMicDisabled",{name:"WebPhoneMicDisabled"})}}},setAgentId:function(e){this.agentId=e}});window.onerror=function(e,t,i){reportException({message:e,lineNumber:i,fileName:t})};var chat_contents={isInit:false,init:function(e,t){log("CHAT_CONTENTS: init",t);this.view_settings={backgroundColor:config.widget_color,borderColor:adjustLightness(config.widget_color,.6,1),isDarkText:config.widget_font_color=="dark"};if(this.view_settings.isDarkText){this.view_settings.shadowCss=adjustLightness(this.view_settings.backgroundColor,1.15,.7)+" 0 1px";this.view_settings.textColor=adjustLightness(this.view_settings.backgroundColor,.1,.5)}else{this.view_settings.shadowCss=adjustLightness(this.view_settings.backgroundColor,.6,1)+" 0 -1px";this.view_settings.textColor="#ffffff"}if(e==="online"){if(!this.isInit){chat_view_online.create(this.view_settings)}if(typeof t==="object"&&t.start==="call"&&config.options&128){if(jivo.getCallWidget()){jivo.handle("cw_ping",{title:false,invitation:"jivo_api.open"})}else{this.wpInit()}}}else{if(!this.isInit)chat_view_offline.create(this.view_settings)}this.callWidgetButtonInit();this.isInit=true},updateAgent:function(e){log("updateAgent",e);var t={"agent.id":e.agent_id,"agent.avatar":e.avatar_url,"agent.name":e.display_name,"agent.title":e.title,"agent.vox_name":e.vox_name,"agent.online":true,"agent.disableAnimation":e.disableAnimation?true:false};if(e.state&&!jivo.getCallWidget()){t["agent.calls"]=e.state.available_for_calls}else{this.callWidgetButtonInit()}chat_view_online.setChatAttr(t)},callInit:function(e){this.callWidgetButtonInit();if(typeof e==="object"&&e.start==="call"){if(jivo.getCallWidget()){jivo.handle("cw_ping",{title:false,invitation:"jivo_api.open"})}else{if(chat_view_online.getChatModel().get("agent.id")){if(chat_view_online.getChatModel().get("agent.calls")){chat_view_online.getCallView().addMessage(translate("c_callProcessing"));chat_view_online.getCallModel().getWebPhone().handle("call")}else{chat_view_online.getCallView().addMessage(translate("lblWebPhoneNotConnected"))}}else{if(config.options&128){this.wpInit()}}}}},callWidgetButtonInit:function(){var e=jivo.getCallWidget(),t=config.chat_mode==="online"?chat_view_online:chat_view_offline;if(e&&e.state!=="CALL"){callWidgetPing(function(e){var i=e.show_form?true:false;var n=chat_view_online.getMessagesCollection(),o=0;if(n?n.toJSON().length:0>0){o=underscore.where(n.toJSON(),{type:"clientMessage"}).length}t.setChatAttr({"agent.calls":i,can_enter_phone:!o&&i})})}},wpInit:function(){var e=chat_view_online.getCallModel();if(!e.isInit){this.wp_ready_hook=e.getWebPhone().on("WebPhoneAuthenticated",underscore.bind(this.wpReady,this));this.wp_fail_hook=e.getWebPhone().on("WebPhoneMicDisabled",underscore.bind(this.wpFail,this));e.getWebPhone().handle("init");chat_view_online.addConnectionError(translate("lblWaitForOperator"));e.isInit=true}},wpReady:function(){this.wp_ready_hook.off();this.wp_fail_hook.off();this.auto_call=true;jivo.handle("gui_start_call")},wpFail:function(){this.wp_ready_hook.off();this.wp_fail_hook.off();chat_view_online.addConnectionError(translate("lblWebPhoneMicError"))},focusChat:function(e){if(e==="offline"&&chat_view_offline.getFormView()){chat_view_offline.getFormView().inputFocus()}else{chat_view_online.chatMaximized()}},handle:function(e,t,i){log("CHAT_CONTENTS: handling "+e,t,i);switch(e){case"agent_typing":chat_view_online.setChatAttr({"agent.typing":t.typing});break;case"agent_message":chat_view_online.setChatAttr({"agent.typing":false});if(jivo.isVisitorsInsight()){chat_view_online.setChatAttr({inputEnabled:true})}if(t.invitation&&$(".agentMessage").length>0){chat_view_online.hideInvitationMessage()}chat_view_online.addAgentMessage(t.message);jivo.handle("gui_agent_message_ack",[t.msg_id]);if(jivo.isVisitorsInsight()&&$(".connectionError").length>0){chat_view_online.hideConnectionError()}break;case"system_message":chat_view_online.addSystemMessage(t.message);break;case"agent_service_message":handleServiceMessage(t);break;case"invitation":jivo.gui._event_queue.push(["accept",{agent_info:t}]);jivo.gui._event_queue.push(["agent_message",{message:i,invitation:true}]);break;case"accept":this.updateAgent(t.agent_info);if(this.auto_call){this.auto_call=false;chat_view_online.getCallModel().getWebPhone().handle("call")}log("accept",config.contacts_ask,jivo.invitationText);if(config.contacts_ask===1&&jivo.invitationText){chat_view_online.getIntroduceView().close()}if(config.departments){chat_view_online.getDepartmentsView().close()}break;case"agent_chat_close":var n=[],o=['<input type="button" class="jivoBtn reject reject-chat-btn" id="close-chat-btn" value="'+translate("lnkCloseThisWindow")+'" />'];chat_view_online.hideConnectionError();if(!jivo.isSeparateWindow()){o.unshift('<input type="button" class="jivoBtn accept accept-chat-btn" id="restart-chat-btn" value="'+translate("lnkRestartChat")+'" />')}if(!(t&&t.reason&&t.reason===8)){n.push(translate("lblAgentDisconnected"));n.push(o.join(""));chat_view_online.setChatAttr({inputEnabled:false});chat_view_online.addConnectionError(n.join("<br>"))}chat_view_online.setChatAttr({"agent.calls":false,"agent.typing":false});chat_view_online.getCallModel().getWebPhone().handle("disconnect");$(".reject-chat-btn").on("click",function(){jivo.handle("gui_minimize")});$(".accept-chat-btn").on("click",function(){jivo.handle("gui_resume")});break;case"gui_resume":chat_view_online.setChatAttr({inputEnabled:true});chat_view_online.hideConnectionError();chat_view_online.chatMaximized();break;case"resume_ok":var s=t.agent_info,a=t.client_info;if(typeof s==="object"){s.disableAnimation=true;this.updateAgent(t.agent_info);if(config.departments){chat_view_online.getDepartmentsView().close()}}else{if(config.departments){chat_view_online.getChatModel().set("agent.name",translate("lblConnectedToAgent"))}}chat_view_online.setChatAttr({"client.name":a.name,inputEnabled:true});var r=a.msg_history||[];chat_view_online.resetMessages(r);if(r.length){if(config.contacts_ask===1){chat_view_online.getIntroduceView().close()}if(config.departments){chat_view_online.getDepartmentsView().close()}if(underscore.findWhere(r,{type:"clientMessage"})){chat_view_online.setChatAttr({can_enter_phone:false})}var l=[];underscore.each(r,function(e){if(e.type==="agentMessage"&&!e.ack){l.push(e.msg_id)}},this);if(l.length){setTimeout(function(){jivo.handle("gui_agent_message_ack",l)},0)}}break;case"connect_failed":chat_view_online.getCallModel().getWebPhone().handle("disconnect");var o=[{title:translate("lblLeaveMessage"),event:"gui_leave_msg"}];if(utils.hideOffline()){o=[{title:translate("lnkCloseThisWindow"),event:"gui_minimize"}]}chat_view_msg.instance.models.message.set({msg:translate("lblNoOperators"),buttons:o});chat_view_msg.create(this.view_settings);break;case"gui_leave_msg":chat_view_offline.disableDragging();chat_view_offline.create(this.view_settings);break;case"focus_maximize":log("focus_maximize");this.focusChat(t);this.callWidgetButtonInit();break;case"show":this.callInit(t);if(jivo.isClicked){this.focusChat(t)}break;case"maximize":chat_view_online.getMessagesView().setScrollBottom(0);this.callInit(t);break;case"gui_message":chat_view_online.addClientMessage(t);break;case"offline_success":chat_view_msg.instance.models.message.set({header:translate("lblOfflineMessageSend"),msg:translate("lblThankYouMessage"),buttons:[{title:translate("lnkCloseThisWindow"),event:"gui_minimize"}]});chat_view_msg.create(this.view_settings);chat_view_offline.cap_id=false;if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setHeight(jivo.gui.jivoframecontainer.getChatPosition().height)}break;case"offline_captcha":chat_view_offline.captcha(t);break;case"offline_failed":chat_view_msg.instance.models.message.set({header:"An error occured",msg:translate("lblMessageError"),buttons:[{title:translate("lnkCloseThisWindow"),event:"gui_minimize"}]});chat_view_msg.create(this.view_settings);break;case"transferred":chat_view_online.addConnectionError(translate("lblTransferred").replace("_AGENT_",t.agent_info.display_name));this.updateAgent(t.agent_info);break;case"update_agent_info":this.updateAgent(t.agent_info);break;case"cw_connecting":chat_view_online.getCallView().addMessage(translate("c_callProcessing"));chat_view_online.setChatAttr({can_enter_phone:false});break;case"cw_connected":chat_view_online.getCallView().addMessage(translate("c_callConnected"));chat_view_online.setChatAttr({can_enter_phone:false});$("#callme").css("display","none");break;case"cw_call_end":chat_view_online.getCallView().addMessage(translate("c_callDisconnected"));$("#callme").css("display","block");break;case"cw_show_form":if(!t.show_form){chat_view_online.getCallView().addMessage(translate("lblWebPhoneNotConnected"))}break;case"update_height":if(!jivo.isMobileOrTablet()){if(i){jivo.gui.jivoframecontainer.expandTo=parseInt(t)>>0}jivo.gui.setChatHeight(t)}break;default:log("CHAT_CONTENTS: unhandled "+e,t)}}};function handleServiceMessage(e){switch(e.service){case"file_transfer":if(e.event==="receive_file_request"){chat_view_online.addReceiveFile({fileUrl:e.file_url,fileName:e.file_name,fileId:e.file_id,state:"pending",agentName:chat_view_online.getChatAttr("agent.name")})}break;case"cobrowse":if(e.event==="highlight"){chat_view_online.addCobrowseHighlight({page_url:e.page_url,hash:e.hash,comment:stripBrackets(e.comment),state:"pending"})}break;default:log("CHAT_CONTENTS: unhandled agent_service_message",e)}}window.Jivo={Online:{Models:{},Views:{},Collections:{},Controller:{},MAX_MESSAGE_LENGTH:1e3},Offline:{Models:{},Views:{},Collections:{},Controller:{},MAX_MESSAGE_LENGTH:1200},Message:{Models:{},Views:{},Controller:{}},Model:{},View:{},Collection:{}};Jivo.Model.Field=Backbone.Model.extend({defaults:{formId:"default-form-id"},valid:function(){return!this.required()||this.value().length>0},required:function(){return this.show()&&config.contacts_settings[this.id].required},show:function(){return config.contacts_settings[this.id].show},value:function(){var e=$("#"+this.get("formId")).find("#"+this.id);if(e.length===0){return""}else{return $.trim(e.val())}}});Jivo.Model.Email=Jivo.Model.Field.extend({id:"email",valid:function(){var e=this,t=e.value();return t.length===0&&!e.required()||utils.isValidValue_email(t)}});Jivo.Model.Phone=Jivo.Model.Field.extend({id:"phone",valid:function(){var e=this,t=e.value();return t.length===0&&!e.required()||utils.isValidValue_phone(t)}});Jivo.Model.Name=Jivo.Model.Field.extend({id:"name"});Jivo.Model.Message=Jivo.Model.Field.extend({id:"message"});Jivo.Model.Error=Backbone.Model.extend({defaults:{name:"",messages:[]},idAttribute:"name"});Jivo.Collection.Errors=Backbone.Collection.extend({model:Jivo.Model.Error});Jivo.View.Form=Backbone.View.extend({events:{"click #submit":"submit","click #cancel":"cancel","keydown input:text,textarea":"onKeyDown"},initialize:function(){this.collection=new Jivo.Collection.Errors;this.collection.on("add",this.onErrorAdd,this);this.collection.on("remove",this.onErrorRemove,this);this.collection.on("reset",this.onReset,this);this.initializeSpecial()},initializeSpecial:function(){},valid:function(){var e=this;e.fields.each(function(t){if(t.valid()){e.collection.remove(t.id)}else{e.collection.add({name:t.id,messages:[]})}},e);return!e.collection.length},toggleError:function(e,t){var i=this;if(t){i.$("#"+e).parent().addClass("error-field");i.$("#error-"+e).show()}else{i.$("#"+e).parent().removeClass("error-field");i.$("#error-"+e).hide()}if(!jivo.isSeparateWindow())i.updateHeight()},updateHeight:function(e){jivo.handle("update_height",this.getHeight(),e)},getHeight:function(){return 0},onErrorAdd:function(e){log("onErrorAdd");this.toggleError(e.get("name"),true)},onErrorRemove:function(e){log("onErrorRemove");this.toggleError(e.get("name"),false)},onReset:function(e,t){underscore.each(t.previousModels,function(e){this.toggleError(e.get("name"),false)},this)},onKeyDown:function(e){var t=this,i=$(e.target).attr("id");t.collection.remove(i);if(e.keyCode===13&&(e.target.tagName==="INPUT"||e.target.tagName==="TEXTAREA"&&!hasClass(e.target,"offline-message"))){e.preventDefault();t.submit()}}});Jivo.Offline.Models.Form=Backbone.Model.extend({defaults:{templateData:{type:config.widget_font_color,header:config.offline_form_title||config.offline_widget_label,text:config.offline_form_text,link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),nologo:!utils.showAd(),maxMessageLength:Jivo.Offline.MAX_MESSAGE_LENGTH,locale:getIconLocale(),agent:{calls:false}}}});Jivo.Offline.Models.Error=Backbone.Model.extend({defaults:{name:"",messages:[]},idAttribute:"name"});Jivo.Offline.Collections.Errors=Backbone.Collection.extend({model:Jivo.Offline.Models.Error});Jivo.Offline.Models.Email=Jivo.Model.Email.extend({show:function(){return config.contacts_settings.email.show||this.phoneNotRequired()},required:function(){return config.contacts_settings.email.show&&config.contacts_settings.email.required||this.phoneNotRequired()},phoneNotRequired:function(){return!config.contacts_settings.phone.show||!config.contacts_settings.phone.required}});Jivo.Offline.Models.Message=Jivo.Model.Field.extend({id:"message",required:function(){return true},show:function(){return true}});Jivo.Offline.Views.Form=Jivo.View.Form.extend({el:"#inner-chat",tagName:"div",template:_templates.offline.form,height:362,events:{"click #submit":"submit","click #cancel":"cancel",'keydown input:text,input[type="tel"],input[type="email"],textarea':"onKeyDown","input  #message":"messageInput"},fields:new Backbone.Collection([new Jivo.Offline.Models.Message({formId:"inner-chat"}),new Jivo.Offline.Models.Email({formId:"inner-chat"}),new Jivo.Model.Phone({formId:"inner-chat"}),new Jivo.Model.Name({formId:"inner-chat"})]),initializeSpecial:function(){this.model.on("change:agent.calls",this.updateCallMe,this);this.model.on("change:templateData.header",this.updateHeader,this);this.model.on("change:templateData.text",this.updateText,this)},render:function(e,t){log("RENDER OFFLINE FORM",e,t);var i=this.model.get("templateData");i.fields=this.fields;this.$el.html(this.template(i));this.$el.addClass("offline");this._actionButtonData={mobile:"desktop"};$("#jivo-iframe-container",parent.document).append(_templates.actionButton(this._actionButtonData)).append(_templates.dragHandle());if(!jivo.isSeparateWindow()){jivo.gui.jivoframecontainer.closeButton=window.parent.document.getElementById("jivo_action")}chat_view_offline.disableDragging();$("#jivo-iframe-container",parent.document).addClass("jivo-no-transition");$("#jivo_action #jivo_close_button",parent.document).on("click",function(e){e.preventDefault();var t=jivo.getCallWidget();if(jivo.gui.state=="CALLWIDGET"){t.transition("CLOSED")}else{chat_view_offline.chatMinimized()}});if(!jivo.isSeparateWindow()&&!jivo.isTablet()){$("#jivo-iframe-container",parent.document).mouseenter(underscore.bind(this.toolbarToggle,this,"show")).mouseleave(underscore.bind(this.toolbarToggle,this,"hide"))}$("input[placeholder], textarea[placeholder]").placeholder();if(utils.browser.msie&&utils.browser.mV<9){this.$("#message").on("keydown paste",underscore.bind(this.messageInput,this))}if(jivo.isSeparateWindow()){this.$el.on("focus blur","input[type=text],input[type=tel],input[type=email],textarea",JivoGui.handleSoftKeyboard);this.$("#offline-form-inner").perfectScrollbar({topMargin:utils.showAd()?40:25})}else{this.updateHeight()}if(e){$("#offline-form-inner").find(".description, .message, #email, #name, #phone, .buttons").hide();var n=$(".captcha-container");n.show();$("#jivo-iframe-container",parent.document).addClass("jivo-no-transition");this.updateHeight();n.find("img").attr("src",config.avatar_url+"/captcha/"+e+".png");if(t){n.find(".error").css("display","block");this.updateHeight()}n.find("#resend").on("click",underscore.bind(this.submit,this));$("#cancelCap").show().on("click",underscore.bind(this.cancelCaptcha,this));setTimeout(function(){$(".cap_symbols").focus()},0)}setTimeout(function(){if(ie8||ie9){$("#header-animate-container").css({marginTop:0})}else{$("#header-animate-container").addClass("header-animate")}},0);return this},updateHeader:function(){$(".agent-name").text(this.model.get("templateData.header"))},updateText:function(){$("#offline-form-fields .description").text(this.model.get("templateData.text"))},inputFocus:function(){var e=this.$el.find("#message");setTimeout(function(){e.focus()},0);return e},messageInput:function(e){setTimeout(underscore.bind(function(){var e=$(this).attr("maxlength");if($(this).val().length>e){$(this).val($(this).val().substring(0,e))}},e.currentTarget),0)},submit:function(){if(this.valid()){var e={};this.fields.each(function(t){e[t.id]=t.value()},this);if(chat_view_offline.cap_id){e.cap_id=chat_view_offline.cap_id;e.cap_symbols=$(".cap_symbols").val();if(e.cap_symbols==""){$(".cap_symbols").addClass("empty");return}}$("#jivo-iframe-container",parent.document).removeClass("jivo-no-transition");jivo.handle("gui_offline_message",e)}else{this.requestRedraw();$("#jivo-iframe-container",parent.document).addClass("jivo-no-transition");if(!jivo.isSeparateWindow())this.updateHeight();chat_view_offline.instance.views.form.el.scrollTop=0}},cancel:function(e){log("cancel offline form");e.preventDefault();if(jivo.isTablet()&&jivo.isSeparateWindow()){window.close()}else if(jivo.isMobile()){history.back()}else{$("#jivo-iframe-container",parent.document).removeClass("jivo-no-transition");jivo.handle("gui_minimize")}},cancelCaptcha:function(){chat_view_offline.cap_id=false;$("#jivo-iframe-container",parent.document).addClass("jivo-no-transition");$(".captcha-container").hide();$("#cancelCap").hide();$("#offline-form-inner").find(".description, .message, #email, #phone, #name, .buttons").show();this.updateHeight()},getHeight:function(){return $("#header-avatar").height()+$("#offline-form").height()},toolbarToggle:function(e){var t=$("#jivo_close_button",parent.document);t.finish();if(e==="show"){t.fadeIn(500)}else{t.fadeOut(500)}},requestRedraw:function(){var e=this.$("#offline-form-inner")[0];e.style.display="none";e.offsetHeight;e.style.display="block"},updateCallMe:function(){if(jivo.getCallWidget()&&this.model.get("agent.calls")){this.$el.find("#callme").show()}else{this.$el.find("#callme").hide()}}});var chat_view_offline=Jivo.Offline.Controller=new function(){var e,t;this.instance={models:{form:new Jivo.Offline.Models.Form,error:new Jivo.Offline.Models.Error},collections:{errors:false},views:{form:false}};this.create=function(e){this.instance.collections.errors=new Jivo.Offline.Collections.Errors;this.instance.views.form=new Jivo.Offline.Views.Form({model:this.instance.models.form,collection:this.instance.collections.errors});this.instance.views.form.render();this.getCallView().render()};this.captcha=function(e){this.instance.views.form.render(e.cap_id,this.cap_id&&e.cap_id!=this.cap_id);this.cap_id=e.cap_id};this.getHeight=function(){return this.instance.views.form.getHeight()};this.chatMinimized=function(){this.instance.views.form.collection.reset();jivo.handle("gui_minimize")};this.getFormView=function(){if(!e){e=this.instance.views.form}return e};this.getCallView=function(){if(!t){t=new Jivo.Online.Views.Call({model:this.instance.views.form})}return t};this.setChatAttr=function(){return proxy(this.instance.models.form,"set",arguments)};this.disableDragging=function(){if(!jivo.isSeparateWindow()){$("#jivo-drag-handle",window.parent.document).hide()}}};Jivo.Online.Models.Chat=Backbone.Model.extend({defaults:{templateData:{pencilTitle:translate("lblPencilHint"),pencilSource:config.base_url+"/images/pencil.gif",callMe:translate("lblCallMe"),hangUp:translate("hangUp"),lblHangUpShort:translate("lblHangUpShort"),lblEvaluatePlease:translate("lblEvaluatePlease"),lblEvaluateThanks:translate("lblEvaluateThanks"),lblEvaluateCancel:translate("lblEvaluateCancel"),link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),nologo:!utils.showAd(),maxMessageLength:Jivo.Online.MAX_MESSAGE_LENGTH,locale:getIconLocale()},client:{id:1,name:cookie("client_name"),phone:cookie("phone"),email:cookie("email"),title:false,avatar:false,typing:false},agent:{id:2,name:translate("lblConnectedToAgent"),title:translate("lblOperatorsOnline"),avatar:false,calls:false,typing:false,online:false,disableAnimation:false},can_enter_phone:config.callback_widget?true:false,inputEnabled:true,evaluate:false,"size.height":362,"size.min-height":200,"size.width":267,"textarea.height":32,"textarea.width":226,"position.left":0,"position.right":0,"coordinates.x":0,"coordinates.y":0,"coordinates.dx":0,"coordinates.dy":0},initialize:function(){var e;if(jivo.isMobileOrTablet()){e=translate("lblMessageHere")}else if(jivo.getCallWidget()){e=translate("lblEnterMessageOrPhoneHere")}else{e=translate("lblEnterMessageHere")}this.defaults.templateData.lblEnterMessageHere=e},introduced:cookie("client_name")!==null||cookie("phone")!==null||cookie("email")!==null||false});Jivo.Online.Views.Chat=Backbone.View.extend({el:"#inner-chat",tagName:"div",previousScroll:0,template:_templates.online.chat,headerTimeout:[],events:{"keypress   #input-field":"inputFieldKeyPress","click      #input-button":"inputButtonClick","focusin    #input-field":"inputFieldFocus","input      #input-field":"messageInput"},initialize:function(){this.model.on("change:agent.name",this.setHeaderName,this);this.model.on("change:agent.title",this.setAgentTitle,this);this.model.on("change:agent.typing",this.agentTyping,this);this.model.on("change:agent.avatar",this.setAgentImage,this);this.model.on("change:client.typing",this.clientTyping,this);this.model.on("change:inputEnabled",this.setInputMode,this);this.model.on("change:agent.calls",this.updateCallMe,this);this.model.on("change:can_enter_phone",this.inputSizeChange,this);if(config.typing_insight==1){setInterval(underscore.bind(this.notifyInputChanged,this),1e3)}},handleTyping:function(e){this.model.set({"client.typing":e})},lastInputValue:"",notifyInputChanged:function(){var e=this.$el.find("#input-field").val();if(this.lastInputValue!=e){jivo.handle("gui_typing_insight",e);this.lastInputValue=e}},render:function(){var e=this.$el;e.append(this.template(this.model.toJSON()));this.model.set("agent.name",translate("lblConnectedToAgent"));this.inputAutoResize();if(jivo.isSeparateWindow()){e.on("focus blur","input[type=text],input[type=tel],input[type=email],textarea",JivoGui.handleSoftKeyboard)}this._actionButtonData={mobile:"desktop"};$("#jivo-iframe-container",parent.document).append(_templates.actionButton(this._actionButtonData));$("#jivo-iframe-container",parent.document).append(_templates.dragHandle());if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.closeButton=window.parent.document.getElementById("jivo_action");jivo.gui.jivoframecontainer.dragHandle=window.parent.document.getElementById("jivo-drag-handle")}$("#jivo_action #jivo_close_button",parent.document).on("click",function(e){e.preventDefault();var t=jivo.getCallWidget();if(jivo.gui.state=="CALLWIDGET"){jivo.gui._chatDiv.style.display="none";t.transition("CLOSED")}else{chat_view_online.chatMinimized()}});if(!jivo.isMobileOrTablet()){$("#jivo-chat").jivoDragEvent({handler:$("#jivo-drag-handle",window.parent.document),tracker:$("#jivo-mouse-tracker",window.parent.document)}).bind("jivo.drag.init",$.proxy(this,"startResize")).bind("jivo.drag.move",$.proxy(this,"resize")).bind("jivo.drag.stop",$.proxy(this,"stopResize"))}$("input[placeholder], textarea[placeholder]").placeholder();$("#messages-div-outer").on("scroll",underscore.bind(this.messagesScroll,this));if(utils.browser.msie&&utils.browser.mV<9){this.$("#input-field").on("keydown paste",underscore.bind(this.messageInput,this))}if(devicejs.ios()){$("#messages-div-inner").on("touchmove",function(){var e=$("#input-field");if(e.is(":focus")){e.trigger("blur")}})}this.requestRedraw();if(1===config.contacts_ask){this.showIntroduceForm(true)}else if(config.departments){this.showDepartmentsSelector()}return this},inputFocus:function(){var e=this.$el.find("#input-field"),t;setTimeout(function(){t=$("#introduce-form");if(!jivo.isSeparateWindow()){if(t.length&&t.is(":visible")){e=t.find(".input-field").first()}e.focus()}},0);return e},inputAutoResize:function(){this.$el.find("#input-field").autoResize({extraSpace:jivo.isMobileOrTablet()?12:0,animate:false,maxSize:65,minSize:"original",onResize:underscore.bind(this.updateMessage,this),onAfterResize:underscore.bind(this.updateMessage,this)}).typing({start:underscore.bind(this.handleTyping,this,1),stop:underscore.bind(this.handleTyping,this,0),delay:5e3})},setHeaderName:function(){var e=this.$el,t=this.model.get("agent.name"),i=this.model.get("agent.title")?this.model.get("agent.title"):translate("lblOperatorsOnline"),n=e.find("#header-animate-container"),o;for(o=this.headerTimeout.length;o--;){clearTimeout(this.headerTimeout[o])}n.removeClass("header-animate");if(this.model.get("agent.disableAnimation")){e.find(".header-animate-info").find(".agent-name").text(t);this.setAgentTitle()}else{e.find(".header-animate-first").find(".agent-name").text(t);e.find(".header-animate-first").find(".title").text(i);this.headerTimeout[0]=setTimeout(function(){n.addClass("header-animate")},0);this.headerTimeout[1]=setTimeout(function(){e.find(".header-animate-second").find(".agent-name").text(t);e.find(".header-animate-second").find(".title").text(i)},400);if(!jivo.isMobileOrTablet()){this.headerTimeout[2]=setTimeout(function(){n.removeClass("header-animate")},1500)}}$("#agent-typing").empty();this.agentTyping()},setAgentTitle:function(){var e=this.model.get("agent.title")?this.model.get("agent.title"):translate("lblOperatorsOnline");this.$el.find(".title").text(e)},setAgentImage:function(){this.$el.find(".avatar img").remove();if(config.options&32){if(this.model.get("agent.avatar")!==null){this.$el.find(".avatar").append($("<img/>",{src:config.avatar_url+"/avatars/"+this.model.get("agent.avatar")}));this.$el.find(".avatar").parent().addClass("has-avatar")}else{this.$el.find(".avatar").parent().removeClass("has-avatar")}}},setInputMode:function(){var e=this.model.get("inputEnabled"),t=chat_view_online.getMessagesView(),i=t.getScrollBottom();this.$("#input-div").css("visibility",e?"visible":"hidden");this.$("#messages-div").css("bottom",e?40:0);t.setScrollBottom(i)},agentTyping:function(){var e=$("#agent-typing");if(this.model.get("agent.typing")){if(e.is(":empty")){e.append(_templates.online.typing({agentName:this.model.get("agent.name")}))}e.show()}else{e.hide()}},clientTyping:function(){chat_view_online.typing(this.model.get("client.typing"))},inputFieldKeyPress:function(e){if(e.keyCode===13){e.preventDefault();this.inputSendMessage(e.currentTarget.value,$(e.currentTarget),$("#input-button")[0])}},inputButtonClick:function(e){if(jivo.isTablet()&&!jivo.isSeparateWindow()){e.preventDefault();jivo.handle("gui_answer_proactive")}else{var t=$("#input-field");this.inputSendMessage(t.val(),t,$(e.currentTarget)[0])}},inputSendMessage:function(e,t,i){if($.trim(e).length!==0){var n=this.model.get("can_enter_phone");this.model.set("can_enter_phone",false);t.val("");if(n&&jivo.getCallWidget()&&!jivo.isMobileOrTablet()&&utils.isValidValue_mobilePhone(e)){jivo.handle("cw_ping");jivo.cw.callwidget.handle("setPhoneNumber",e.replace(/[^0-9]/gim,""));return}if(!chat_view_online.getChatModel().introduced&&(jivo.invitationText||jivo.isMobileOrTablet())&&1===config.contacts_ask){if(jivo.isMobileOrTablet()){t.blur()}this.showIntroduceForm(false,e)}else{Jivo.Online.Controller.sendMessage(e)}t.css("height","");i.disabled=true;this.updateMessage();if(devicejs.ios()){log("inputSendMessage init sound for ios.",devicejs.ios());chat_view_online.initSound()}}},inputFieldFocus:function(e){Jivo.Online.Controller.onFocus();if(devicejs.ios()){var t=$(e.target);t.on("focus",function(){$(document).unbind("scroll.on_focus");setTimeout(function(){$(document).bind("scroll.on_focus",function(e){t.trigger("blur")})},1500)});t.on("blur",function(){$(document).unbind("scroll.on_focus")})}},windowResize:function(){log("windowResize");chat_view_online.getMessagesView().setScrollBottom(this.previousScroll)},messagesScroll:function(){this.previousScroll=chat_view_online.getMessagesView().getScrollBottom()},messageInput:function(e){var t=e.currentTarget,i=e.currentTarget.value,n=$("#input-button")[0];setTimeout(underscore.bind(function(){var e=$(this).attr("maxlength");if($(this).val().length>e){$(this).val($(this).val().substring(0,e))}},t),0);n.disabled=i.length<=0},showIntroduceForm:function(e,t){chat_view_online.getIntroduceView().render(e,t)},showDepartmentsSelector:function(){chat_view_online.getDepartmentsView().render();this.disableDragging()},updateCallMe:function(){if((chat_view_online.getCallModel().rtcSupported()||jivo.getCallWidget())&&this.model.get("agent.calls")){this.$el.find("#callme").css("display","block");this.$el.find(".title").css("width","75%")}else{if(chat_view_online.getCallModel().calling()){return}this.$el.find("#callme").css("display","none");this.$el.find(".title").css("width","100%")}},enableDragging:function(){if(!jivo.isSeparateWindow()){$("#jivo-drag-handle",window.parent.document.body).css("display","block")}},disableDragging:function(){log("chat_view_online: disable dragging");if(!jivo.isSeparateWindow()){$("#jivo-drag-handle",window.parent.document.body).css("display","none")}},toolbarToggle:function(e){if(!jivo.isSeparateWindow()){var t=$("#jivo_close_button",window.parent.document.body);t.finish();if(e==="show"){t.fadeIn(250)}else{t.fadeOut(250)}}},requestRedraw:function(){var e=document.getElementById("inner-chat");e.style.display="none";e.offsetHeight;e.style.display="block"},startResize:function(e){var t=getElementPosition($("#jivo-iframe-container",window.parent.document.body)[0]);t.minLeft=30;t.maxLeft=$(window.parent).width()-t.width-30;if($("#introduce-popup").length>0){this.model.set("size.min-height",200+$("#introduce-popup").outerHeight())}else{this.model.set("size.min-height",200)}t.minHeight=this.model.get("size.min-height");t.maxHeight=$(window.parent).height();chat_view_online.getMessagesView().setScrollBottom(0);this._dragData=t},stopResize:function(e){var t=$("#jivo-iframe-container",window.parent.document.body);t.removeClass("jivo-no-transition");cookie("left",t.css("left"));cookie("right",t.css("right"));cookie("height",t.css("height"));delete this._dragData},resize:function(e){var t=this._dragData,i=t.left+e.dx,n=t.height-e.dy,o,s,a=$("#jivo-iframe-container",window.parent.document.body);a.addClass("jivo-no-transition");i=Math.max(t.minLeft,Math.min(t.maxLeft,i));n=Math.max(t.minHeight,Math.min(t.maxHeight,n));if(i!==e.currentTarget.offsetLeft){o=t.windowWidth-t.width-i;a.css({left:i,right:o,marginLeft:0,marginRight:0})}if(n!==this.model.get("size.height")&&(n>this.model.get("size.min-height")||n>this.model.get("size.height"))){this.model.set("size.height",n);jivo.transferProportion({width:a.css("width"),height:a.css("height")});a.css({height:n});if(navigator.userAgent.indexOf("Opera")>=0){this.requestRedraw()}chat_view_online.getMessagesView().setScrollBottom(0)}},updateMessage:function(){var e=this.model.get("inputEnabled"),t=chat_view_online.getMessagesView(),i=t.getScrollBottom();this.$("#input-div").css("visibility",e?"visible":"hidden");this.$("#messages-div").css("bottom",e?this.$("#input-field").outerHeight()+10:0);t.setScrollBottom(i,true)},inputSizeChange:function(){if(!this.model.get("can_enter_phone")){var e=this.$("#input-field");if(jivo.isMobileOrTablet()){e.attr("placeholder",translate("lblMessageHere"))}else{e.attr("placeholder",translate("lblEnterMessageHere"))}e.removeClass("input-field-callwidget");if(utils.browser.msie&&utils.browser.version<10){e.val("")}this.inputAutoResize()}}});Jivo.Online.Views.Evaluation=Backbone.View.extend({el:"#chat-body",template:_templates.online.evaluation,events:{"click #evaluation-popup .evaluation-btn-container a":"sendRate"},render:function(){this.$el.append(this.template({}));var e=this.$("#evaluation-popup");if(jivo.gui.animationIsSupported()){e.addClass("jivo-fade-in")}else{e.css("opacity","1");e.show()}},sendRate:function(e){e.preventDefault();var t=e.currentTarget.id,i;function n(e){setTimeout(function(){chat_view_online.getMessagesView().evaluationMessageIsShow=false},e)}if(t==="close-eval"){this.evaluationTimeout=setTimeout(underscore.bind(this.hideEvaluation,this),100);n(400);return}i=translate("lblEvaluate"+(t==="cancel"?"Please":"Thanks"));this.$(".evaluation-text-inner").html(i);this.$(".evaluation-btn-container").toggleClass("hidden visible");var o;if(t==="cancel"){if(this.evaluationTimeout){clearTimeout(this.evaluationTimeout)}o=0}else{this.evaluationTimeout=setTimeout(underscore.bind(this.hideEvaluation,this),15e3);n(15300);if(t==="positive"){o=1}else{o=-1}}chat_view_online.getChatView().inputFocus();jivo.handle("gui_evaluation",o,cookie("sess_id"));e.preventDefault()},hideEvaluation:function(){var e=this.$("#evaluation-popup");if(jivo.gui.animationIsSupported()){e.removeClass("jivo-fade-in");e.addClass("jivo-fade-out")}else{e.css("opacity","0");e.hide()}}});var MessageModel=Jivo.Online.Models.Message=Backbone.Model.extend({defaults:function(){return{text:"",time:new Date,delivered:true,priority:0,color:config.bubble_color}},isAgent:function(){return underscore.indexOf([MessageModel.TYPE_AGENT,MessageModel.TYPE_COBROWSE_HIGHLIGHT,MessageModel.TYPE_RECEIVE_FILE],this.get("type"))>=0},isClient:function(){return this.get("type")===MessageModel.TYPE_CLIENT},isHistory:function(){return!!this.get("history")},isReceiveFile:function(){return this.get("type")===MessageModel.TYPE_RECEIVE_FILE},isSystem:function(){return this.get("type")===MessageModel.TYPE_SYSTEM},isConnectionError:function(){return this.get("type")===MessageModel.TYPE_CONNECTION_ERROR}},{TYPE_AGENT:"agentMessage",TYPE_CLIENT:"clientMessage",TYPE_SYSTEM:"systemMessage",TYPE_RECEIVE_FILE:"receiveFile",TYPE_CONNECTION_ERROR:"connectionError",TYPE_COBROWSE_HIGHLIGHT:"cobrowse_highlight"});var MessagesCollection=Jivo.Online.Collections.Messages=Backbone.Collection.extend({model:MessageModel,addMessage:function(e,t){this.push(underscore.extend({},t,{type:e}))},addAgentMessage:function(e){return this.addMessage(MessageModel.TYPE_AGENT,{text:e})},addClientMessage:function(e){return this.addMessage(MessageModel.TYPE_CLIENT,{text:e})},addSystemMessage:function(e){return this.addMessage(MessageModel.TYPE_SYSTEM,{text:e})},addConnectionError:function(e){return this.addMessage(MessageModel.TYPE_CONNECTION_ERROR,{text:e})},addReceiveFile:function(e){return this.addMessage(MessageModel.TYPE_RECEIVE_FILE,e)},addCobrowseHighlight:function(e){return this.addMessage(MessageModel.TYPE_COBROWSE_HIGHLIGHT,e)}});Jivo.Online.Views.Message=Backbone.View.extend({el:"#messages-div-inner",$lastMessage:null,$clearDiv:null,scrollBottomThreshold:20,messagesBeforeEvaluation:5,$parent:null,events:{"click .cobrowse-btn-container a":"openHighlight","click .cobrowse-btn-container":"openHighlight","click .receiveFile a":"declineFile"},evaluationMessageIsShow:false,initialize:function(){this.$lastMessage=this.$(".new-msg-container");this.$clearDiv=this.$("#messages-div-inner-clear");this.$parent=this.$el.parent();this.listenTo(this.collection,"add",this.handleAdd).listenTo(this.collection,"reset",this.handleReset)},render:function(){this.$parent.perfectScrollbar({topMargin:utils.showAd()?40:25});if(navigator.userAgent.indexOf("Opera")>=0){var e=this;setTimeout(function(){e.collection.add({type:"emptyMessage",time:new Date,history:false})},200)}},updateScrollBar:function(){log("updateScrollBar");this.$parent.perfectScrollbar("update")},getScrollBottom:function(){return $(this.el).css("bottom")},setScrollBottom:function(e,t){if(t){log("setScrollBottom from updateMessage",t);return}log("setScrollBottom",e);$(this.el).css({bottom:-e,top:"auto"});this.$parent.perfectScrollbar("scroll");this.updateScrollBar()},setScrollMobileBottom:function(){document.body.scrollTop=1e4;this.$parent.perfectScrollbar("scroll")},renderMessage:function(e){var t=e.get("type"),i=!e.isConnectionError()&&!e.isSystem()&&!e.isReceiveFile(),n,o=this.$lastMessage;if(i&&o&&o.hasClass(t)){n=_templates.online.messageNode({type:t,text:e.get("text"),history:e.get("history")});o.find(".new-msg-body-inner").append(n);o.find(".new-time").text(dateFormat(e.get("time"),"H:MM"))}else{n=_templates.online[t](e.toJSON());o=this.$lastMessage=$(n).insertBefore(this.$clearDiv)}setTimeout(function(){if(!e.get("history")){if(t==="agentMessage"||t==="clientMessage"||t==="cobrowse_highlight"){o.find(".new-msg-text").each(function(){var e=$(this);if(e[0].clientHeight===0){if(!css3AnimationIsSupported()){e[0].className+=" new-msg-text-history"}}});o.addClass("new-msg-animate")}}else{if(underscore.isFunction(updateBlur)){updateBlur()}}},0)},isIntroduceRequired:function l(){return!chat_view_online.getChatModel().introduced},isEvaluationRequired:function(){function e(e){return!e.isHistory()&&(e.isClient()||e.isAgent())}return config.show_rate_form&&config.options&64&&!this.evaluationMessageIsShow&&this.collection.filter(e).length>=this.messagesBeforeEvaluation},handleAdd:function(e){var t=e.get("type"),i;i=this.getScrollBottom();this.renderMessage(e);if(i==="auto"&&t!="agentMessage"){this.setScrollBottom(0);this.updateScrollBar();if(underscore.isFunction(updateBlur)){updateBlur()}}this.trigger("message",this,e);if(e.isAgent()){jivo.soundPlayer.incomingMessage()}else if(e.isClient()&&this.isIntroduceRequired()&&config.contacts_ask<=0){chat_view_online.getIntroducePopupView().render()}if(this.isEvaluationRequired()&&!$("#introduce-popup").is(":visible")){this.evaluationMessageIsShow=true;chat_view_online.getEvaluationView().render()}},handleReset:function(e){var t=underscore.find(e.toJSON(),function(e){return e.type==="clientMessage"});this.$(".new-msg-container").remove();this.$lastMessage=this.$(".new-msg-container");e.each(function(e){e.set("history",true);this.renderMessage(e)},this);if(e.length&&this.isIntroduceRequired()&&t&&config.contacts_ask<=0){chat_view_online.getIntroducePopupView().render()}this.setScrollBottom(0);this.trigger("reset",this,e)},remove:function(e){},edit:function(e){},hideMessage:function(e,t){var i=this,n=this.getScrollBottom();function o(){$(this).remove();i.setScrollBottom(n)}if(t){e.each(o)}else{e.fadeOut("slow",o)}},declineFile:function(e){var t=$(e.currentTarget);e.preventDefault();if(t.attr("href")!=="#"){window.open(t.attr("href"));chat_view_online.fileReceive(t.attr("data-id"),t.attr("data-name"))}else{chat_view_online.fileDecline(t.attr("data-id"),t.attr("data-name"))}this.hideMessage(t.parents(".receiveFile"));chat_view_online.getChatView().inputFocus()},openHighlight:function(e){var t=$(e.currentTarget);if(!t.attr("data-url"))t=t.find("a");chat_view_online.acceptCobrowse(t.attr("data-url"),t.attr("data-hash"));chat_view_online.getChatView().inputFocus();e.preventDefault()},hideInvitationMessage:function(){this.hideMessage(this.$(".agentMessage"),true);this.$lastMessage=null},hideConnectionError:function(){this.hideMessage(this.$(".connectionError"),true)}});Jivo.Online.Models.Name=Jivo.Model.Name.extend({required:function(){return this.show()&&config.contacts_settings[this.id].required}});Jivo.Online.Models.Message=Jivo.Model.Message.extend({defauts:{required:false},required:function(){return this.get("required")},show:function(){return this.get("required")}});Jivo.Online.Views.IntroduceForm=Jivo.View.Form.extend({el:"#inner-chat",tagName:"div",templateData:{nologo:!utils.showAd(),maxMessageLength:Jivo.Online.MAX_MESSAGE_LENGTH,link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),locale:getIconLocale()},validFields:["name","phone","email"]});Jivo.Online.Views.Introduce=Jivo.Online.Views.IntroduceForm.extend({template:_templates.online.introduceForm,previousStartedValue:false,events:{"click #submit":"submit","click #cancel":"cancel",'keydown input:text,input[type="tel"],input[type="email"],textarea':"onKeyDown","input  #message":"messageInput"},fields:new Backbone.Collection([new Jivo.Online.Models.Message({formId:"introduce-form"}),new Jivo.Model.Email({formId:"introduce-form"}),new Jivo.Model.Phone({formId:"introduce-form"}),new Jivo.Online.Models.Name({formId:"introduce-form"})]),render:function(e,t){var i=this.$("#introduce-form"),n,o,s;n=this.templateData;if(t){n.valueInputField=t;this.fields.get("message").set("required",true)}else{this.fields.get("message").set("required",e)}n.fields=this.fields;n.departments=e&&config.departments?config.departments:null;n.send=e?translate("lblSendBefore"):translate("lblSend");if(i.length>0&&this.previousStartedValue===e){i.show()}else{this.previousStartedValue=e;this.$("#introduce-form").remove();this.$el.append(this.template(n))}if(t||e){this.$("#message").show();this.$("#introduce-form").find(".buttons").addClass("single");if(e){this.$("#introduce-caption").hide();chat_view_online.getChatModel().set("agent.name",translate("lblIntroduceRequestBefore"))}}else{this.$("#message").hide();this.$("#introduce-form").find(".buttons").removeClass("single");this.$("#introduce-caption").show()}o=this.$("#introduce-avatar");o.removeClass("introduce-bg").css("height",0);log("introduce render",this.getHeight(),jivo.getChatHeight(),jivo.getChatHeight()-this.getHeight());if(this.getHeight()<jivo.getChatHeight()){s=jivo.getChatHeight()-this.getHeight();o.css("height",s);o.find("img").css({width:"auto",height:"100%"});if(s>30){o.addClass("introduce-bg")}else{o.hide()}}if(jivo.isSeparateWindow()){this.$("#introduce-form").perfectScrollbar({topMargin:utils.showAd()?40:25}).find("#departments-list").perfectScrollbar()}else{setTimeout(function(){$("#introduce-form").find('input:text[value=""],input[type="tel"][value=""],input[type="email"][value=""],textarea:empty').first().focus()},0)}if(jivo.isMobileOrTablet()){document.documentElement.style.position="static"}this.$("#introduce-form").find("input[placeholder], textarea[placeholder]").placeholder();this.$("#current-department").click(function(){$("#departments-list").toggle()});this.$("#departments-list>li").click(underscore.bind(this.onDepartmentSelect));if(utils.browser.msie&&utils.browser.mV<9){this.$("#message").on("keydown paste",underscore.bind(this.messageInput,this))}this.delegateEvents();log("introduce render update height");this.updateHeight(true)},getHeight:function(){var e=$("#header-avatar").outerHeight();return(e>100?e/2:e)+$("#introduce-form").outerHeight()},messageInput:function(e){setTimeout(underscore.bind(function(){var e=$(this).attr("maxlength");if($(this).val().length>e){$(this).val($(this).val().substring(0,e))}},e.currentTarget),0)},submit:function(){if(this.valid()){$("#jivo-chat").addClass("jivo-animate");if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setTransition(true)}var e={},t=this.validFields,i=true;underscore.each(t,function(t){var n=this.fields.get(t).value();if(n!==""){e[t]=n;i=false}},this);if(i&&config.contacts_ask<=0){this.close();return}chat_view_online.getChatModel().introduced=true;this.close();chat_view_online.getChatView().el.scrollTop=0;jivo.handle("gui_introduced",e);if(this.$("#current-department")){jivo.handle("gui_department",this.$("#current-department").attr("data-id"))}var n=chat_view_online.getChatModel().get("client");underscore.extend(n,e);var o=this.fields.get("message").value();if($.trim(o).length!==0){chat_view_online.setChatAttr("can_enter_phone",false);chat_view_online.sendMessage(o)}if(devicejs.ios()){chat_view_online.initSound()}chat_view_online.getChatView().inputFocus();if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setTransition(true)}}else{log("introduce form not valid");if(!jivo.isMobileOrTablet()){jivo.gui.jivoframecontainer.setTransition(false)}$("#jivo-chat").removeClass("jivo-animate");this.updateHeight(true)}},cancel:function(e){this.close();e.preventDefault()},close:function(){this.$("#introduce-form").hide();this.collection.reset();chat_view_online.getChatView().enableDragging();if(jivo.isMobile()){document.documentElement.style.position="fixed"}this.undelegateEvents()},onDepartmentSelect:function(e){var t=$(e.currentTarget);$("#departments-list").hide();this.$("#current-department").html(t.html()).attr("data-id",t.attr("data-id"))}});Jivo.Online.Views.IntroducePopup=Jivo.Online.Views.IntroduceForm.extend({el:"#chat-body",template:_templates.online.introducePopup,popup:"#introduce-popup",popupContent:"#introduce-popup-content",events:{"click #submit":"submit","click #cancel":"cancel",'keydown input:text,input[type="tel"],input[type="email"]':"onKeyDown","focus input":"onInputFocus","blur input":"onInputBlur"},fields:new Backbone.Collection([new Jivo.Model.Email({formId:"introduce-popup"}),new Jivo.Model.Phone({formId:"introduce-popup"}),new Jivo.Online.Models.Name({formId:"introduce-popup"})]),render:function(){var e;if($("#introduce-popup").length===0){e=this.templateData;e.fields=this.fields;e.send=translate("lblSend");this.$el.append(this.template(e));this.$("#introduce-popup").find("input[placeholder], textarea[placeholder]").placeholder();this.delegateEvents()}setTimeout(underscore.bind(this.renderSpecific,this),3e3)},renderSpecific:function(e){this.onInputBlur(e,false)},cancel:function(e){e.preventDefault();this.close();chat_view_online.getChatModel().introduced=true},close:function(){this.$("#introduce-popup").fadeOut();chat_view_online.getChatView().enableDragging();this.undelegateEvents()},submit:function(e){if(e){e.target.focus()}if(this.valid()){var t={},i=this.validFields,n=true,o;underscore.each(i,function(e){var i=this.fields.get(e).value();if(i!==""){t[e]=i;n=false}},this);if(n&&config.contacts_ask<=0){this.close();return}this.$("#cancel, .text-field, .field-wrapper, .buttons").fadeOut();this.$(".icon-thx").fadeIn();this.$("#introduce-popup-content").addClass("thx-content");this.onInputBlurSpecific(e,true);setTimeout(underscore.bind(this.close,this),3e3);chat_view_online.getChatModel().introduced=true;jivo.handle("gui_introduced",t);var s=chat_view_online.getChatModel().get("client");underscore.extend(s,t);chat_view_online.getChatView().inputFocus()}},toggleError:function(e,t){if(t){this.$("#"+e).parent().addClass("error-field");this.$("#error-"+e).show()}else{this.$("#"+e).parent().removeClass("error-field");this.$("#error-"+e).hide()}},onInputFocus:function(){this.$("#introduce-popup").height(this.$("#introduce-popup-content").height())},onInputBlur:function(e,t){setTimeout(underscore.bind(this.onInputBlurSpecific,this),100)},onInputBlurSpecific:function(e,t){var i;if(t||!((this.$("input:text").length?this.$("input:text").val()!=="":false)||(this.$('input[type="tel"]').length?this.$('input[type="tel"]').val()!=="":false)||(this.$('input[type="email"]').length?this.$('input[type="email"]').val()!=="":false)||this.$('input[type="button"]').is(":focus")||this.$("input:text").is(":focus")||this.$('input[type="tel"]').is(":focus")||this.$('input[type="email"]').is(":focus"))){if(t){i=this.$(".icon-thx").outerHeight()}else{i=this.$(".text-field").outerHeight()+this.$(".field-wrapper").outerHeight()}this.$("#introduce-popup").height(i)}}});Jivo.Online.Views.Departments=Backbone.View.extend({el:"#inner-chat",tagName:"div",template:_templates.online.departments,templateData:{nologo:!utils.showAd()},events:{"click a.department":"onDepartmentSelect"},cacheAgentName:null,render:function(){var e=this.templateData;e.departments=config.departments;this.$el.append(this.template(this.templateData));this.cacheAgentName=chat_view_online.getChatModel().get("agent.name");chat_view_online.getChatModel().set("agent.name",translate("lblSelectDep"));this.$("#input-field").hide();this.fixSafariScroll()},close:function(e){log("Close department dialog");this.$("#input-field").show();this.$("#departments").remove();chat_view_online.getChatModel().set("agent.name",e?this.cacheAgentName:chat_view_online.getChatModel().get("agent.name"))},onDepartmentSelect:function(e){jivo.handle("gui_department",$(e.currentTarget).attr("data-id"));this.close(true);chat_view_online.chatMaximized();chat_view_online.getChatView().enableDragging()},fixSafariScroll:function(){this.$("#departments").mouseover(function(e){$(this).css("border","1px");$(this).css("border","none")})}});Jivo.Online.Views.Call=Backbone.View.extend({el:"#header-avatar",template:_templates.online.callButton,events:{"click #callme":"onCallClick"},initialize:function(){this.model.on("change:state",this.onStateChange,this);$("#phone_hint").html(translate("lblPhoneHint"))},render:function(){this.$el.append(this.template({}))},addMessage:function(e){chat_view_online.addSystemMessage(e)},micDisabled:function(){return this.model.get("state")==="WebPhoneMicDisabled"},idle:function(){return this.model.get("state")==="WebPhoneIdle"},connecting:function(){return this.model.get("state")==="WebPhoneConnecting"},progressing:function(){return this.model.get("state")==="WebPhoneProgressing"},joined:function(){return this.model.get("state")==="WebPhoneJoined"},authenticating:function(){return this.model.get("state")==="WebPhoneAuthenticating"},onStateChange:function(){if(this.model.calling()){$("#callme").addClass("hang-up");if(this.joined()){this.addMessage(translate("c_callConnected"))}else if(this.authenticating()){$("#web_phone").addClass("phone_hidden")}else if(this.connecting()){if(!this.model.rtcSupported()){$("#web_phone").removeClass("phone_hidden")}}else if(this.progressing()){$("#callme").show();$(".header-avatar-container").find(".title").css("width","75%")}}else{$("#callme").removeClass("hang-up");if(this.micDisabled()){$("#callme").hide()}else if(this.idle()){this.addMessage(translate("c_callDisconnected"))}chat_view_online.getCallModel().isInit=false}},onCallClick:function(){var e=jivo.getCallWidget();if(e){if(e.state!=="CALL"){if(config.chat_mode==="online"){jivo.handle("cw_ping")}else{jivo.handle("cw_show_form",{show_form:1})}e.analyticsTitle="buttonClick"}else{chat_view_online.chatMinimized()}}else{if(this.model.calling()){this.model.hangup()}else{$("#callme").hide();this.addMessage(translate("c_callProcessing"));this.model.call()}}}});Jivo.Online.Models.Call=Backbone.Model.extend({isInit:false,defaults:{state:"WebPhoneUninitialized"},initialize:function(e){e.on("change:agent.vox_name",this.onVoxNameChange,this)},call:function(){this.getWebPhone().handle("call")},hangup:function(){this.getWebPhone().handle("hangup")},rtcSupported:function(){var e=false;if(!jivo.isMobileOrTablet()&&!(devicejs.chrome()&&document.location.protocol==="http:")){if(typeof webkitRTCPeerConnection!=="undefined"||typeof mozRTCPeerConnection!=="undefined"){if(typeof mozRTCPeerConnection!=="undefined"){try{e=true}catch(t){}}else{e=true}}}return e},getWebPhone:function(){if(this.webPhone===undefined){var e=["WebPhoneMicDisabled","WebPhoneInitializing","WebPhoneInitialized","WebPhoneConnecting","WebPhoneConnected","WebPhoneAuthenticating","WebPhoneIdle","WebPhoneProgressing","WebPhoneJoined"];this.webPhone=new WebPhone;for(var t in e){this.webPhone.on(e[t],underscore.bind(function(e){this.set("state",e.name)},this))}}return this.webPhone},onVoxNameChange:function(e){this.getWebPhone().setAgentId(e.changed["agent.vox_name"])},calling:function(){return underscore.contains(["WebPhoneInitializing","WebPhoneConnecting","WebPhoneAuthenticating","WebPhoneProgressing","WebPhoneJoined"],this.get("state"))}});var chat_view_online=Jivo.Online.Controller=new function(){var e,t,i,n,o,s,a,r,l,c=false;underscore.defaults(config,{bubble_color:"green"});window.chat_view_online=this;this.getChatModel=function(){if(!e){e=new Jivo.Online.Models.Chat}return e};this.getMessagesCollection=function(){if(!t){t=new MessagesCollection}return t};this.getCallModel=function(){if(!i){i=new Jivo.Online.Models.Call(this.getChatModel())}return i};this.getChatView=function(){if(!o){o=new Jivo.Online.Views.Chat({model:this.getChatModel(),collection:this.getMessagesCollection()})}return o};this.getMessagesView=function(){if(!s){s=new Jivo.Online.Views.Message({collection:this.getMessagesCollection()})}return s};this.getIntroduceView=function(){if(!r){r=new Jivo.Online.Views.Introduce;r.undelegateEvents()}return r};this.getIntroducePopupView=function(){if(!r){r=new Jivo.Online.Views.IntroducePopup;r.undelegateEvents()}return r};this.getDepartmentsView=function(){if(!l){l=new Jivo.Online.Views.Departments}return l};this.getCallView=function(){if(!a){a=new Jivo.Online.Views.Call({model:this.getCallModel(),chatModel:this.getChatModel()})}return a};this.getEvaluationView=function(){if(!n){n=new Jivo.Online.Views.Evaluation}return n};var u=["addClientMessage","addAgentMessage","addSystemMessage","addReceiveFile","addConnectionError","addCobrowseHighlight"];underscore.each(u,function(e){this[e]=function(){return proxy(this.getMessagesCollection(),e,arguments)}},this);this.resetMessages=function(){return proxy(this.getMessagesCollection(),"reset",arguments)};var d=["hideConnectionError","hideInvitationMessage"];underscore.each(d,function(e){this[e]=function(){return proxy(this.getMessagesView(),e,arguments)}},this);this.setChatAttr=function(){return proxy(this.getChatModel(),"set",arguments)};this.getChatAttr=function(){return proxy(this.getChatModel(),"get",arguments)};this.create=function(e){this.getChatView().render();this.getMessagesView().render();this.getCallView().render()};this.sendMessage=function(e){if(e.length==0)return false;jivo.handle("gui_message",e)};this.onFocus=function(){jivo.handle("gui_msg_input_focus")};this.chatMinimized=function(){jivo.handle("gui_minimize")};this.chatMaximized=function(){this.onFocus();this.getChatView().inputFocus();this.getMessagesView().setScrollBottom(0)};this.typing=function(e){jivo.handle("gui_typing",e?1:0)};this.fileReceive=function(e,t){jivo.handle("gui_receive_file",e,t)};this.fileDecline=function(e,t){jivo.handle("gui_decline_file",e,t)};this.acceptCobrowse=function(e,t){jivo.handle("gui_accept_cobrowse",e,t)};this.getHeight=function(){return this.getChatModel().get("size.height")};this.initSound=function(){log("initSound for ios");if(!c){jivo.soundPlayer.incomingMessage();jivo.soundPlayer.pause();c=true}}};Jivo.Message.Models.Message=Backbone.Model.extend({defaults:{templateData:{link:translate("lblPwrBy").replace("_URL_","?utm_source="+encodeURIComponent(location.hostname)+"&utm_medium=link&utm_content=offline_form&utm_campaign=self_ad"),nologo:!utils.showAd(),locale:getIconLocale()},buttons:[],msg:translate("lblNoOperators"),header:translate("lblChatEnded")}});Jivo.Message.Views.Message=Backbone.View.extend({el:"#inner-chat",submited:false,tagName:"div",template:_templates.message.message,initialize:function(){},render:function(){this.$el.html(this.template(this.model.toJSON()));this.$el.addClass("offline");if($("jivo-chat")){$("jivo-chat").addClass("jivo-offline").removeClass("jivo-online")}var e=this.$el.find("#buttons"),t=this.model.get("buttons");underscore.each(t,function(t,i){e.append($("<input/>",{type:"button",value:t.title,"class":"jivoBtn accept"}).click(function(e){return function(){jivo.handle(e)}}(t.event)))});setTimeout($.proxy(function(){this.$el.find("#report-message-inner").css({top:(this.$el.find("#report-message").outerHeight()-this.$el.find("#report-message-inner").outerHeight())/2})},this),10);setTimeout(function(){$("#header-animate-container").addClass("header-animate")},0);if(jivo.isSeparateWindow()){$("#jivo_action #jivo_close_button").on("click",function(e){chat_view_offline.chatMinimized()})}return this}});var chat_view_msg=Jivo.Message.Controller=new function(){this.instance={models:{message:new Jivo.Message.Models.Message},views:{message:false}};this.create=function(e,t){this.instance.views.message=new Jivo.Message.Views.Message({model:this.instance.models.message});this.instance.views.message.render()};this._parent=function(e){if($(window.parent.document.getElementById(e)))return $(window.parent.document.getElementById(e));else return false}};var soundPlayer={_divId:"sound_player",_playOnReady:false,initialize:function(e){if(jivo.isMobileOrTablet()&&jivo.isSeparateWindow()){this.audio=document.getElementById(this._divId)}else{if(ie8||ie9){this.audio=document.createElement("embed");this.audio.setAttribute("src",staticUrl("/sounds/incoming_message.wav"));this.audio.setAttribute("autostart",false);this.audio.setAttribute("loop",false);this.audio.setAttribute("width",0);this.audio.setAttribute("height",0)}else{this.audio=document.createElement("audio")}this.audio.setAttribute("id",this._divId);e.appendChild(this.audio)}},incomingMessage:function(){if(jivo.isMobileOrTablet()&&jivo.isSeparateWindow()){this.audio=document.getElementById("jivo_sound_player")}if(!this._playOnReady&&!ie8&&!ie9&&!jivo.isSeparateWindow()){this.audio.innerHTML=_templates.sound_player({mp3:staticUrl("/sounds/incoming_message.mp3",true),ogg:staticUrl("/sounds/incoming_message.ogg",true),wav:staticUrl("/sounds/incoming_message.wav",true)});this._playOnReady=true}this.play()},pause:function(){if(typeof this.audio.pause!=="undefined"){this.audio.pause()}},play:function(){if(typeof this.audio.play!=="undefined"){this.audio.play()}}};browserNameVer=function(){var e=navigator.appName,t=navigator.userAgent.toLowerCase(),i=navigator.platform.toLowerCase(),n;var o=t.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);var s=i?/win/.test(i):/win/.test(t);if(o&&(n=t.match(/version\/([\.\d]+)/i))!=null)o[2]=n[1];o=o?[o[1],o[2]]:[e,navigator.appVersion,"-?"];o.win=s;return o}();if(!(browserNameVer.win&&browserNameVer[0]=="msie"&&parseFloat(browserNameVer[1])<=9||/Android/.test(navigator.userAgent))&&!jivo.isMobileOrTablet()){var $content,messages_col=0,translation,overviewNode=$("#messages-div-inner");var updateBlur=function(){$content=$(".messages-div-inner:first");var e=$content.children(".new-msg-container").find(".new-msg-text").length;if(e>messages_col||e<messages_col&&$content!=null){initBlur();messages_col=e}};function initBlur(){$(".messages-div-blurred").remove();$content.find(".new-msg-container").each(function(){var e=$(this);e.css("height",e.height())});var e=$("#jivosite-adword"),t=$("#input-div"),i=$("#messages-div"),n=$("#messages-div-inner"),o=i.height();this.$contentBlurred=$("<div></div>").addClass("messages-div-blurred").append($("<div></div>").addClass("messages-div-blurred-cont").html($content.clone(true))).css({filter:"url(#blur-effect)",bottom:-o+e.height()+parseInt(n.css("bottom"))});this.$contentBlurred.appendTo(e);this.$contentBlurred.clone(true).css("bottom",t.innerHeight()+parseInt(n.css("bottom"))).appendTo(t);translation="translate3d(0,"+overviewNode.css("bottom")+", 0)";e.find(".messages-div-blurred-cont").css({"-webkit-transform":translation,"-moz-transform":translation,transform:translation});t.find(".messages-div-blurred-cont").css({"-webkit-transform":translation,"-moz-transform":translation,transform:translation})}updateBlur()}var widgetContainer,widgetLoaded;if(jivo.isMobile()){widgetLoaded=setInterval(function(){widgetContainer=document.getElementById("jivo_top_wrap");if(widgetContainer&&!jivo.ignore_viewport){widgetContainer.className+="mobile-version";document.getElementById("jivo-label").style["right"]="auto";document.getElementById("jivo-label").style["opacity"]=1;document.getElementById("jivo-label").style["width"]="auto";jivoMobileLabel();clearInterval(widgetLoaded)}},100)}else if(jivo.isTablet()){widgetLoaded=setInterval(function(){widgetContainer=document.getElementById("jivo_top_wrap");if(widgetContainer){widgetContainer.className+="tablet-version";clearInterval(widgetLoaded)}},100)}function jivoMobileLabel(){log("jivoMobileLabel");if(!window.parent.document.querySelector("meta[name=viewport]")){var e=window.parent.document.createElement("meta");e.id="viewport";e.name="viewport";e.content="width=device-width, height=device-height, initial-scale=0.33, maximum-scale=1.2";window.parent.document.getElementsByTagName("head")[0].appendChild(e)}else{var t=window.parent.document.querySelector("meta[name=viewport]").getAttribute("content").split(","),i,n=false;for(var o=0;o<t.length;o++){t[o]=t[o].replace(/^\s+/,"");var s=t[o].split("=");if(s[0]=="maximum-scale"){n=true;if(s[1]>1){s[1]="1.2"}}t[o]=s[0]+"="+s[1]}if(!n){t.push("maximum-scale=1.2")}i=t.join(", ");window.parent.document.querySelector("meta[name=viewport]").setAttribute("content",i)}var a=document.getElementById("jivo-label");var r=window.parent.document.getElementById("jivo-iframe-container");addClass(r,"jivo-c-mobile");setInterval(function(){if(a){var e=0,t=290,i=500;var n=window.parent.window.innerWidth||window.parent.window.pageXOffset||window.parent.document.documentElement.clientWidth||window.parent.document.getElementsByTagName("html")[0];var o=(n/t).toFixed(3);if(window.parent.window.matchMedia("(orientation: landscape)").matches||Math.abs(window.parent.window.orientation)===90){o=(n/i).toFixed(3)}if(o!=e){if(o<1)o=1;a.style["zoom"]=o;r.style["zoom"]=o;e=o}}},100)}